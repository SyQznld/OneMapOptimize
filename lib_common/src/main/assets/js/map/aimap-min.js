(function(f,c){"object"===typeof exports&&"undefined"!==typeof module?c(exports):"function"===typeof define&&define.amd?define(["exports"],c):c(f.L={})})(this,function(f){function c(a){var d,h,s,b;h=1;for(s=arguments.length;h<s;h++)for(d in b=arguments[h],b)a[d]=b[d];return a}function g(a,d){var h=Array.prototype.slice;if(a.bind)return a.bind.apply(a,h.call(arguments,1));var s=h.call(arguments,2);return function(){return a.apply(d,s.length?s.concat(h.call(arguments)):arguments)}}function b(a){a._aimap_id=
a._aimap_id||++rc;return a._aimap_id}function k(a,d,h){var s,b,c,e;e=function(){s=!1;b&&(c.apply(h,b),b=!1)};return c=function(){s?b=arguments:(a.apply(h,arguments),setTimeout(e,d),s=!0)}}function e(a,d,h){var s=d[1],d=d[0],b=s-d;return a===s&&h?a:((a-d)%b+b)%b+d}function i(){return!1}function m(a,d){var h=Math.pow(10,void 0===d?6:d);return Math.round(a*h)/h}function o(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function l(a){return o(a).split(/\s+/)}function j(a,d){a.hasOwnProperty("options")||
(a.options=a.options?hb(a.options):{});for(var h in d)a.options[h]=d[h];return a.options}function n(a,d,h){var s=[],b;for(b in a)s.push(encodeURIComponent(h?b.toUpperCase():b)+"="+encodeURIComponent(a[b]));return(!d||-1===d.indexOf("?")?"?":"&")+s.join("&")}function r(a,d){return a.replace(kd,function(a,s){var b=d[s];if(void 0===b)throw Error("No value provided for variable "+a);"function"===typeof b&&(b=b(d));return b})}function q(a,d){for(var h=0;h<a.length;h++)if(a[h]===d)return h;return-1}function p(a){return window["webkit"+
a]||window["moz"+a]||window["ms"+a]}function t(a){var d=+new Date,h=Math.max(0,16-(d-sc));sc=d+h;return window.setTimeout(a,h)}function B(a,d,h){if(h&&zb===t)a.call(d);else return zb.call(window,g(a,d))}function v(a){a&&tc.call(window,a)}function C(){}function E(a){if(!("undefined"===typeof L||!L||!AIMap.Mixin))for(var a=fa(a)?a:[a],d=0;d<a.length;d++)a[d]===AIMap.Mixin.Events&&console.warn("Deprecated include of AIMap.Mixin.Events: this property will be removed in future releases, please inherit from AIMap.Evented instead.",
Error().stack)}function w(a,d,h){this.x=h?Math.round(a):a;this.y=h?Math.round(d):d}function y(a,d,h){return a instanceof w?a:fa(a)?new w(a[0],a[1]):void 0===a||null===a?a:"object"===typeof a&&"x"in a&&"y"in a?new w(a.x,a.y):new w(a,d,h)}function z(a,d){if(a)for(var h=d?[a,d]:a,s=0,b=h.length;s<b;s++)this.extend(h[s])}function D(a,d){return!a||a instanceof z?a:new z(a,d)}function u(a,d){if(a)for(var h=d?[a,d]:a,s=0,b=h.length;s<b;s++)this.extend(h[s])}function x(a,d){return a instanceof u?a:new u(a,
d)}function A(a,d,h){if(isNaN(a)||isNaN(d))throw Error("Invalid LatLng object: ("+a+", "+d+")");this.lat=+a;this.lng=+d;void 0!==h&&(this.alt=+h)}function F(a,d,h){return a instanceof A?a:fa(a)&&"object"!==typeof a[0]?3===a.length?new A(a[0],a[1],a[2]):2===a.length?new A(a[0],a[1]):null:void 0===a||null===a?a:"object"===typeof a&&"lat"in a?new A(a.lat,"lng"in a?a.lng:a.lon,a.alt):void 0===d?null:new A(a,d,h)}function W(a,d,h,s){fa(a)?(this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3]):(this._a=
a,this._b=d,this._c=h,this._d=s)}function N(a,d,h,s){return new W(a,d,h,s)}function S(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function V(a,d){var h="",s,b,c,e,f,j;s=0;for(c=a.length;s<c;s++){f=a[s];b=0;for(e=f.length;b<e;b++)j=f[b],h+=(b?"L":"M")+j.x+" "+j.y;h+=d?ib?"z":"x":""}return h||"M0 0"}function R(a){return 0<=navigator.userAgent.toLowerCase().indexOf(a)}function T(a,d,h,s){"touchstart"===d?ba(a,h,s):"touchmove"===d?Da(a,h,s):"touchend"===d&&va(a,h,s);return this}
function qa(a,d,h){h=a["_aimap_"+d+h];"touchstart"===d?a.removeEventListener(Ab,h,!1):"touchmove"===d?a.removeEventListener(Bb,h,!1):"touchend"===d&&(a.removeEventListener(Cb,h,!1),a.removeEventListener(Db,h,!1));return this}function ba(a,d,h){var s=g(function(a){if("mouse"!==a.pointerType&&a.MSPOINTER_TYPE_MOUSE&&a.pointerType!==a.MSPOINTER_TYPE_MOUSE)if(0>ld.indexOf(a.target.tagName))Y(a);else return;ga(a,d)});a["_aimap_touchstart"+h]=s;a.addEventListener(Ab,s,!1);uc||(document.documentElement.addEventListener(Ab,
U,!0),document.documentElement.addEventListener(Bb,wa,!0),document.documentElement.addEventListener(Cb,P,!0),document.documentElement.addEventListener(Db,P,!0),uc=!0)}function U(a){Ea[a.pointerId]=a;Eb++}function wa(a){Ea[a.pointerId]&&(Ea[a.pointerId]=a)}function P(a){delete Ea[a.pointerId];Eb--}function ga(a,d){a.touches=[];for(var h in Ea)a.touches.push(Ea[h]);a.changedTouches=[a];d(a)}function Da(a,d,h){var s=function(a){(a.pointerType===a.MSPOINTER_TYPE_MOUSE||"mouse"===a.pointerType)&&0===a.buttons||
ga(a,d)};a["_aimap_touchmove"+h]=s;a.addEventListener(Bb,s,!1)}function va(a,d,h){var s=function(a){ga(a,d)};a["_aimap_touchend"+h]=s;a.addEventListener(Cb,s,!1);a.addEventListener(Db,s,!1)}function vc(a,d,h){function s(a){var d;if(ca){if(!Sa||"mouse"===a.pointerType)return;d=Eb}else d=a.touches.length;if(!(1<d)){d=Date.now();var h=d-(c||d);e=a.touches?a.touches[0]:a;f=0<h&&h<=j;c=d}}function b(a){if(f&&!e.cancelBubble){if(ca){if(!Sa||"mouse"===a.pointerType)return;var a={},h,s;for(s in e)h=e[s],
a[s]=h&&h.bind?h.bind(e):h;e=a}e.type="dblclick";d(e);c=null}}var c,e,f=!1,j=250;a[Fa+jb+h]=s;a[Fa+kb+h]=b;a[Fa+"dblclick"+h]=d;a.addEventListener(jb,s,!1);a.addEventListener(kb,b,!1);a.addEventListener("dblclick",d,!1);return this}function wc(a,d){var h=a[Fa+kb+d],s=a[Fa+"dblclick"+d];a.removeEventListener(jb,a[Fa+jb+d],!1);a.removeEventListener(kb,h,!1);Sa||a.removeEventListener("dblclick",s,!1);return this}function G(a,d,h,s){if("object"===typeof d)for(var b in d)lb(a,b,d[b],h);else{d=l(d);b=0;
for(var c=d.length;b<c;b++)lb(a,d[b],h,s)}return this}function O(a,d,h,s){if("object"===typeof d)for(var b in d)Fb(a,b,d[b],h);else if(d){d=l(d);b=0;for(var c=d.length;b<c;b++)Fb(a,d[b],h,s)}else{for(c in a[da])Fb(a,c,a[da][c]);delete a[da]}return this}function lb(a,d,h,s){var c=d+b(h)+(s?"_"+b(s):"");if(a[da]&&a[da][c])return this;var e=function(d){return h.call(s||a,d||window.event)},f=e;ca&&0===d.indexOf("touch")?T(a,d,e,c):ha&&"dblclick"===d&&vc&&(!ca||!Ta)?vc(a,e,c):"addEventListener"in a?"mousewheel"===
d?a.addEventListener("onwheel"in a?"wheel":"mousewheel",e,!1):"mouseenter"===d||"mouseleave"===d?(e=function(d){d=d||window.event;mb(a,d)&&f(d)},a.addEventListener("mouseenter"===d?"mouseover":"mouseout",e,!1)):("click"===d&&Ga&&(e=function(a){var d=a.timeStamp||a.originalEvent&&a.originalEvent.timeStamp,h=Gb&&d-Gb;h&&100<h&&500>h||a.target._simulatedClick&&!a._simulated?ia(a):(Gb=d,f(a))}),a.addEventListener(d,e,!1)):"attachEvent"in a&&a.attachEvent("on"+d,e);a[da]=a[da]||{};a[da][c]=e}function Fb(a,
d,h,s){h=d+b(h)+(s?"_"+b(s):"");s=a[da]&&a[da][h];if(!s)return this;ca&&0===d.indexOf("touch")?qa(a,d,h):ha&&"dblclick"===d&&wc&&(!ca||!Ta)?wc(a,h):"removeEventListener"in a?"mousewheel"===d?a.removeEventListener("onwheel"in a?"wheel":"mousewheel",s,!1):a.removeEventListener("mouseenter"===d?"mouseover":"mouseleave"===d?"mouseout":d,s,!1):"detachEvent"in a&&a.detachEvent("on"+d,s);a[da][h]=null}function xa(a){a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=
!0;Hb(a);return this}function Ib(a){lb(a,"mousewheel",xa);return this}function Ua(a){G(a,"mousedown touchstart dblclick",xa);lb(a,"click",Jb);return this}function Y(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return this}function ia(a){Y(a);xa(a);return this}function xc(a,d){if(!d)return new w(a.clientX,a.clientY);var h=d.getBoundingClientRect();return new w(a.clientX/(h.width/d.offsetWidth||1)-h.left-d.clientLeft,a.clientY/(h.height/d.offsetHeight||1)-h.top-d.clientTop)}function yc(a){return Sa?
a.wheelDeltaY/2:a.deltaY&&0===a.deltaMode?-a.deltaY/md:a.deltaY&&1===a.deltaMode?20*-a.deltaY:a.deltaY&&2===a.deltaMode?60*-a.deltaY:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&32765>Math.abs(a.detail)?20*-a.detail:a.detail?60*(a.detail/-32765):0}function Jb(a){Kb[a.type]=!0}function Hb(a){var d=Kb[a.type];Kb[a.type]=!1;return d}function mb(a,d){var h=d.relatedTarget;if(!h)return!0;try{for(;h&&h!==a;)h=h.parentNode}catch(s){return!1}return h!==a}function zc(a){return"string"===
typeof a?document.getElementById(a):a}function Va(a,d){var h=a.style[d]||a.currentStyle&&a.currentStyle[d];if((!h||"auto"===h)&&document.defaultView)h=(h=document.defaultView.getComputedStyle(a,null))?h[d]:null;return"auto"===h?null:h}function J(a,d,h){a=document.createElement(a);a.className=d||"";h&&h.appendChild(a);return a}function K(a){var d=a.parentNode;d&&d.removeChild(a)}function Lb(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function Ha(a){var d=a.parentNode;d.lastChild!==a&&d.appendChild(a)}
function Ia(a){var d=a.parentNode;d.firstChild!==a&&d.insertBefore(a,d.firstChild)}function Mb(a,d){if(void 0!==a.classList)return a.classList.contains(d);var h=nb(a);return 0<h.length&&RegExp("(^|\\s)"+d+"(\\s|$)").test(h)}function H(a,d){if(void 0!==a.classList)for(var h=l(d),s=0,b=h.length;s<b;s++)a.classList.add(h[s]);else Mb(a,d)||(h=nb(a),Nb(a,(h?h+" ":"")+d))}function M(a,d){void 0!==a.classList?a.classList.remove(d):Nb(a,o((" "+nb(a)+" ").replace(" "+d+" "," ")))}function Nb(a,d){void 0===
a.className.baseVal?a.className=d:a.className.baseVal=d}function nb(a){return void 0===a.className.baseVal?a.className:a.className.baseVal}function Z(a,d){if("opacity"in a.style)a.style.opacity=d;else if("filter"in a.style)a:{var h=d,s=!1;try{s=a.filters.item("DXImageTransform.Microsoft.Alpha")}catch(b){if(1===h)break a}h=Math.round(100*h);s?(s.Enabled=100!==h,s.Opacity=h):a.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(opacity="+h+")"}}function ob(a){for(var d=document.documentElement.style,
h=0;h<a.length;h++)if(a[h]in d)return a[h];return!1}function ya(a,d,h){d=d||new w(0,0);a.style[Ob]=(Pb?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(h?" scale("+h+")":"")}function Q(a,d){a._aimap_pos=d;$?ya(a,d):(a.style.left=d.x+"px",a.style.top=d.y+"px")}function za(a){return a._aimap_pos||new w(0,0)}function Qb(){G(window,"dragstart",Y)}function Rb(){O(window,"dragstart",Y)}function Sb(a){for(;-1===a.tabIndex;)a=a.parentNode;a.style&&(pb(),qb=a,Tb=a.style.outline,a.style.outline=
"none",G(window,"keydown",pb))}function pb(){qb&&(qb.style.outline=Tb,Tb=qb=void 0,O(window,"keydown",pb))}function Ac(a,d){if(!d||!a.length)return a.slice();for(var h=d*d,s=a,b=[s[0]],c=1,e=0,f=s.length;c<f;c++){var j=s[c],l=s[e],n=l.x-j.x,j=l.y-j.y;n*n+j*j>h&&(b.push(s[c]),e=c)}e<f-1&&b.push(s[f-1]);s=b;b=s.length;c=new ("undefined"!==typeof Uint8Array?Uint8Array:Array)(b);c[0]=c[b-1]=1;Ub(s,c,h,0,b-1);e=[];for(h=0;h<b;h++)c[h]&&e.push(s[h]);return e}function Bc(a,d,h){return Math.sqrt(Wa(a,d,h,
!0))}function Ub(a,d,h,b,c){var e=0,f,j,l;for(j=b+1;j<=c-1;j++)l=Wa(a[j],a[b],a[c],!0),l>e&&(f=j,e=l);e>h&&(d[f]=1,Ub(a,d,h,b,f),Ub(a,d,h,f,c))}function Cc(a,d,h,b,c){var b=b?Dc:Aa(a,h),e=Aa(d,h),f,j,l;for(Dc=e;;){if(!(b|e))return[a,d];if(b&e)return!1;f=b||e;j=rb(a,d,f,h,c);l=Aa(j,h);f===b?(a=j,b=l):(d=j,e=l)}}function rb(a,d,h,b,c){var e=d.x-a.x,d=d.y-a.y,f=b.min,b=b.max,j,l;h&8?(j=a.x+e*(b.y-a.y)/d,l=b.y):h&4?(j=a.x+e*(f.y-a.y)/d,l=f.y):h&2?(j=b.x,l=a.y+d*(b.x-a.x)/e):h&1&&(j=f.x,l=a.y+d*(f.x-a.x)/
e);return new w(j,l,c)}function Aa(a,d){var h=0;a.x<d.min.x?h|=1:a.x>d.max.x&&(h|=2);a.y<d.min.y?h|=4:a.y>d.max.y&&(h|=8);return h}function Wa(a,d,h,b){var c=d.x,d=d.y,e=h.x-c,f=h.y-d,j=e*e+f*f;0<j&&(j=((a.x-c)*e+(a.y-d)*f)/j,1<j?(c=h.x,d=h.y):0<j&&(c+=e*j,d+=f*j));e=a.x-c;f=a.y-d;return b?e*e+f*f:new w(c,d)}function la(a){return!fa(a[0])||"object"!==typeof a[0][0]&&"undefined"!==typeof a[0][0]}function Ec(a){console.warn("Deprecated use of _flat, please use AIMap.LineUtil.isFlat instead.");return la(a)}
function Fc(a,d,h){var b,c=[1,4,2,8],e,f,j,l,n,i;e=0;for(n=a.length;e<n;e++)a[e]._code=Aa(a[e],d);for(j=0;4>j;j++){i=c[j];b=[];e=0;n=a.length;for(f=n-1;e<n;f=e++)l=a[e],f=a[f],l._code&i?f._code&i||(f=rb(f,l,i,d,h),f._code=Aa(f,d),b.push(f)):(f._code&i&&(f=rb(f,l,i,d,h),f._code=Aa(f,d),b.push(f)),b.push(l));a=b}return a}function Vb(a,d){var h="Feature"===a.type?a.geometry:a,b=h?h.coordinates:null,c=[],e=d&&d.pointToLayer,f=d&&d.coordsToLatLng||Wb,j,l;if(!b&&!h)return null;switch(h.type){case "Point":return h=
f(b),e?e(a,h):new Xa(h);case "MultiPoint":j=0;for(l=b.length;j<l;j++)h=f(b[j]),c.push(e?e(a,h):new Xa(h));return new Ba(c);case "LineString":case "MultiLineString":return c=sb(b,"LineString"===h.type?0:1,f),new ma(c,d);case "Polygon":case "MultiPolygon":return c=sb(b,"Polygon"===h.type?1:2,f),new Ja(c,d);case "GeometryCollection":j=0;for(l=h.geometries.length;j<l;j++)(b=Vb({geometry:h.geometries[j],type:"Feature",properties:a.properties},d))&&c.push(b);return new Ba(c);default:throw Error("Invalid GeoJSON object.");
}}function Wb(a){return new A(a[1],a[0],a[2])}function sb(a,d,h){for(var b=[],c=0,e=a.length,f;c<e;c++)f=d?sb(a[c],d-1,h):(h||Wb)(a[c]),b.push(f);return b}function Xb(a,d){d="number"===typeof d?d:6;return void 0!==a.alt?[m(a.lng,d),m(a.lat,d),m(a.alt,d)]:[m(a.lng,d),m(a.lat,d)]}function tb(a,d,h,b){for(var c=[],e=0,f=a.length;e<f;e++)c.push(d?tb(a[e],d-1,h,b):Xb(a[e],b));!d&&h&&c.push(c[0]);return c}function Ka(a,d){return a.feature?c({},a.feature,{geometry:d}):ub(d)}function ub(a){return"Feature"===
a.type||"FeatureCollection"===a.type?a:{type:"Feature",properties:{},geometry:a}}function Gc(a,d){return new na(a,d)}function Hc(a,d){return new Ya(a,d)}function Yb(a){return Ic?new Zb(a):null}function $b(a){return ib||vb?new La(a):null}var Jc=Object.freeze;Object.freeze=function(a){return a};var hb=Object.create||function(){function a(){}return function(d){a.prototype=d;return new a}}(),rc=0,kd=/\{ *([\w_-]+) *\}/g,fa=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},
sc=0,zb=window.requestAnimationFrame||p("RequestAnimationFrame")||t,tc=window.cancelAnimationFrame||p("CancelAnimationFrame")||p("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)},nd=(Object.freeze||Object)({freeze:Jc,extend:c,create:hb,bind:g,lastId:rc,stamp:b,throttle:k,wrapNum:e,falseFn:i,formatNum:m,trim:o,splitWords:l,setOptions:j,getParamString:n,template:r,isArray:fa,indexOf:q,emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",requestFn:zb,cancelFn:tc,
requestAnimFrame:B,cancelAnimFrame:v});C.extend=function(a){var d=function(){this.initialize&&this.initialize.apply(this,arguments);this.callInitHooks()},h=d.__super__=this.prototype,b=hb(h);b.constructor=d;d.prototype=b;for(var e in this)this.hasOwnProperty(e)&&("prototype"!==e&&"__super__"!==e)&&(d[e]=this[e]);a.statics&&(c(d,a.statics),delete a.statics);a.includes&&(E(a.includes),c.apply(null,[b].concat(a.includes)),delete a.includes);b.options&&(a.options=c(hb(b.options),a.options));c(b,a);b._initHooks=
[];b.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this);this._initHooksCalled=true;for(var a=0,d=b._initHooks.length;a<d;a++)b._initHooks[a].call(this)}};return d};C.include=function(a){c(this.prototype,a);return this};C.mergeOptions=function(a){c(this.prototype.options,a);return this};C.addInitHook=function(a){var d=Array.prototype.slice.call(arguments,1);this.prototype._initHooks=this.prototype._initHooks||[];this.prototype._initHooks.push("function"===
typeof a?a:function(){this[a].apply(this,d)});return this};var X={on:function(a,d,h){if("object"===typeof a)for(var b in a)this._on(b,a[b],d);else{a=l(a);b=0;for(var c=a.length;b<c;b++)this._on(a[b],d,h)}return this},off:function(a,d,h){if(a)if("object"===typeof a)for(var b in a)this._off(b,a[b],d);else{a=l(a);b=0;for(var c=a.length;b<c;b++)this._off(a[b],d,h)}else delete this._events;return this},_on:function(a,d,h){this._events=this._events||{};var b=this._events[a];b||(b=[],this._events[a]=b);
h===this&&(h=void 0);for(var a={fn:d,ctx:h},c=0,e=b.length;c<e;c++)if(b[c].fn===d&&b[c].ctx===h)return;b.push(a)},_off:function(a,d,h){var b,c,e;if(this._events&&(b=this._events[a]))if(d){if(h===this&&(h=void 0),b){c=0;for(e=b.length;c<e;c++){var f=b[c];if(f.ctx===h&&f.fn===d){f.fn=i;this._firingCount&&(this._events[a]=b=b.slice());b.splice(c,1);break}}}}else{c=0;for(e=b.length;c<e;c++)b[c].fn=i;delete this._events[a]}},fire:function(a,d,h){if(!this.listens(a,h))return this;d=c({},d,{type:a,target:this,
sourceTarget:d&&d.sourceTarget||this});if(this._events&&(a=this._events[a])){this._firingCount=this._firingCount+1||1;for(var b=0,e=a.length;b<e;b++){var f=a[b];f.fn.call(f.ctx||this,d)}this._firingCount--}h&&this._propagateEvent(d);return this},listens:function(a,d){var h=this._events&&this._events[a];if(h&&h.length)return!0;if(d)for(var b in this._eventParents)if(this._eventParents[b].listens(a,d))return!0;return!1},once:function(a,d,h){if("object"===typeof a){for(var b in a)this.once(b,a[b],d);
return this}var c=g(function(){this.off(a,d,h).off(a,c,h)},this);return this.on(a,d,h).on(a,c,h)},addEventParent:function(a){this._eventParents=this._eventParents||{};this._eventParents[b(a)]=a;return this},removeEventParent:function(a){this._eventParents&&delete this._eventParents[b(a)];return this},_propagateEvent:function(a){for(var d in this._eventParents)this._eventParents[d].fire(a.type,c({layer:a.target,propagatedFrom:a.target},a),!0)}};X.addEventListener=X.on;X.removeEventListener=X.clearAllEventListeners=
X.off;X.addOneTimeEventListener=X.once;X.fireEvent=X.fire;X.hasEventListeners=X.listens;var Za=C.extend(X),Kc=Math.trunc||function(a){return 0<a?Math.floor(a):Math.ceil(a)};w.prototype={clone:function(){return new w(this.x,this.y)},add:function(a){return this.clone()._add(y(a))},_add:function(a){this.x+=a.x;this.y+=a.y;return this},subtract:function(a){return this.clone()._subtract(y(a))},_subtract:function(a){this.x-=a.x;this.y-=a.y;return this},divideBy:function(a){return this.clone()._divideBy(a)},
_divideBy:function(a){this.x/=a;this.y/=a;return this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){this.x*=a;this.y*=a;return this},scaleBy:function(a){return new w(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new w(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},floor:function(){return this.clone()._floor()},_floor:function(){this.x=Math.floor(this.x);
this.y=Math.floor(this.y);return this},ceil:function(){return this.clone()._ceil()},_ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},trunc:function(){return this.clone()._trunc()},_trunc:function(){this.x=Kc(this.x);this.y=Kc(this.y);return this},distanceTo:function(a){var a=y(a),d=a.x-this.x,a=a.y-this.y;return Math.sqrt(d*d+a*a)},equals:function(a){a=y(a);return a.x===this.x&&a.y===this.y},contains:function(a){a=y(a);return Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=
Math.abs(this.y)},toString:function(){return"Point("+m(this.x)+", "+m(this.y)+")"}};z.prototype={extend:function(a){a=y(a);!this.min&&!this.max?(this.min=a.clone(),this.max=a.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(a.y,this.max.y));return this},getCenter:function(a){return new w((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return new w(this.min.x,this.max.y)},getTopRight:function(){return new w(this.max.x,
this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var d,a="number"===typeof a[0]||a instanceof w?y(a):D(a);a instanceof z?(d=a.min,a=a.max):d=a;return d.x>=this.min.x&&a.x<=this.max.x&&d.y>=this.min.y&&a.y<=this.max.y},intersects:function(a){var a=D(a),d=this.min,h=this.max,b=a.min,a=a.max,c=a.y>=d.y&&b.y<=h.y;return a.x>=d.x&&b.x<=h.x&&c},overlaps:function(a){var a=D(a),d=this.min,
h=this.max,b=a.min,a=a.max,c=a.y>d.y&&b.y<h.y;return a.x>d.x&&b.x<h.x&&c},isValid:function(){return!(!this.min||!this.max)}};u.prototype={extend:function(a){var d=this._southWest,h=this._northEast,b;if(a instanceof A)b=a;else if(a instanceof u){if(b=a._southWest,a=a._northEast,!b||!a)return this}else return a?this.extend(F(a)||x(a)):this;!d&&!h?(this._southWest=new A(b.lat,b.lng),this._northEast=new A(a.lat,a.lng)):(d.lat=Math.min(b.lat,d.lat),d.lng=Math.min(b.lng,d.lng),h.lat=Math.max(a.lat,h.lat),
h.lng=Math.max(a.lng,h.lng));return this},pad:function(a){var d=this._southWest,h=this._northEast,b=Math.abs(d.lat-h.lat)*a,a=Math.abs(d.lng-h.lng)*a;return new u(new A(d.lat-b,d.lng-a),new A(h.lat+b,h.lng+a))},getCenter:function(){return new A((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new A(this.getNorth(),this.getWest())},
getSouthEast:function(){return new A(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){var a="number"===typeof a[0]||a instanceof A||"lat"in a?F(a):x(a),d=this._southWest,h=this._northEast,b;a instanceof u?(b=a.getSouthWest(),a=a.getNorthEast()):b=a;return b.lat>=d.lat&&a.lat<=h.lat&&b.lng>=d.lng&&a.lng<=h.lng},
intersects:function(a){var a=x(a),d=this._southWest,h=this._northEast,b=a.getSouthWest(),a=a.getNorthEast(),c=a.lng>=d.lng&&b.lng<=h.lng;return a.lat>=d.lat&&b.lat<=h.lat&&c},overlaps:function(a){var a=x(a),d=this._southWest,h=this._northEast,b=a.getSouthWest(),a=a.getNorthEast(),c=a.lng>d.lng&&b.lng<h.lng;return a.lat>d.lat&&b.lat<h.lat&&c},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join()},equals:function(a,d){if(!a)return!1;a=x(a);return this._southWest.equals(a.getSouthWest(),
d)&&this._northEast.equals(a.getNorthEast(),d)},isValid:function(){return!(!this._southWest||!this._northEast)}};A.prototype={equals:function(a,d){if(!a)return!1;a=F(a);return Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng))<=(void 0===d?1.0E-9:d)},toString:function(a){return"LatLng("+m(this.lat,a)+", "+m(this.lng,a)+")"},distanceTo:function(a){return ra.distance(this,F(a))},distance80To:function(a){var a=AIMap.latLng(a),d=a.lat-this.lat,a=a.lng-this.lng;return Math.sqrt(d*d+a*a)},wrap:function(){return ra.wrapLatLng(this)},
toBounds:function(a){var a=180*a/40075017,d=a/Math.cos(Math.PI/180*this.lat);return x([this.lat-a,this.lng-d],[this.lat+a,this.lng+d])},clone:function(){return new A(this.lat,this.lng,this.alt)}};var oa={latLngToPoint:function(a,d){var h=this.projection.project(a),b=this.scale(d);return this.transformation._transform(h,b)},pointToLatLng:function(a,d){var h=this.scale(d);return this.projection.unproject(this.transformation.untransform(a,h))},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},
scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var d=this.projection.bounds,h=this.scale(a),a=this.transformation.transform(d.min,h),d=this.transformation.transform(d.max,h);return new z(a,d)},infinite:!1,wrapLatLng:function(a){var d=this.wrapLng?e(a.lng,this.wrapLng,!0):a.lng,h=this.wrapLat?e(a.lat,this.wrapLat,!0):a.lat;return new A(h,d,a.alt)},wrapLatLngBounds:function(a){var d=a.getCenter(),
h=this.wrapLatLng(d),b=d.lat-h.lat,d=d.lng-h.lng;if(0===b&&0===d)return a;h=a.getSouthWest();a=a.getNorthEast();h=new A(h.lat-b,h.lng-d);b=new A(a.lat-b,a.lng-d);return new u(h,b)}},ra=c({},oa,{wrapLng:[-180,180],R:6371E3,distance:function(a,d){var h=Math.PI/180,b=a.lat*h,c=d.lat*h,e=Math.sin((d.lat-a.lat)*h/2),h=Math.sin((d.lng-a.lng)*h/2),b=e*e+Math.cos(b)*Math.cos(c)*h*h;return this.R*2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b))}}),ac={R:6378137,MAX_LATITUDE:85.0511287798,project:function(a){var d=
Math.PI/180,h=this.MAX_LATITUDE,h=Math.max(Math.min(h,a.lat),-h),h=Math.sin(h*d);return new w(this.R*a.lng*d,this.R*Math.log((1+h)/(1-h))/2)},unproject:function(a){var d=180/Math.PI;return new A((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*d,a.x*d/this.R)},bounds:function(){var a=6378137*Math.PI;return new z([-a,-a],[a,a])}()};W.prototype={transform:function(a,d){return this._transform(a.clone(),d)},_transform:function(a,d){d=d||1;a.x=d*(this._a*a.x+this._b);a.y=d*(this._c*a.y+this._d);return a},
untransform:function(a,d){d=d||1;return new w((a.x/d-this._b)/this._a,(a.y/d-this._d)/this._c)}};var bc=c({},ra,{code:"EPSG:3857",projection:ac,transformation:function(){var a=0.5/(Math.PI*ac.R);return N(a,0.5,-a,0.5)}()}),od=c({},bc,{code:"EPSG:900913"}),cc=document.documentElement.style,wb="ActiveXObject"in window,Ma=wb&&!document.addEventListener,Sa="msLaunchUri"in navigator&&!("documentMode"in document),dc=R("webkit"),Ga=R("android"),$a=R("android 2")||R("android 3"),pd=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],
10),Lc=Ga&&R("Google")&&537>pd&&!("AudioNode"in window),ec=!!window.opera,Ta=R("chrome"),fc=R("gecko")&&!dc&&!ec&&!wb,Mc=!Ta&&R("safari"),Nc=R("phantom"),Oc="OTransition"in cc,Pc=0===navigator.platform.indexOf("Win"),Pb=wb&&"transition"in cc,gc="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!$a,Qc="MozPerspective"in cc,$=!window.AIMap_DISABLE_3D&&(Pb||gc||Qc)&&!Oc&&!Nc,Na="undefined"!==typeof orientation||R("mobile"),qd=Na&&dc,rd=Na&&gc,sa=!window.PointerEvent&&window.MSPointerEvent,
ca=!(!window.PointerEvent&&!sa),ha=!window.AIMap_NO_TOUCH&&(ca||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Rc=Na&&ec,sd=Na&&fc,ta=1<(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI),Ic=!!document.createElement("canvas").getContext,ib=!(!document.createElementNS||!S("svg").createSVGRect),vb=!ib&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var d=a.firstChild;d.style.behavior="url(#default#VML)";
return d&&"object"===typeof d.adj}catch(h){return!1}}(),td=(Object.freeze||Object)({ie:wb,ielt9:Ma,edge:Sa,webkit:dc,android:Ga,android23:$a,androidStock:Lc,opera:ec,chrome:Ta,gecko:fc,safari:Mc,phantom:Nc,opera12:Oc,win:Pc,ie3d:Pb,webkit3d:gc,gecko3d:Qc,any3d:$,mobile:Na,mobileWebkit:qd,mobileWebkit3d:rd,msPointer:sa,pointer:ca,touch:ha,mobileOpera:Rc,mobileGecko:sd,retina:ta,canvas:Ic,svg:ib,vml:vb}),Ab=sa?"MSPointerDown":"pointerdown",Bb=sa?"MSPointerMove":"pointermove",Cb=sa?"MSPointerUp":"pointerup",
Db=sa?"MSPointerCancel":"pointercancel",ld=["INPUT","SELECT","OPTION"],Ea={},uc=!1,Eb=0,jb=sa?"MSPointerDown":ca?"pointerdown":"touchstart",kb=sa?"MSPointerUp":ca?"pointerup":"touchend",Fa="_aimap_",da="_aimap_events",md=Pc&&Ta?2*window.devicePixelRatio:fc?window.devicePixelRatio:1,Kb={},Gb,ud=(Object.freeze||Object)({on:G,off:O,stopPropagation:xa,disableScrollPropagation:Ib,disableClickPropagation:Ua,preventDefault:Y,stop:ia,getMousePosition:xc,getWheelDelta:yc,fakeStop:Jb,skipped:Hb,isExternalTarget:mb,
addListener:G,removeListener:O}),Ob=ob(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),ab=ob(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Sc="webkitTransition"===ab||"OTransition"===ab?ab+"End":"transitionend",bb,cb,hc;if("onselectstart"in document)bb=function(){G(window,"selectstart",Y)},cb=function(){O(window,"selectstart",Y)};else{var db=ob(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);bb=function(){if(db){var a=
document.documentElement.style;hc=a[db];a[db]="none"}};cb=function(){db&&(document.documentElement.style[db]=hc,hc=void 0)}}var qb,Tb,vd=(Object.freeze||Object)({TRANSFORM:Ob,TRANSITION:ab,TRANSITION_END:Sc,get:zc,getStyle:Va,create:J,remove:K,empty:Lb,toFront:Ha,toBack:Ia,hasClass:Mb,addClass:H,removeClass:M,setClass:Nb,getClass:nb,setOpacity:Z,testProp:ob,setTransform:ya,setPosition:Q,getPosition:za,disableTextSelection:bb,enableTextSelection:cb,disableImageDrag:Qb,enableImageDrag:Rb,preventOutline:Sb,
restoreOutline:pb}),Tc=Za.extend({run:function(a,d,h,b){this.stop();this._el=a;this._inProgress=!0;this._duration=h||0.25;this._easeOutPower=1/Math.max(b||0.5,0.2);this._startPos=za(a);this._offset=d.subtract(this._startPos);this._startTime=+new Date;this.fire("start");this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=B(this._animate,this);this._step()},_step:function(a){var d=+new Date-this._startTime,h=1E3*this._duration;d<h?this._runFrame(this._easeOut(d/
h),a):(this._runFrame(1),this._complete())},_runFrame:function(a,d){var h=this._startPos.add(this._offset.multiplyBy(a));d&&h._round();Q(this._el,h);this.fire("step")},_complete:function(){v(this._animId);this._inProgress=!1;this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),I=Za.extend({options:{crs:bc,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,
transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,d){d=j(this,d);this._initContainer(a);this._initLayout();this._onResize=g(this._onResize,this);this._initEvents();d.maxBounds&&this.setMaxBounds(d.maxBounds);void 0!==d.zoom&&(this._zoom=this._limitZoom(d.zoom));d.center&&void 0!==d.zoom&&this.setView(F(d.center),d.zoom,{reset:!0});this._handlers=[];this._layers={};this._zoomBoundLayers={};this._sizeChanged=!0;this.callInitHooks();if(this._zoomAnimated=ab&&$&&!Rc&&
this.options.zoomAnimation)this._createAnimProxy(),G(this._proxy,Sc,this._catchTransitionEnd,this);this._addLayers(this.options.layers)},setView:function(a,d,h){d=void 0===d?this._zoom:this._limitZoom(d);a=this._limitCenter(F(a),d,this.options.maxBounds);h=h||{};this._stop();if(this._loaded&&(!h.reset&&!0!==h)&&(void 0!==h.animate&&(h.zoom=c({animate:h.animate},h.zoom),h.pan=c({animate:h.animate,duration:h.duration},h.pan)),this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,d,h.zoom):this._tryAnimatedPan(a,
h.pan)))return clearTimeout(this._sizeTimer),this;this._resetView(a,d);return this},setZoom:function(a,d){return!this._loaded?(this._zoom=a,this):this.setView(this.getCenter(),a,{zoom:d})},zoomIn:function(a,d){a=a||($?this.options.zoomDelta:1);return this.setZoom(this._zoom+a,d)},zoomOut:function(a,d){a=a||($?this.options.zoomDelta:1);return this.setZoom(this._zoom-a,d)},setZoomAround:function(a,d,h){var b=this.getZoomScale(d),c=this.getSize().divideBy(2),a=(a instanceof w?a:this.latLngToContainerPoint(a)).subtract(c).multiplyBy(1-
1/b);return this.setView(this.containerPointToLatLng(c.add(a)),d,{zoom:h})},_getBoundsCenterZoom:function(a,d){var d=d||{},a=a.getBounds?a.getBounds():x(a),h=y(d.paddingTopLeft||d.padding||[0,0]),b=y(d.paddingBottomRight||d.padding||[0,0]),c=this.getBoundsZoom(a,!1,h.add(b)),c="number"===typeof d.maxZoom?Math.min(d.maxZoom,c):c;if(Infinity===c)return{center:a.getCenter(),zoom:c};var h=b.subtract(h).divideBy(2),b=this.project(a.getSouthWest(),c),e=this.project(a.getNorthEast(),c);return{center:this.unproject(b.add(e).divideBy(2).add(h),
c),zoom:c}},fitBounds:function(a,d){a=x(a);if(!a.isValid())throw Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(a,d);return this.setView(h.center,h.zoom,d)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,d){return this.setView(a,this._zoom,{pan:d})},panBy:function(a,d){a=y(a).round();d=d||{};if(!a.x&&!a.y)return this.fire("moveend");if(!0!==d.animate&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),
this.getZoom()),this;this._panAnim||(this._panAnim=new Tc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this));d.noMoveStart||this.fire("movestart");!1!==d.animate?(H(this._mapPane,"aimap-pan-anim"),this._panAnim.run(this._mapPane,this._getMapPanePos().subtract(a).round(),d.duration||0.25,d.easeLinearity)):(this._rawPanBy(a),this.fire("move").fire("moveend"));return this},flyTo:function(a,d,h){function b(a){a=(o*o-i*i+(a?-1:1)*g*g*m*m)/(2*(a?o:i)*g*m);a=Math.sqrt(a*
a+1)-a;return 1.0E-9>a?-18:Math.log(a)}function c(a){return(Math.exp(a)+Math.exp(-a))/2}function e(){var h=(Date.now()-r)/t,b=(1-Math.pow(1-h,1.5))*q;1>=h?(this._flyToFrame=B(e,this),this._move(this.unproject(f.add(j.subtract(f).multiplyBy(i*(c(p)*((Math.exp(p+k*b)-Math.exp(-(p+k*b)))/2/c(p+k*b))-(Math.exp(p)-Math.exp(-p))/2)/g/m)),n),this.getScaleZoom(i/(i*(c(p)/c(p+k*b))),n),{flyTo:!0})):this._move(a,d)._moveEnd(!0)}h=h||{};if(!1===h.animate||!$)return this.setView(a,d,h);this._stop();var f=this.project(this.getCenter()),
j=this.project(a),l=this.getSize(),n=this._zoom,a=F(a),d=void 0===d?n:d,i=Math.max(l.x,l.y),o=i*this.getZoomScale(n,d),m=j.distanceTo(f)||1,k=1.42,g=k*k,p=b(0),r=Date.now(),q=(b(1)-p)/k,t=h.duration?1E3*h.duration:800*q;this._moveStart(!0,h.noMoveStart);e.call(this);return this},flyToBounds:function(a,d){var h=this._getBoundsCenterZoom(a,d);return this.flyTo(h.center,h.zoom,d)},setMaxBounds:function(a){a=x(a);if(a.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=
null,this.off("moveend",this._panInsideMaxBounds);this.options.maxBounds=a;this._loaded&&this._panInsideMaxBounds();return this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(a){var d=this.options.minZoom;this.options.minZoom=a;return this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var d=this.options.maxZoom;this.options.maxZoom=a;return this._loaded&&d!==a&&(this.fire("zoomlevelschange"),this.getZoom()>
this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,d){this._enforcingBounds=!0;var h=this.getCenter(),b=this._limitCenter(h,this._zoom,x(a));h.equals(b)||this.panTo(b,d);this._enforcingBounds=!1;return this},invalidateSize:function(a){if(!this._loaded)return this;var a=c({animate:!1,pan:!0},!0===a?{animate:!0}:a),d=this.getSize();this._sizeChanged=!0;this._lastCenter=null;var h=this.getSize(),b=d.divideBy(2).round(),e=h.divideBy(2).round(),b=b.subtract(e);if(!b.x&&!b.y)return this;
a.animate&&a.pan?this.panBy(b):(a.pan&&this._rawPanBy(b),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(g(this.fire,this,"moveend"),200)):this.fire("moveend"));return this.fire("resize",{oldSize:d,newSize:h})},stop:function(){this.setZoom(this._limitZoom(this._zoom));this.options.zoomSnap||this.fire("viewreset");return this._stop()},locate:function(a){a=this._locateOptions=c({timeout:1E4,watch:!1},a);if(!("geolocation"in navigator))return this._handleGeolocationError({code:0,
message:"Geolocation not supported."}),this;var d=g(this._handleGeolocationResponse,this),h=g(this._handleGeolocationError,this);a.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,h,a):navigator.geolocation.getCurrentPosition(d,h,a);return this},stopLocate:function(){navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId);this._locateOptions&&(this._locateOptions.setView=!1);return this},_handleGeolocationError:function(a){var d=
a.code,a=a.message||(1===d?"permission denied":2===d?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld();this.fire("locationerror",{code:d,message:"Geolocation error: "+a+"."})},_handleGeolocationResponse:function(a){var d=new A(a.coords.latitude,a.coords.longitude),h=d.toBounds(a.coords.accuracy),b=this._locateOptions;if(b.setView){var c=this.getBoundsZoom(h);this.setView(d,b.maxZoom?Math.min(c,b.maxZoom):c)}var d={latlng:d,bounds:h,timestamp:a.timestamp},
e;for(e in a.coords)"number"===typeof a.coords[e]&&(d[e]=a.coords[e]);this.fire("locationfound",d)},addHandler:function(a,d){if(!d)return this;var h=this[a]=new d(this);this._handlers.push(h);this.options[a]&&h.enable();return this},remove:function(){this._initEvents(!0);if(this._containerId!==this._container._aimap_id)throw Error("Map container is being reused by another instance");try{delete this._container._aimap_id,delete this._containerId}catch(a){this._containerId=this._container._aimap_id=
void 0}void 0!==this._locationWatchId&&this.stopLocate();this._stop();K(this._mapPane);this._clearControlPos&&this._clearControlPos();this._clearHandlers();this._loaded&&this.fire("unload");for(var d in this._layers)this._layers[d].remove();for(d in this._panes)K(this._panes[d]);this._layers=[];this._panes=[];delete this._mapPane;delete this._renderer;return this},createPane:function(a,d){var h="aimap-pane"+(a?" aimap-"+a.replace("Pane","")+"-pane":""),h=J("div",h,d||this._mapPane);a&&(this._panes[a]=
h);return h},getCenter:function(){this._checkIfLoaded();return this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),d=this.unproject(a.getBottomLeft()),a=this.unproject(a.getTopRight());return new u(d,a)},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?
void 0===this._layersMaxZoom?Infinity:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,d,h){var a=x(a),h=y(h||[0,0]),b=this.getZoom()||0,c=this.getMinZoom(),e=this.getMaxZoom(),f=a.getNorthWest(),a=a.getSouthEast(),h=this.getSize().subtract(h),j=D(this.project(a,b),this.project(f,b)).getSize(),f=$?this.options.zoomSnap:1,a=h.x/j.x,h=h.y/j.y,b=this.getScaleZoom(d?Math.max(a,h):Math.min(a,h),b);f&&(b=Math.round(b/(f/100))*(f/100),b=d?Math.ceil(b/f)*f:Math.floor(b/f)*f);return Math.max(c,
Math.min(e,b))},getSize:function(){if(!this._size||this._sizeChanged)this._size=new w(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1;return this._size.clone()},getPixelBounds:function(a,d){var h=this._getTopLeftPoint(a,d);return new z(h,h.add(this.getSize()))},getPixelOrigin:function(){this._checkIfLoaded();return this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(void 0===a?this.getZoom():a)},getPane:function(a){return"string"===
typeof a?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,d){var h=this.options.crs,d=void 0===d?this._zoom:d;return h.scale(a)/h.scale(d)},getScaleZoom:function(a,d){var h=this.options.crs,d=void 0===d?this._zoom:d,h=h.zoom(a*h.scale(d));return isNaN(h)?Infinity:h},project:function(a,d){d=void 0===d?this._zoom:d;return this.options.crs.latLngToPoint(F(a),d)},unproject:function(a,d){d=void 0===d?this._zoom:d;return this.options.crs.pointToLatLng(y(a),
d)},layerPointToLatLng:function(a){return this.unproject(y(a).add(this.getPixelOrigin()))},latLngToLayerPoint:function(a){return this.project(F(a))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(F(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(x(a))},distance:function(a,d){return this.options.crs.distance(F(a),F(d))},containerPointToLayerPoint:function(a){return y(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return y(a).add(this._getMapPanePos())},
containerPointToLatLng:function(a){return this.layerPointToLatLng(this.containerPointToLayerPoint(y(a)))},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(a)))},mouseEventToContainerPoint:function(a){return xc(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){if(a=
this._container=zc(a)){if(a._aimap_id)throw Error("Map container is already initialized.");}else throw Error("Map container not found.");G(a,"scroll",this._onScroll,this);this._containerId=b(a)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&$;H(a,"aimap-container"+(ha?" aimap-touch":"")+(ta?" aimap-retina":"")+(Ma?" aimap-oldie":"")+(Mc?" aimap-safari":"")+(this._fadeAnimated?" aimap-fade-anim":""));var d=Va(a,"position");"absolute"!==d&&("relative"!==
d&&"fixed"!==d)&&(a.style.position="relative");this._initPanes();this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={};this._mapPane=this.createPane("mapPane",this._container);Q(this._mapPane,new w(0,0));this.createPane("tilePane");this.createPane("shadowPane");this.createPane("overlayPane");this.createPane("markerPane");this.createPane("tooltipPane");this.createPane("popupPane");this.options.markerZoomAnimation||(H(a.markerPane,"aimap-zoom-hide"),
H(a.shadowPane,"aimap-zoom-hide"))},_resetView:function(a,d){Q(this._mapPane,new w(0,0));var h=!this._loaded;this._loaded=!0;d=this._limitZoom(d);this.fire("viewprereset");var b=this._zoom!==d;this._moveStart(b,!1)._move(a,d)._moveEnd(b);this.fire("viewreset");h&&this.fire("load")},_moveStart:function(a,d){a&&this.fire("zoomstart");d||this.fire("movestart");return this},_move:function(a,d,h){void 0===d&&(d=this._zoom);var b=this._zoom!==d;this._zoom=d;this._lastCenter=a;this._pixelOrigin=this._getNewPixelOrigin(a);
(b||h&&h.pinch)&&this.fire("zoom",h);return this.fire("move",h)},_moveEnd:function(a){a&&this.fire("zoomend");return this.fire("moveend")},_stop:function(){v(this._flyToFrame);this._panAnim&&this._panAnim.stop();return this},_rawPanBy:function(a){Q(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw Error("Set map center and zoom first.");
},_initEvents:function(a){this._targets={};this._targets[b(this._container)]=this;var d=a?O:G;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this);this.options.trackResize&&d(window,"resize",this._onResize,this);$&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){v(this._resizeRequest);this._resizeRequest=B(function(){this.invalidateSize({debounceMoveend:!0})},
this)},_onScroll:function(){this._container.scrollTop=0;this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,d){for(var h=[],c,e="mouseout"===d||"mouseover"===d,f=a.target||a.srcElement,j=!1;f;){if((c=this._targets[b(f)])&&("click"===d||"preclick"===d)&&!a._simulated&&this._draggableMoved(c)){j=!0;break}if(c&&c.listens(d,!0)){if(e&&
!mb(f,a))break;h.push(c);if(e)break}if(f===this._container)break;f=f.parentNode}!h.length&&(!j&&!e&&mb(f,a))&&(h=[this]);return h},_handleDOMEvent:function(a){if(this._loaded&&!Hb(a)){var d=a.type;if("mousedown"===d||"keypress"===d)Sb(a.target||a.srcElement);this._fireDOMEvent(a,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,d,h){if("click"===a.type){var b=c({},a);b.type="preclick";this._fireDOMEvent(b,b.type,h)}if(!a._stopped&&(h=(h||[]).concat(this._findEventTargets(a,
d)),h.length)){var e=h[0];"contextmenu"===d&&e.listens(d,!0)&&Y(a);b={originalEvent:a};if("keypress"!==a.type){var f=e.getLatLng&&(!e._radius||10>=e._radius);b.containerPoint=f?this.latLngToContainerPoint(e.getLatLng()):this.mouseEventToContainerPoint(a);b.layerPoint=this.containerPointToLayerPoint(b.containerPoint);b.latlng=f?e.getLatLng():this.layerPointToLatLng(b.layerPoint)}for(a=0;a<h.length&&!(h[a].fire(d,b,!0),b.originalEvent._stopped||!1===h[a].options.bubblingMouseEvents&&-1!==q(this._mouseEvents,
d));a++);}},_draggableMoved:function(a){a=a.dragging&&a.dragging.enabled()?a:this;return a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,d=this._handlers.length;a<d;a++)this._handlers[a].disable()},whenReady:function(a,d){if(this._loaded)a.call(d||this,{target:this});else this.on("load",a,d);return this},_getMapPanePos:function(){return za(this._mapPane)||new w(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},
_getTopLeftPoint:function(a,d){return(a&&void 0!==d?this._getNewPixelOrigin(a,d):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,d){var h=this.getSize()._divideBy(2);return this.project(a,d)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,d,h){h=this._getNewPixelOrigin(h,d);return this.project(a,d)._subtract(h)},_latLngBoundsToNewLayerBounds:function(a,d,h){h=this._getNewPixelOrigin(h,d);return D([this.project(a.getSouthWest(),
d)._subtract(h),this.project(a.getNorthWest(),d)._subtract(h),this.project(a.getSouthEast(),d)._subtract(h),this.project(a.getNorthEast(),d)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,d,h){if(!h)return a;var b=this.project(a,d),c=this.getSize().divideBy(2),h=this._getBoundsOffset(new z(b.subtract(c),
b.add(c)),h,d);return h.round().equals([0,0])?a:this.unproject(b.add(h),d)},_limitOffset:function(a,d){if(!d)return a;var h=this.getPixelBounds(),h=new z(h.min.add(a),h.max.add(a));return a.add(this._getBoundsOffset(h,d))},_getBoundsOffset:function(a,d,h){h=D(this.project(d.getNorthEast(),h),this.project(d.getSouthWest(),h));d=h.min.subtract(a.min);h=h.max.subtract(a.max);a=this._rebound(d.x,-h.x);d=this._rebound(d.y,-h.y);return new w(a,d)},_rebound:function(a,d){return 0<a+d?Math.round(a-d)/2:Math.max(0,
Math.ceil(a))-Math.max(0,Math.floor(d))},_limitZoom:function(a){var d=this.getMinZoom(),h=this.getMaxZoom(),b=$?this.options.zoomSnap:1;b&&(a=Math.round(a/b)*b);return Math.max(d,Math.min(h,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){M(this._mapPane,"aimap-pan-anim");this.fire("moveend")},_tryAnimatedPan:function(a,d){var h=this._getCenterOffset(a)._trunc();if(!0!==(d&&d.animate)&&!this.getSize().contains(h))return!1;this.panBy(h,d);return!0},_createAnimProxy:function(){this._panes.mapPane.appendChild(this._proxy=
J("div","aimap-proxy aimap-zoom-animated"));this.on("zoomanim",function(a){var d=Ob,h=this._proxy.style[d];ya(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1));h===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this);this.on("load moveend",function(){var a=this.getCenter(),d=this.getZoom();ya(this._proxy,this.project(a,d),this.getZoomScale(d,1))},this);this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){K(this._proxy);delete this._proxy},
_catchTransitionEnd:function(a){this._animatingZoom&&0<=a.propertyName.indexOf("transform")&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("aimap-zoom-animated").length},_tryAnimatedZoom:function(a,d,h){if(this._animatingZoom)return!0;h=h||{};if(!this._zoomAnimated||!1===h.animate||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(d),b=this._getCenterOffset(a)._divideBy(1-
1/b);if(!0!==h.animate&&!this.getSize().contains(b))return!1;B(function(){this._moveStart(!0,!1)._animateZoom(a,d,!0)},this);return!0},_animateZoom:function(a,d,h,b){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=d,H(this._mapPane,"aimap-zoom-anim")),this.fire("zoomanim",{center:a,zoom:d,noUpdate:b}),setTimeout(g(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&M(this._mapPane,"aimap-zoom-anim"),this._animatingZoom=
!1,this._move(this._animateToCenter,this._animateToZoom),B(function(){this._moveEnd(!0)},this))}}),ea=C.extend({options:{position:"topright"},initialize:function(a){j(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var d=this._map;d&&d.removeControl(this);this.options.position=a;d&&d.addControl(this);return this},getContainer:function(){return this._container},addTo:function(a){this.remove();this._map=a;var d=this._container=this.onAdd(a),h=this.getPosition(),
a=a._controlCorners[h];H(d,"aimap-control");-1!==h.indexOf("bottom")?a.insertBefore(d,a.firstChild):a.appendChild(d);return this},remove:function(){if(!this._map)return this;K(this._container);if(this.onRemove)this.onRemove(this._map);this._map=null;return this},_refocusOnMap:function(a){this._map&&(a&&0<a.screenX&&0<a.screenY)&&this._map.getContainer().focus()}}),eb=function(a){return new ea(a)};I.include({addControl:function(a){a.addTo(this);return this},removeControl:function(a){a.remove();return this},
_initControlPos:function(){function a(a,c){d[a+c]=J("div",h+a+" "+h+c,b)}var d=this._controlCorners={},h="aimap-",b=this._controlContainer=J("div",h+"control-container",this._container);a("top","left");a("top","right");a("bottom","left");a("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)K(this._controlCorners[a]);K(this._controlContainer);delete this._controlCorners;delete this._controlContainer}});var Uc=ea.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,
hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,d,h,b){return h<b?-1:b<h?1:0}},initialize:function(a,d,h){j(this,h);this._layerControlInputs=[];this._layers=[];this._lastZIndex=0;this._handlingClick=!1;for(var b in a)this._addLayer(a[b],b);for(b in d)this._addLayer(d[b],b,!0)},onAdd:function(a){this._initLayout();this._update();this._map=a;a.on("zoomend",this._checkDisabledLayers,this);for(a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},
addTo:function(a){ea.prototype.addTo.call(this,a);return this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,d){this._addLayer(a,d);return this._map?this._update():this},addOverlay:function(a,d){this._addLayer(a,d,!0);return this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,
this);(a=this._getLayer(b(a)))&&this._layers.splice(this._layers.indexOf(a),1);return this._map?this._update():this},expand:function(){H(this._container,"aimap-control-layers-expanded");this._form.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);a<this._form.clientHeight?(H(this._form,"aimap-control-layers-scrollbar"),this._form.style.height=a+"px"):M(this._form,"aimap-control-layers-scrollbar");this._checkDisabledLayers();return this},collapse:function(){M(this._container,
"aimap-control-layers-expanded");return this},_initLayout:function(){var a=this._container=J("div","aimap-control-layers"),d=this.options.collapsed;a.setAttribute("aria-haspopup",!0);Ua(a);Ib(a);var h=this._form=J("form","aimap-control-layers-list");d&&(this._map.on("click",this.collapse,this),Ga||G(a,{mouseenter:this.expand,mouseleave:this.collapse},this));var b=this._layersLink=J("a","aimap-control-layers-toggle",a);b.href="#";b.title="Layers";ha?(G(b,"click",ia),G(b,"click",this.expand,this)):
G(b,"focus",this.expand,this);d||this.expand();this._baseLayersList=J("div","aimap-control-layers-base",h);this._separator=J("div","aimap-control-layers-separator",h);this._overlaysList=J("div","aimap-control-layers-overlays",h);a.appendChild(h)},_getLayer:function(a){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&b(this._layers[d].layer)===a)return this._layers[d]},_addLayer:function(a,d,h){if(this._map)a.on("add remove",this._onLayerChange,this);this._layers.push({layer:a,name:d,overlay:h});
this.options.sortLayers&&this._layers.sort(g(function(a,d){return this.options.sortFunction(a.layer,d.layer,a.name,d.name)},this));this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex));this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Lb(this._baseLayersList);Lb(this._overlaysList);this._layerControlInputs=[];var a,d,h,b,c=0;for(h=0;h<this._layers.length;h++)b=this._layers[h],this._addItem(b),d=d||b.overlay,a=a||!b.overlay,c+=!b.overlay?
1:0;this.options.hideSingleBase&&(a=a&&1<c,this._baseLayersList.style.display=a?"":"none");this._separator.style.display=d&&a?"":"none";return this},_onLayerChange:function(a){this._handlingClick||this._update();var d=this._getLayer(b(a.target));(a=d.overlay?"add"===a.type?"overlayadd":"overlayremove":"add"===a.type?"baselayerchange":null)&&this._map.fire(a,d)},_createRadioElement:function(a,d){var h='<input type="radio" class="aimap-control-layers-selector" name="'+a+'"'+(d?' checked="checked"':
"")+"/>",b=document.createElement("div");b.innerHTML=h;return b.firstChild},_addItem:function(a){var d=document.createElement("label"),h=this._map.hasLayer(a.layer),c;a.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="aimap-control-layers-selector",c.defaultChecked=h):c=this._createRadioElement("aimap-base-layers",h);this._layerControlInputs.push(c);c.layerId=b(a.layer);G(c,"click",this._onInputClick,this);h=document.createElement("span");h.innerHTML=" "+a.name;var e=document.createElement("div");
d.appendChild(e);e.appendChild(c);e.appendChild(h);(a.overlay?this._overlaysList:this._baseLayersList).appendChild(d);this._checkDisabledLayers();return d},_onInputClick:function(){var a=this._layerControlInputs,d,h,b=[],c=[];this._handlingClick=!0;for(var e=a.length-1;0<=e;e--)d=a[e],h=this._getLayer(d.layerId).layer,d.checked?b.push(h):d.checked||c.push(h);for(e=0;e<c.length;e++)this._map.hasLayer(c[e])&&this._map.removeLayer(c[e]);for(e=0;e<b.length;e++)this._map.hasLayer(b[e])||this._map.addLayer(b[e]);
this._handlingClick=!1;this._refocusOnMap()},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,d,h,b=this._map.getZoom(),c=a.length-1;0<=c;c--)d=a[c],h=this._getLayer(d.layerId).layer,d.disabled=void 0!==h.options.minZoom&&b<h.options.minZoom||void 0!==h.options.maxZoom&&b>h.options.maxZoom},_expandIfNotCollapsed:function(){this._map&&!this.options.collapsed&&this.expand();return this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),ic=ea.extend({options:{position:"topleft",
zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(a){var d=J("div","aimap-control-zoom aimap-bar"),h=this.options;this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,"aimap-control-zoom-in",d,this._zoomIn);this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,"aimap-control-zoom-out",d,this._zoomOut);this._updateDisabled();a.on("zoomend zoomlevelschange",this._updateDisabled,this);return d},onRemove:function(a){a.off("zoomend zoomlevelschange",
this._updateDisabled,this)},disable:function(){this._disabled=!0;this._updateDisabled();return this},enable:function(){this._disabled=!1;this._updateDisabled();return this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,d,h,b,c){h=J("a",h,
b);h.innerHTML=a;h.href="#";h.title=d;h.setAttribute("role","button");h.setAttribute("aria-label",d);Ua(h);G(h,"click",ia);G(h,"click",c,this);G(h,"click",this._refocusOnMap,this);return h},_updateDisabled:function(){var a=this._map;M(this._zoomInButton,"aimap-disabled");M(this._zoomOutButton,"aimap-disabled");(this._disabled||a._zoom===a.getMinZoom())&&H(this._zoomOutButton,"aimap-disabled");(this._disabled||a._zoom===a.getMaxZoom())&&H(this._zoomInButton,"aimap-disabled")}});I.mergeOptions({zoomControl:!0});
I.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ic,this.addControl(this.zoomControl))});var Vc=ea.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var d=J("div","aimap-control-scale"),h=this.options;this._addScales(h,"aimap-control-scale-line",d);a.on(h.updateWhenIdle?"moveend":"move",this._update,this);a.whenReady(this._update,this);return d},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},
_addScales:function(a,d,h){a.metric&&(this._mScale=J("div",d,h));a.imperial&&(this._iScale=J("div",d,h))},_update:function(){var a=this._map,d=a.getSize().y/2;this._updateScales(a.distance(a.containerPointToLatLng([0,d]),a.containerPointToLatLng([this.options.maxWidth,d])))},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a);this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var d=this._getRoundNum(a);this._updateScale(this._mScale,1E3>d?d+" m":d/1E3+
" km",d/a)},_updateImperial:function(a){var a=3.2808399*a,d;5280<a?(a/=5280,d=this._getRoundNum(a),this._updateScale(this._iScale,d+" mi",d/a)):(d=this._getRoundNum(a),this._updateScale(this._iScale,d+" ft",d/a))},_updateScale:function(a,d,h){a.style.width=Math.round(this.options.maxWidth*h)+"px";a.innerHTML=d},_getRoundNum:function(a){var d=Math.pow(10,(Math.floor(a)+"").length-1),a=a/d;return d*(10<=a?10:5<=a?5:3<=a?3:2<=a?2:1)}}),jc=ea.extend({options:{position:"bottomright",prefix:'<a href="http://aimapjs.com" title="A JS library for interactive maps">AIMap</a>'},
initialize:function(a){j(this,a);this._attributions={}},onAdd:function(a){a.attributionControl=this;this._container=J("div","aimap-control-attribution");Ua(this._container);for(var d in a._layers)a._layers[d].getAttribution&&this.addAttribution(a._layers[d].getAttribution());this._update();return this._container},setPrefix:function(a){this.options.prefix=a;this._update();return this},addAttribution:function(a){if(!a)return this;this._attributions[a]||(this._attributions[a]=0);this._attributions[a]++;
this._update();return this},removeAttribution:function(a){if(!a)return this;this._attributions[a]&&(this._attributions[a]--,this._update());return this},_update:function(){if(this._map){var a=[],d;for(d in this._attributions)this._attributions[d]&&a.push(d);d=[];this.options.prefix&&d.push(this.options.prefix);a.length&&d.push(a.join(", "));this._container.innerHTML=d.join(" | ")}}});I.mergeOptions({attributionControl:!0});I.addInitHook(function(){this.options.attributionControl&&(new jc).addTo(this)});
ea.Layers=Uc;ea.Zoom=ic;ea.Scale=Vc;ea.Attribution=jc;eb.layers=function(a,d,h){return new Uc(a,d,h)};eb.zoom=function(a){return new ic(a)};eb.scale=function(a){return new Vc(a)};eb.attribution=function(a){return new jc(a)};var ja=C.extend({initialize:function(a){this._map=a},enable:function(){if(this._enabled)return this;this._enabled=!0;this.addHooks();return this},disable:function(){if(!this._enabled)return this;this._enabled=!1;this.removeHooks();return this},enabled:function(){return!!this._enabled}});
ja.addTo=function(a,d){a.addHandler(d,this);return this};var wd={Events:X},Wc=ha?"touchstart mousedown":"mousedown",Xc={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},kc={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Ca=Za.extend({options:{clickTolerance:3},initialize:function(a,d,h,b){j(this,b);this._element=a;this._dragStartTarget=d||a;this._preventOutline=h},enable:function(){this._enabled||(G(this._dragStartTarget,
Wc,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ca._dragging===this&&this.finishDrag(),O(this._dragStartTarget,Wc,this._onDown,this),this._moved=this._enabled=!1)},_onDown:function(a){if(!a._simulated&&this._enabled&&(this._moved=!1,!Mb(this._element,"aimap-zoom-anim")&&!Ca._dragging&&!(a.shiftKey||1!==a.which&&1!==a.button&&!a.touches)))if(Ca._dragging=this,this._preventOutline&&Sb(this._element),Qb(),bb(),!this._moving){this.fire("down");var d=a.touches?a.touches[0]:
a;this._startPoint=new w(d.clientX,d.clientY);G(document,kc[a.type],this._onMove,this);G(document,Xc[a.type],this._onUp,this)}},_onMove:function(a){if(!a._simulated&&this._enabled)if(a.touches&&1<a.touches.length)this._moved=!0;else{var d=a.touches&&1===a.touches.length?a.touches[0]:a,d=(new w(d.clientX,d.clientY)).subtract(this._startPoint);if((d.x||d.y)&&!(Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance))Y(a),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=za(this._element).subtract(d),
H(document.body,"aimap-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),H(this._lastTarget,"aimap-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,v(this._animRequest),this._lastEvent=a,this._animRequest=B(this._updatePosition,this,!0)}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a);Q(this._element,this._newPos);
this.fire("drag",a)},_onUp:function(a){!a._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){M(document.body,"aimap-dragging");this._lastTarget&&(M(this._lastTarget,"aimap-drag-target"),this._lastTarget=null);for(var a in kc)O(document,kc[a],this._onMove,this),O(document,Xc[a],this._onUp,this);Rb();cb();this._moved&&this._moving&&(v(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)}));this._moving=!1;Ca._dragging=!1}}),Dc,xd=(Object.freeze||
Object)({simplify:Ac,pointToSegmentDistance:Bc,closestPointOnSegment:function(a,d,h){return Wa(a,d,h)},clipSegment:Cc,_getEdgeIntersection:rb,_getBitCode:Aa,_sqClosestPointOnSegment:Wa,isFlat:la,_flat:Ec}),yd=(Object.freeze||Object)({clipPolygon:Fc}),lc={project:function(a){return new w(a.lng,a.lat)},unproject:function(a){return new A(a.y,a.x)},bounds:new z([-180,-90],[180,90])},mc={R:6378137,R_MINOR:6356752.314245179,bounds:new z([-2.003750834279E7,-1.549657073972E7],[2.003750834279E7,1.876465623138E7]),
project:function(a){var d=Math.PI/180,h=this.R,b=a.lat*d,c=this.R_MINOR/h,c=Math.sqrt(1-c*c),e=c*Math.sin(b),b=Math.tan(Math.PI/4-b/2)/Math.pow((1-e)/(1+e),c/2),b=-h*Math.log(Math.max(b,1.0E-10));return new w(a.lng*d*h,b)},unproject:function(a){for(var d=180/Math.PI,h=this.R,b=this.R_MINOR/h,b=Math.sqrt(1-b*b),c=Math.exp(-a.y/h),e=Math.PI/2-2*Math.atan(c),f=0,j=0.1;15>f&&1.0E-7<Math.abs(j);f++)j=b*Math.sin(e),j=Math.pow((1-j)/(1+j),b/2),j=Math.PI/2-2*Math.atan(c*j)-e,e+=j;return new A(e*d,a.x*d/h)}},
zd=(Object.freeze||Object)({LonLat:lc,Mercator:mc,SphericalMercator:ac}),Ad=c({},ra,{code:"EPSG:3395",projection:mc,transformation:function(){var a=0.5/(Math.PI*mc.R);return N(a,0.5,-a,0.5)}()}),Yc=c({},ra,{code:"EPSG:4326",projection:lc,transformation:N(1/180,1,-1/180,0.5)}),Bd=c({},oa,{projection:lc,transformation:N(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,d){var h=d.lng-a.lng,b=d.lat-a.lat;return Math.sqrt(h*h+b*b)},infinite:!0});
oa.Earth=ra;oa.EPSG3395=Ad;oa.EPSG3857=bc;oa.EPSG900913=od;oa.EPSG4326=Yc;oa.Simple=Bd;var aa=Za.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){a.addLayer(this);return this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){a&&a.removeLayer(this);return this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){this._map._targets[b(a)]=this;return this},
removeInteractiveTarget:function(a){delete this._map._targets[b(a)];return this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var d=a.target;if(d.hasLayer(this)){this._map=d;this._zoomAnimated=d._zoomAnimated;if(this.getEvents){var h=this.getEvents();d.on(h,this);this.once("remove",function(){d.off(h,this)},this)}this.onAdd(d);this.getAttribution&&d.attributionControl&&d.attributionControl.addAttribution(this.getAttribution());this.fire("add");d.fire("layeradd",
{layer:this})}}});I.include({addLayer:function(a){if(!a._layerAdd)throw Error("The provided object is not a Layer.");var d=b(a);if(this._layers[d])return this;this._layers[d]=a;a._mapToAdd=this;a.beforeAdd&&a.beforeAdd(this);this.whenReady(a._layerAdd,a);return this},removeLayer:function(a){var d=b(a);if(!this._layers[d])return this;if(this._loaded)a.onRemove(this);a.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(a.getAttribution());delete this._layers[d];this._loaded&&
(this.fire("layerremove",{layer:a}),a.fire("remove"));a._map=a._mapToAdd=null;return this},hasLayer:function(a){return!!a&&b(a)in this._layers},eachLayer:function(a,d){for(var h in this._layers)a.call(d,this._layers[h]);return this},_addLayers:function(a){for(var a=a?fa(a)?a:[a]:[],d=0,h=a.length;d<h;d++)this.addLayer(a[d])},_addZoomLimit:function(a){if(isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))this._zoomBoundLayers[b(a)]=a,this._updateZoomLevels()},_removeZoomLimit:function(a){a=b(a);this._zoomBoundLayers[a]&&
(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var a=Infinity,d=-Infinity,h=this._getZoomSpan(),b;for(b in this._zoomBoundLayers)var c=this._zoomBoundLayers[b].options,a=void 0===c.minZoom?a:Math.min(a,c.minZoom),d=void 0===c.maxZoom?d:Math.max(d,c.maxZoom);this._layersMaxZoom=-Infinity===d?void 0:d;this._layersMinZoom=Infinity===a?void 0:a;h!==this._getZoomSpan()&&this.fire("zoomlevelschange");void 0===this.options.maxZoom&&(this._layersMaxZoom&&this.getZoom()>
this._layersMaxZoom)&&this.setZoom(this._layersMaxZoom);void 0===this.options.minZoom&&(this._layersMinZoom&&this.getZoom()<this._layersMinZoom)&&this.setZoom(this._layersMinZoom)}});var Oa=aa.extend({initialize:function(a,d){j(this,d);this._layers={};var h,b;if(a){h=0;for(b=a.length;h<b;h++)this.addLayer(a[h])}},addLayer:function(a){this._layers[this.getLayerId(a)]=a;this._map&&this._map.addLayer(a);return this},removeLayer:function(a){a=a in this._layers?a:this.getLayerId(a);this._map&&this._layers[a]&&
this._map.removeLayer(this._layers[a]);delete this._layers[a];return this},hasLayer:function(a){return!!a&&(a in this._layers||this.getLayerId(a)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var d=Array.prototype.slice.call(arguments,1),h,b;for(h in this._layers)b=this._layers[h],b[a]&&b[a].apply(b,d);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,d){for(var h in this._layers)a.call(d,
this._layers[h]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];this.eachLayer(a.push,a);return a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return b(a)}}),Ba=Oa.extend({addLayer:function(a){if(this.hasLayer(a))return this;a.addEventParent(this);Oa.prototype.addLayer.call(this,a);return this.fire("layeradd",{layer:a})},removeLayer:function(a){if(!this.hasLayer(a))return this;a in this._layers&&(a=this._layers[a]);a.removeEventParent(this);
Oa.prototype.removeLayer.call(this,a);return this.fire("layerremove",{layer:a})},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new u,d;for(d in this._layers){var h=this._layers[d];a.extend(h.getBounds?h.getBounds():h.getLatLng())}return a}}),Pa=C.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(a){j(this,a)},createIcon:function(a){return this._createIcon("icon",
a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,d){var h=this._getIconUrl(a);if(!h){if("icon"===a)throw Error("iconUrl not set in Icon options (see the docs).");return null}h=this._createImg(h,d&&"IMG"===d.tagName?d:null);this._setIconStyles(h,a);return h},_setIconStyles:function(a,d){var h=this.options,b=h[d+"Size"];"number"===typeof b&&(b=[b,b]);var b=y(b),c=y("shadow"===d&&h.shadowAnchor||h.iconAnchor||b&&b.divideBy(2,!0));a.className="aimap-marker-"+d+
" "+(h.className||"");c&&(a.style.marginLeft=-c.x+"px",a.style.marginTop=-c.y+"px");b&&(a.style.width=b.x+"px",a.style.height=b.y+"px")},_createImg:function(a,d){d=d||document.createElement("img");d.src=a;return d},_getIconUrl:function(a){return ta&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}}),fb=Pa.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,
41]},_getIconUrl:function(a){fb.imagePath||(fb.imagePath=this._detectIconPath());return(this.options.imagePath||fb.imagePath)+Pa.prototype._getIconUrl.call(this,a)},_detectIconPath:function(){var a=J("div","aimap-default-icon-path",document.body),d=Va(a,"background-image")||Va(a,"backgroundImage");document.body.removeChild(a);return d=null===d||0!==d.indexOf("url")?"":d.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),Zc=ja.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=
this._marker._icon;this._draggable||(this._draggable=new Ca(a,a,!0));this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable();H(a,"aimap-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable();this._marker._icon&&M(this._marker._icon,"aimap-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},
_adjustPan:function(a){var d=this._marker,h=d._map,b=this._marker.options.autoPanSpeed,c=this._marker.options.autoPanPadding,e=AIMap.DomUtil.getPosition(d._icon),f=h.getPixelBounds(),j=h.getPixelOrigin(),c=D(f.min._subtract(j).add(c),f.max._subtract(j).subtract(c));c.contains(e)||(b=y((Math.max(c.max.x,e.x)-c.max.x)/(f.max.x-c.max.x)-(Math.min(c.min.x,e.x)-c.min.x)/(f.min.x-c.min.x),(Math.max(c.max.y,e.y)-c.max.y)/(f.max.y-c.max.y)-(Math.min(c.min.y,e.y)-c.min.y)/(f.min.y-c.min.y)).multiplyBy(b),
h.panBy(b,{animate:!1}),this._draggable._newPos._add(b),this._draggable._startPos._add(b),AIMap.DomUtil.setPosition(d._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=B(this._adjustPan.bind(this,a)))},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng();this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(v(this._panRequest),this._panRequest=B(this._adjustPan.bind(this,a)))},_onDrag:function(a){var d=this._marker,
h=d._shadow,b=za(d._icon),c=d._map.layerPointToLatLng(b);h&&Q(h,b);d._latlng=c;a.latlng=c;a.oldLatLng=this._oldLatLng;d.fire("move",a).fire("drag",a)},_onDragEnd:function(a){v(this._panRequest);delete this._oldLatLng;this._marker.fire("moveend").fire("dragend",a)}}),Xa=aa.extend({options:{icon:new fb,interactive:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1},
initialize:function(a,d){j(this,d);this._latlng=F(a)},onAdd:function(a){if(this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation)a.on("zoomanim",this._animateZoom,this);this._initIcon();this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks());delete this.dragging;this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this);this._removeIcon();this._removeShadow()},getEvents:function(){return{zoom:this.update,
viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var d=this._latlng;this._latlng=F(a);this.update();return this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(a){this.options.zIndexOffset=a;return this.update()},setIcon:function(a){this.options.icon=a;this._map&&(this._initIcon(),this.update());this._popup&&this.bindPopup(this._popup,this._popup.options);return this},getElement:function(){return this._icon},update:function(){this._icon&&
this._map&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round());return this},_initIcon:function(){var a=this.options,d="aimap-zoom-"+(this._zoomAnimated?"animated":"hide"),h=a.icon.createIcon(this._icon),b=!1;if(h!==this._icon&&(this._icon&&this._removeIcon(),b=!0,a.title&&(h.title=a.title),"IMG"===h.tagName))h.alt=a.alt||"";H(h,d);a.keyboard&&(h.tabIndex="0");this._icon=h;if(a.riseOnHover)this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var h=a.icon.createShadow(this._shadow),
c=!1;h!==this._shadow&&(this._removeShadow(),c=!0);h&&(H(h,d),h.alt="");this._shadow=h;1>a.opacity&&this._updateOpacity();b&&this.getPane().appendChild(this._icon);this._initInteraction();h&&c&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex});K(this._icon);this.removeInteractiveTarget(this._icon);this._icon=null},_removeShadow:function(){this._shadow&&K(this._shadow);this._shadow=
null},_setPos:function(a){Q(this._icon,a);this._shadow&&Q(this._shadow,a);this._zIndex=a.y+this.options.zIndexOffset;this._resetZIndex()},_updateZIndex:function(a){this._icon.style.zIndex=this._zIndex+a},_animateZoom:function(a){this._setPos(this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round())},_initInteraction:function(){if(this.options.interactive&&(H(this._icon,"aimap-interactive"),this.addInteractiveTarget(this._icon),Zc)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),
this.dragging.disable());this.dragging=new Zc(this);a&&this.dragging.enable()}},setOpacity:function(a){this.options.opacity=a;this._map&&this._updateOpacity();return this},_updateOpacity:function(){var a=this.options.opacity;Z(this._icon,a);this._shadow&&Z(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),
ua=aa.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:0.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this);this._reset();this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){this._map&&this._renderer._updatePath(this);return this},
setStyle:function(a){j(this,a);this._renderer&&this._renderer._updateStyle(this);return this},bringToFront:function(){this._renderer&&this._renderer._bringToFront(this);return this},bringToBack:function(){this._renderer&&this._renderer._bringToBack(this);return this},getElement:function(){return this._path},_reset:function(){this._project();this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),xb=ua.extend({options:{fill:!0,
radius:10},initialize:function(a,d){j(this,d);this._latlng=F(a);this._radius=this.options.radius},setLatLng:function(a){this._latlng=F(a);this.redraw();return this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){this.options.radius=this._radius=a;return this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var d=a&&a.radius||this._radius;ua.prototype.setStyle.call(this,a);this.setRadius(d);return this},_project:function(){this._point=
this._map.latLngToLayerPoint(this._latlng);this._updateBounds()},_updateBounds:function(){var a=this._radius,d=this._radiusY||a,h=this._clickTolerance(),a=[a+h,d+h];this._pxBounds=new z(this._point.subtract(a),this._point.add(a))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+
this._clickTolerance()}}),nc=xb.extend({initialize:function(a,d,h){"number"===typeof d&&(d=c({},h,{radius:d}));j(this,d);this._latlng=F(a);if(isNaN(this.options.radius))throw Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){this._mRadius=a;return this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new u(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},
setStyle:ua.prototype.setStyle,_project:function(){var a=this._latlng.lng,d=this._latlng.lat,h=this._map,b=h.options.crs;if(b.distance===ra.distance){var c=Math.PI/180,b=this._mRadius/ra.R/c,e=h.project([d+b,a]),f=h.project([d-b,a]),f=e.add(f).divideBy(2),j=h.unproject(f).lat,c=Math.acos((Math.cos(b*c)-Math.sin(d*c)*Math.sin(j*c))/(Math.cos(d*c)*Math.cos(j*c)))/c;if(isNaN(c)||0===c)c=b/Math.cos(Math.PI/180*d);this._point=f.subtract(h.getPixelOrigin());this._radius=isNaN(c)?0:f.x-h.project([j,a-c]).x;
this._radiusY=f.y-e.y}else a=b.unproject(b.project(this._latlng).subtract([this._mRadius,0])),this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(a).x;this._updateBounds()}}),ma=ua.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,d){j(this,d);this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){this._setLatLngs(a);return this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var d=
Infinity,h=null,b=Wa,c,e,f=0,j=this._parts.length;f<j;f++)for(var l=this._parts[f],n=1,i=l.length;n<i;n++){c=l[n-1];e=l[n];var m=b(a,c,e,!0);m<d&&(d=m,h=b(a,c,e))}h&&(h.distance=Math.sqrt(d));return h},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,d,h,b,c,e,f=this._rings[0],j=f.length;if(!j)return null;for(d=a=0;a<j-1;a++)d+=f[a].distanceTo(f[a+1])/2;if(0===d)return this._map.layerPointToLatLng(f[0]);for(b=a=0;a<j-1;a++)if(c=f[a],e=f[a+1],h=
c.distanceTo(e),b+=h,b>d)return a=(b-d)/h,this._map.layerPointToLatLng([e.x-a*(e.x-c.x),e.y-a*(e.y-c.y)])},getBounds:function(){return this._bounds},addLatLng:function(a,d){d=d||this._defaultShape();a=F(a);d.push(a);this._bounds.extend(a);return this.redraw()},_setLatLngs:function(a){this._bounds=new u;this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return la(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var d=[],h=la(a),b=0,c=a.length;b<c;b++)h?(d[b]=
F(a[b]),this._bounds.extend(d[b])):d[b]=this._convertLatLngs(a[b]);return d},_project:function(){var a=new z;this._rings=[];this._projectLatlngs(this._latlngs,this._rings,a);var d=this._clickTolerance(),d=new w(d,d);this._bounds.isValid()&&a.isValid()&&(a.min._subtract(d),a.max._add(d),this._pxBounds=a)},_projectLatlngs:function(a,d,h){var b=a.length,c,e;if(a[0]instanceof A){e=[];for(c=0;c<b;c++)e[c]=this._map.latLngToLayerPoint(a[c]),h.extend(e[c]);d.push(e)}else for(c=0;c<b;c++)this._projectLatlngs(a[c],
d,h)},_clipPoints:function(){var a=this._renderer._bounds;this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else{var d=this._parts,h,b,c,e,f,j,l;c=h=0;for(e=this._rings.length;h<e;h++){l=this._rings[h];b=0;for(f=l.length;b<f-1;b++)if(j=Cc(l[b],l[b+1],a,b,!0))if(d[c]=d[c]||[],d[c].push(j[0]),j[1]!==l[b+1]||b===f-2)d[c].push(j[1]),c++}}},_simplifyPoints:function(){for(var a=this._parts,d=this.options.smoothFactor,b=0,c=a.length;b<c;b++)a[b]=
Ac(a[b],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,d){var b,c,e,f,j,l,n=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;b=0;for(f=this._parts.length;b<f;b++){l=this._parts[b];c=0;j=l.length;for(e=j-1;c<j;e=c++)if((d||0!==c)&&Bc(a,l[e],l[c])<=n)return!0}return!1}});ma._flat=Ec;var Ja=ma.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||
!this._latlngs[0].length},getCenter:function(){if(!this._map)throw Error("Must add layer to map before using getCenter()");var a,d,b,c,e,f,j,l=this._rings[0],n=l.length;if(!n)return null;a=e=f=j=0;for(d=n-1;a<n;d=a++)b=l[a],d=l[d],c=b.y*d.x-d.y*b.x,f+=(b.x+d.x)*c,j+=(b.y+d.y)*c,e+=3*c;return this._map.layerPointToLatLng(0===e?l[0]:[f/e,j/e])},_convertLatLngs:function(a){var a=ma.prototype._convertLatLngs.call(this,a),d=a.length;2<=d&&(a[0]instanceof A&&a[0].equals(a[d-1]))&&a.pop();return a},_setLatLngs:function(a){ma.prototype._setLatLngs.call(this,
a);la(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return la(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,d=this.options.weight,d=new w(d,d),a=new z(a.min.subtract(d),a.max.add(d));this._parts=[];if(this._pxBounds&&this._pxBounds.intersects(a))if(this.options.noClip)this._parts=this._rings;else for(var d=0,b=this._rings.length,c;d<b;d++)c=Fc(this._rings[d],a,!0),c.length&&this._parts.push(c)},_updatePath:function(){this._renderer._updatePoly(this,
!0)},_containsPoint:function(a){var d=!1,b,c,e,f,j,l,n;if(!this._pxBounds.contains(a))return!1;f=0;for(l=this._parts.length;f<l;f++){b=this._parts[f];j=0;n=b.length;for(e=n-1;j<n;e=j++)c=b[j],e=b[e],c.y>a.y!==e.y>a.y&&a.x<(e.x-c.x)*(a.y-c.y)/(e.y-c.y)+c.x&&(d=!d)}return d||ma.prototype._containsPoint.call(this,a,!0)}}),na=Ba.extend({initialize:function(a,d){j(this,d);this._layers={};a&&this.addData(a)},addData:function(a){var d=fa(a)?a:a.features,b,c;if(d){a=0;for(b=d.length;a<b;a++)c=d[a],(c.geometries||
c.geometry||c.features||c.coordinates)&&this.addData(c);return this}d=this.options;if(d.filter&&!d.filter(a))return this;b=Vb(a,d);if(!b)return this;b.feature=ub(a);b.defaultOptions=b.options;this.resetStyle(b);if(d.onEachFeature)d.onEachFeature(a,b);return this.addLayer(b)},resetStyle:function(a){a.options=c({},a.defaultOptions);this._setLayerStyle(a,this.options.style);return this},setStyle:function(a){return this.eachLayer(function(d){this._setLayerStyle(d,a)},this)},_setLayerStyle:function(a,
d){"function"===typeof d&&(d=d(a.feature));a.setStyle&&a.setStyle(d)}}),oc={toGeoJSON:function(a){return Ka(this,{type:"Point",coordinates:Xb(this.getLatLng(),a)})}};Xa.include(oc);nc.include(oc);xb.include(oc);ma.include({toGeoJSON:function(a){var d=!la(this._latlngs),a=tb(this._latlngs,d?1:0,!1,a);return Ka(this,{type:(d?"Multi":"")+"LineString",coordinates:a})}});Ja.include({toGeoJSON:function(a){var d=!la(this._latlngs),b=d&&!la(this._latlngs[0]),a=tb(this._latlngs,b?2:d?1:0,!0,a);d||(a=[a]);
return Ka(this,{type:(b?"Multi":"")+"Polygon",coordinates:a})}});Oa.include({toMultiPoint:function(a){var d=[];this.eachLayer(function(b){d.push(b.toGeoJSON(a).geometry.coordinates)});return Ka(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(a){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===d)return this.toMultiPoint(a);var b="GeometryCollection"===d,c=[];this.eachLayer(function(d){d.toGeoJSON&&(d=d.toGeoJSON(a),b?c.push(d.geometry):(d=ub(d),"FeatureCollection"===
d.type?c.push.apply(c,d.features):c.push(d)))});return b?Ka(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}});var pc=aa.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,d,b){this._url=a;this._bounds=x(d);j(this,b)},onAdd:function(){this._image||(this._initImage(),1>this.options.opacity&&this._updateOpacity());this.options.interactive&&(H(this._image,"aimap-interactive"),this.addInteractiveTarget(this._image));
this.getPane().appendChild(this._image);this._reset()},onRemove:function(){K(this._image);this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){this.options.opacity=a;this._image&&this._updateOpacity();return this},setStyle:function(a){a.opacity&&this.setOpacity(a.opacity);return this},bringToFront:function(){this._map&&Ha(this._image);return this},bringToBack:function(){this._map&&Ia(this._image);return this},setUrl:function(a){this._url=a;this._image&&(this._image.src=
a);return this},setBounds:function(a){this._bounds=x(a);this._map&&this._reset();return this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a="IMG"===this._url.tagName,d=this._image=a?this._url:J("img");H(d,"aimap-image-layer");this._zoomAnimated&&
H(d,"aimap-zoom-animated");this.options.className&&H(d,this.options.className);d.onselectstart=i;d.onmousemove=i;d.onload=g(this.fire,this,"load");d.onerror=g(this._overlayOnError,this,"error");this.options.crossOrigin&&(d.crossOrigin="");this.options.zIndex&&this._updateZIndex();a?this._url=d.src:(d.src=this._url,d.alt=this.options.alt)},_animateZoom:function(a){var d=this._map.getZoomScale(a.zoom),a=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;ya(this._image,a,d)},_reset:function(){var a=
this._image,d=new z(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),b=d.getSize();Q(a,d.min);a.style.width=b.x+"px";a.style.height=b.y+"px"},_updateOpacity:function(){Z(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&(void 0!==this.options.zIndex&&null!==this.options.zIndex)&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&
this._url!==a&&(this._url=a,this._image.src=a)}}),$c=pc.extend({options:{autoplay:!0,loop:!0},_initImage:function(){var a="VIDEO"===this._url.tagName,d=this._image=a?this._url:J("video");H(d,"aimap-image-layer");this._zoomAnimated&&H(d,"aimap-zoom-animated");d.onselectstart=i;d.onmousemove=i;d.onloadeddata=g(this.fire,this,"load");if(a){for(var a=d.getElementsByTagName("source"),b=[],c=0;c<a.length;c++)b.push(a[c].src);this._url=0<a.length?b:[d.src]}else{fa(this._url)||(this._url=[this._url]);d.autoplay=
!!this.options.autoplay;d.loop=!!this.options.loop;for(a=0;a<this._url.length;a++)b=J("source"),b.src=this._url[a],d.appendChild(b)}}}),pa=aa.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(a,d){j(this,a);this._source=d},onAdd:function(a){this._zoomAnimated=a._zoomAnimated;this._container||this._initLayout();a._fadeAnimated&&Z(this._container,0);clearTimeout(this._removeTimeout);this.getPane().appendChild(this._container);this.update();a._fadeAnimated&&Z(this._container,
1);this.bringToFront()},onRemove:function(a){a._fadeAnimated?(Z(this._container,0),this._removeTimeout=setTimeout(g(K,void 0,this._container),200)):K(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(a){this._latlng=F(a);this._map&&(this._updatePosition(),this._adjustPan());return this},getContent:function(){return this._content},setContent:function(a){this._content=a;this.update();return this},getElement:function(){return this._container},update:function(){this._map&&
(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){this._map&&Ha(this._container);return this},bringToBack:function(){this._map&&Ia(this._container);return this},
_updateContent:function(){if(this._content){var a=this._contentNode,d="function"===typeof this._content?this._content(this._source||this):this._content;if("string"===typeof d)a.innerHTML=d;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),d=y(this.options.offset),b=this._getAnchor();this._zoomAnimated?Q(this._container,a.add(b)):d=d.add(a).add(b);a=this._containerBottom=
-d.y;d=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=a+"px";this._container.style.left=d+"px"}},_getAnchor:function(){return[0,0]}}),Qa=pa.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){a.openPopup(this);return this},onAdd:function(a){pa.prototype.onAdd.call(this,
a);a.fire("popupopen",{popup:this});if(this._source&&(this._source.fire("popupopen",{popup:this},!0),!(this._source instanceof ua)))this._source.on("preclick",xa)},onRemove:function(a){pa.prototype.onRemove.call(this,a);a.fire("popupclose",{popup:this});this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ua||this._source.off("preclick",xa))},getEvents:function(){var a=pa.prototype.getEvents.call(this);if(void 0!==this.options.closeOnClick?this.options.closeOnClick:
this._map.options.closePopupOnClick)a.preclick=this._close;this.options.keepInView&&(a.moveend=this._adjustPan);return a},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var a=this._container=J("div","aimap-popup "+(this.options.className||"")+" aimap-zoom-animated"),d=this._wrapper=J("div","aimap-popup-content-wrapper",a);this._contentNode=J("div","aimap-popup-content",d);Ua(d);Ib(this._contentNode);G(d,"contextmenu",xa);this._tipContainer=J("div","aimap-popup-tip-container",
a);this._tip=J("div","aimap-popup-tip",this._tipContainer);this.options.closeButton&&(a=this._closeButton=J("a","aimap-popup-close-button",a),a.href="#close",a.innerHTML="&#215;",G(a,"click",this._onCloseButtonClick,this))},_updateLayout:function(){var a=this._contentNode,d=a.style;d.width="";d.whiteSpace="nowrap";var b=a.offsetWidth,b=Math.min(b,this.options.maxWidth),b=Math.max(b,this.options.minWidth);d.width=b+1+"px";d.whiteSpace="";d.height="";var b=a.offsetHeight,c=this.options.maxHeight;c&&
b>c?(d.height=c+"px",H(a,"aimap-popup-scrolled")):M(a,"aimap-popup-scrolled");this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var a=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),d=this._getAnchor();Q(this._container,a.add(d))},_adjustPan:function(){if(this.options.autoPan&&(!this._map._panAnim||!this._map._panAnim._inProgress)){var a=this._map,d=this._container.offsetHeight+(parseInt(Va(this._container,"marginBottom"),10)||0),b=this._containerWidth,c=new w(this._containerLeft,
-d-this._containerBottom);c._add(za(this._container));var c=a.layerPointToContainerPoint(c),e=y(this.options.autoPanPadding),f=y(this.options.autoPanPaddingTopLeft||e),e=y(this.options.autoPanPaddingBottomRight||e),j=a.getSize(),l=0,n=0;c.x+b+e.x>j.x&&(l=c.x+b-j.x+e.x);0>c.x-l-f.x&&(l=c.x-f.x);c.y+d+e.y>j.y&&(n=c.y+d-j.y+e.y);0>c.y-n-f.y&&(n=c.y-f.y);(l||n)&&a.fire("autopanstart").panBy([l,n])}},_onCloseButtonClick:function(a){this._close();ia(a)},_getAnchor:function(){return y(this._source&&this._source._getPopupAnchor?
this._source._getPopupAnchor():[0,0])}});I.mergeOptions({closePopupOnClick:!0});I.include({openPopup:function(a,d,b){a instanceof Qa||(a=(new Qa(b)).setContent(a));d&&a.setLatLng(d);if(this.hasLayer(a))return this;this._popup&&this._popup.options.autoClose&&this.closePopup();this._popup=a;return this.addLayer(a)},closePopup:function(a){if(!a||a===this._popup)a=this._popup,this._popup=null;a&&this.removeLayer(a);return this}});aa.include({bindPopup:function(a,d){if(a instanceof Qa)j(a,d),this._popup=
a,a._source=this;else{if(!this._popup||d)this._popup=new Qa(d,this);this._popup.setContent(a)}this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0);return this},unbindPopup:function(){this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null);return this},openPopup:function(a,d){a instanceof
aa||(d=a,a=this);if(a instanceof Ba)for(var b in this._layers){a=this._layers[b];break}d||(d=a.getCenter?a.getCenter():a.getLatLng());this._popup&&this._map&&(this._popup._source=a,this._popup.update(),this._map.openPopup(this._popup,d));return this},closePopup:function(){this._popup&&this._popup._close();return this},togglePopup:function(a){this._popup&&(this._popup._map?this.closePopup():this.openPopup(a));return this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){this._popup&&
this._popup.setContent(a);return this},getPopup:function(){return this._popup},_openPopup:function(a){var d=a.layer||a.target;this._popup&&this._map&&(ia(a),d instanceof ua?this.openPopup(a.layer||a.target,a.latlng):this._map.hasLayer(this._popup)&&this._popup._source===d?this.closePopup():this.openPopup(d,a.latlng))},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){13===a.originalEvent.keyCode&&this._openPopup(a)}});var Ra=pa.extend({options:{pane:"tooltipPane",offset:[0,
0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:0.9},onAdd:function(a){pa.prototype.onAdd.call(this,a);this.setOpacity(this.options.opacity);a.fire("tooltipopen",{tooltip:this});this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(a){pa.prototype.onRemove.call(this,a);a.fire("tooltipclose",{tooltip:this});this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var a=pa.prototype.getEvents.call(this);ha&&!this.options.permanent&&
(a.preclick=this._close);return a},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){this._contentNode=this._container=J("div","aimap-tooltip "+(this.options.className||"")+" aimap-zoom-"+(this._zoomAnimated?"animated":"hide"))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var d=this._map,b=this._container,c=d.latLngToContainerPoint(d.getCenter()),d=d.layerPointToContainerPoint(a),e=this.options.direction,f=b.offsetWidth,j=b.offsetHeight,
l=y(this.options.offset),n=this._getAnchor();"top"===e?a=a.add(y(-f/2+l.x,-j+l.y+n.y,!0)):"bottom"===e?a=a.subtract(y(f/2-l.x,-l.y,!0)):"center"===e?a=a.subtract(y(f/2+l.x,j/2-n.y+l.y,!0)):"right"===e||"auto"===e&&d.x<c.x?(e="right",a=a.add(y(l.x+n.x,n.y-j/2+l.y,!0))):(e="left",a=a.subtract(y(f+n.x-l.x,j/2-n.y-l.y,!0)));M(b,"aimap-tooltip-right");M(b,"aimap-tooltip-left");M(b,"aimap-tooltip-top");M(b,"aimap-tooltip-bottom");H(b,"aimap-tooltip-"+e);Q(b,a)},_updatePosition:function(){this._setPosition(this._map.latLngToLayerPoint(this._latlng))},
setOpacity:function(a){this.options.opacity=a;this._container&&Z(this._container,a)},_animateZoom:function(a){this._setPosition(this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center))},_getAnchor:function(){return y(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});I.include({openTooltip:function(a,d,b){a instanceof Ra||(a=(new Ra(b)).setContent(a));d&&a.setLatLng(d);return this.hasLayer(a)?this:this.addLayer(a)},closeTooltip:function(a){a&&
this.removeLayer(a);return this}});aa.include({bindTooltip:function(a,d){if(a instanceof Ra)j(a,d),this._tooltip=a,a._source=this;else{if(!this._tooltip||d)this._tooltip=new Ra(d,this);this._tooltip.setContent(a)}this._initTooltipInteractions();this._tooltip.options.permanent&&(this._map&&this._map.hasLayer(this))&&this.openTooltip();return this},unbindTooltip:function(){this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null);return this},_initTooltipInteractions:function(a){if(a||
!this._tooltipHandlersAdded){var d={remove:this.closeTooltip,move:this._moveTooltip};if(this._tooltip.options.permanent)d.add=this._openTooltip;else if(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),ha)d.click=this._openTooltip;this[a?"off":"on"](d);this._tooltipHandlersAdded=!a}},openTooltip:function(a,d){a instanceof aa||(d=a,a=this);if(a instanceof Ba)for(var b in this._layers){a=this._layers[b];break}d||(d=a.getCenter?a.getCenter():
a.getLatLng());this._tooltip&&this._map&&(this._tooltip._source=a,this._tooltip.update(),this._map.openTooltip(this._tooltip,d),this._tooltip.options.interactive&&this._tooltip._container&&(H(this._tooltip._container,"aimap-clickable"),this.addInteractiveTarget(this._tooltip._container)));return this},closeTooltip:function(){this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(M(this._tooltip._container,"aimap-clickable"),this.removeInteractiveTarget(this._tooltip._container)));
return this},toggleTooltip:function(a){this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(a));return this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){this._tooltip&&this._tooltip.setContent(a);return this},getTooltip:function(){return this._tooltip},_openTooltip:function(a){var d=a.layer||a.target;this._tooltip&&this._map&&this.openTooltip(d,this._tooltip.options.sticky?a.latlng:void 0)},_moveTooltip:function(a){var d=a.latlng;this._tooltip.options.sticky&&
a.originalEvent&&(a=this._map.mouseEventToContainerPoint(a.originalEvent),a=this._map.containerPointToLayerPoint(a),d=this._map.layerPointToLatLng(a));this._tooltip.setLatLng(d)}});var ad=Pa.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"aimap-div-icon"},createIcon:function(a){var a=a&&"DIV"===a.tagName?a:document.createElement("div"),d=this.options;a.innerHTML=!1!==d.html?d.html:"";d.bgPos&&(d=y(d.bgPos),a.style.backgroundPosition=-d.x+"px "+-d.y+"px");this._setIconStyles(a,"icon");
return a},createShadow:function(){return null}});Pa.Default=fb;var qc=aa.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Na,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){j(this,a)},onAdd:function(){this._initContainer();this._levels={};this._tiles={};this._resetView();this._update()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles();
K(this._container);a._removeZoomLimit(this);this._container=null;this._tileZoom=void 0},bringToFront:function(){this._map&&(Ha(this._container),this._setAutoZIndex(Math.max));return this},bringToBack:function(){this._map&&(Ia(this._container),this._setAutoZIndex(Math.min));return this},getContainer:function(){return this._container},setOpacity:function(a){this.options.opacity=a;this._updateOpacity();return this},setZIndex:function(a){this.options.zIndex=a;this._updateZIndex();return this},isLoading:function(){return this._loading},
redraw:function(){this._map&&(this._removeAllTiles(),this._update());return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};this.options.updateWhenIdle||(this._onMove||(this._onMove=k(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove);this._zoomAnimated&&(a.zoomanim=this._animateZoom);return a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;
return a instanceof w?a:new w(a,a)},_updateZIndex:function(){this._container&&(void 0!==this.options.zIndex&&null!==this.options.zIndex)&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var d=this.getPane().children,b=-a(-Infinity,Infinity),c=0,e=d.length,f;c<e;c++)f=d[c].style.zIndex,d[c]!==this._container&&f&&(b=a(b,+f));isFinite(b)&&(this.options.zIndex=b+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ma){Z(this._container,this.options.opacity);
var a=+new Date,d=!1,b=!1,c;for(c in this._tiles){var e=this._tiles[c];if(e.current&&e.loaded){var f=Math.min(1,(a-e.loaded)/200);Z(e.el,f);1>f?d=!0:(e.active?b=!0:this._onOpaqueTile(e),e.active=!0)}}b&&!this._noPrune&&this._pruneTiles();d&&(v(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this))}},_onOpaqueTile:i,_initContainer:function(){this._container||(this._container=J("div","aimap-layer "+(this.options.className||"")),this._updateZIndex(),1>this.options.opacity&&this._updateOpacity(),
this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,d=this.options.maxZoom;if(void 0!==a){for(var b in this._levels)this._levels[b].el.children.length||b===a?(this._levels[b].el.style.zIndex=d-Math.abs(a-b),this._onUpdateLevel(b)):(K(this._levels[b].el),this._removeTilesAtZoom(b),this._onRemoveLevel(b),delete this._levels[b]);b=this._levels[a];var c=this._map;b||(b=this._levels[a]={},b.el=J("div","aimap-tile-container aimap-zoom-animated",this._container),b.el.style.zIndex=
d,b.origin=c.project(c.unproject(c.getPixelOrigin()),a).round(),b.zoom=a,this._setZoomTransform(b,c.getCenter(),c.getZoom()),i(b.el.offsetWidth),this._onCreateLevel(b));return this._level=b}},_onUpdateLevel:i,_onRemoveLevel:i,_onCreateLevel:i,_pruneTiles:function(){if(this._map){var a,d;d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom)this._removeAllTiles();else{for(a in this._tiles)d=this._tiles[a],d.retain=d.current;for(a in this._tiles)d=this._tiles[a],d.current&&!d.active&&
(d=d.coords,this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2));for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}}},_removeTilesAtZoom:function(a){for(var d in this._tiles)this._tiles[d].coords.z===a&&this._removeTile(d)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)K(this._levels[a].el),this._onRemoveLevel(a),delete this._levels[a];this._removeAllTiles();this._tileZoom=void 0},
_retainParent:function(a,d,b,c){var a=Math.floor(a/2),d=Math.floor(d/2),b=b-1,e=new w(+a,+d);e.z=+b;if((e=this._tiles[this._tileCoordsToKey(e)])&&e.active)return e.retain=!0;e&&e.loaded&&(e.retain=!0);return b>c?this._retainParent(a,d,b,c):!1},_retainChildren:function(a,d,b,c){for(var e=2*a;e<2*a+2;e++)for(var f=2*d;f<2*d+2;f++){var j=new w(e,f);j.z=b+1;(j=this._tiles[this._tileCoordsToKey(j)])&&j.active?j.retain=!0:(j&&j.loaded&&(j.retain=!0),b+1<c&&this._retainChildren(e,f,b+1,c))}},_resetView:function(a){a=
a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var d=this.options;return void 0!==d.minNativeZoom&&a<d.minNativeZoom?d.minNativeZoom:void 0!==d.maxNativeZoom&&d.maxNativeZoom<a?d.maxNativeZoom:a},_setView:function(a,d,b,c){var e=this._clampZoom(Math.round(d));if(void 0!==this.options.maxZoom&&e>this.options.maxZoom||void 0!==this.options.minZoom&&e<this.options.minZoom)e=
void 0;var f=this.options.updateWhenZooming&&e!==this._tileZoom;if(!c||f)this._tileZoom=e,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==e&&this._update(a),b||this._pruneTiles(),this._noPrune=!!b;this._setZoomTransforms(a,d)},_setZoomTransforms:function(a,d){for(var b in this._levels)this._setZoomTransform(this._levels[b],a,d)},_setZoomTransform:function(a,d,b){var c=this._map.getZoomScale(b,a.zoom),d=a.origin.multiplyBy(c).subtract(this._map._getNewPixelOrigin(d,
b)).round();$?ya(a.el,d,c):Q(a.el,d)},_resetGrid:function(){var a=this._map,d=a.options.crs,b=this._tileSize=this.getTileSize(),c=this._tileZoom,e=this._map.getPixelWorldBounds(this._tileZoom);e&&(this._globalTileRange=this._pxBoundsToTileRange(e));this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,d.wrapLng[0]],c).x/b.x),Math.ceil(a.project([0,d.wrapLng[1]],c).x/b.y)];this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([d.wrapLat[0],0],c).y/b.x),Math.ceil(a.project([d.wrapLat[1],
0],c).y/b.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(a){var d=this._map,b=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),b=d.getZoomScale(b,this._tileZoom),a=d.project(a,this._tileZoom).floor(),d=d.getSize().divideBy(2*b);return new z(a.subtract(d),a.add(d))},_update:function(a){var d=this._map;if(d){var b=this._clampZoom(d.getZoom());void 0===a&&(a=d.getCenter());if(void 0!==this._tileZoom){var c=this._pxBoundsToTileRange(this._getTiledPixelBounds(a)),
e=c.getCenter(),d=[],f=this.options.keepBuffer,f=new z(c.getBottomLeft().subtract([f,-f]),c.getTopRight().add([f,-f]));if(!isFinite(c.min.x)||!isFinite(c.min.y)||!isFinite(c.max.x)||!isFinite(c.max.y))throw Error("Attempted to load an infinite number of tiles");for(var j in this._tiles){var l=this._tiles[j].coords;if(l.z!==this._tileZoom||!f.contains(new w(l.x,l.y)))this._tiles[j].current=!1}if(1<Math.abs(b-this._tileZoom))this._setView(a,b);else{for(b=c.min.y;b<=c.max.y;b++)for(a=c.min.x;a<=c.max.x;a++)j=
new w(a,b),j.z=this._tileZoom,this._isValidTile(j)&&((f=this._tiles[this._tileCoordsToKey(j)])?f.current=!0:d.push(j));d.sort(function(a,d){return a.distanceTo(e)-d.distanceTo(e)});if(0!==d.length){this._loading||(this._loading=!0,this.fire("loading"));c=document.createDocumentFragment();for(a=0;a<d.length;a++)this._addTile(d[a],c);this._level.el.appendChild(c)}}}}},_isValidTile:function(a){var d=this._map.options.crs;if(!d.infinite){var b=this._globalTileRange;if(!d.wrapLng&&(a.x<b.min.x||a.x>b.max.x)||
!d.wrapLat&&(a.y<b.min.y||a.y>b.max.y))return!1}if(!this.options.bounds)return!0;a=this._tileCoordsToBounds(a);return x(this.options.bounds).overlaps(a)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var d=this._map,b=this.getTileSize(),c=a.scaleBy(b),b=c.add(b),c=d.unproject(c,a.z),a=d.unproject(b,a.z);return[c,a]},_tileCoordsToBounds:function(a){a=this._tileCoordsToNwSe(a);a=new u(a[0],a[1]);this.options.noWrap||(a=this._map.wrapLatLngBounds(a));
return a},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var a=a.split(":"),d=new w(+a[0],+a[1]);d.z=+a[2];return d},_removeTile:function(a){var d=this._tiles[a];d&&(Lc||d.el.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="),K(d.el),delete this._tiles[a],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){H(a,"aimap-tile");var d=this.getTileSize();a.style.width=d.x+"px";a.style.height=d.y+
"px";a.onselectstart=i;a.onmousemove=i;Ma&&1>this.options.opacity&&Z(a,this.options.opacity);Ga&&!$a&&(a.style.WebkitBackfaceVisibility="hidden")},_addTile:function(a,d){var b=this._getTilePos(a),c=this._tileCoordsToKey(a),e=this.createTile(this._wrapCoords(a),g(this._tileReady,this,a));this._initTile(e);2>this.createTile.length&&B(g(this._tileReady,this,a,null,e));Q(e,b);this._tiles[c]={el:e,coords:a,current:!0};d.appendChild(e);this.fire("tileloadstart",{tile:e,coords:a})},_tileReady:function(a,
d,b){if(this._map&&(d&&this.fire("tileerror",{error:d,tile:b,coords:a}),b=this._tiles[this._tileCoordsToKey(a)]))if(b.loaded=+new Date,this._map._fadeAnimated?(Z(b.el,0),v(this._fadeFrame),this._fadeFrame=B(this._updateOpacity,this)):(b.active=!0,this._pruneTiles()),d||(H(b.el,"aimap-tile-loaded"),this.fire("tileload",{tile:b.el,coords:a})),this._noTilesToLoad())this._loading=!1,this.fire("load"),Ma||!this._map._fadeAnimated?B(this._pruneTiles,this):setTimeout(g(this._pruneTiles,this),250)},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},
_wrapCoords:function(a){var d=new w(this._wrapX?e(a.x,this._wrapX):a.x,this._wrapY?e(a.y,this._wrapY):a.y);d.z=a.z;return d},_pxBoundsToTileRange:function(a){var d=this.getTileSize();return new z(a.min.unscaleBy(d).floor(),a.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}}),Ya=qc.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},
initialize:function(a,d){this._url=a;d=j(this,d);d.detectRetina&&(ta&&0<d.maxZoom)&&(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom++):(d.zoomOffset++,d.maxZoom--),d.minZoom=Math.max(0,d.minZoom));"string"===typeof d.subdomains&&(d.subdomains=d.subdomains.split(""));if(!Ga)this.on("tileunload",this._onTileRemove)},setUrl:function(a,d){this._url=a;d||this.redraw();return this},createTile:function(a,d){var b=document.createElement("img");G(b,"load",g(this._tileOnLoad,this,
d,b));G(b,"error",g(this._tileOnError,this,d,b));this.options.crossOrigin&&(b.crossOrigin="");b.alt="";b.setAttribute("role","presentation");b.src=this.getTileUrl(a);return b},getTileUrl:function(a){var d={r:ta?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};this._map&&!this._map.options.crs.infinite&&(a=this._globalTileRange.max.y-a.y,this.options.tms&&(d.y=a),d["-y"]=a);return r(this._url,c(d,this.options))},_tileOnLoad:function(a,d){Ma?setTimeout(g(a,this,null,d),0):a(null,
d)},_tileOnError:function(a,d,b){var c=this.options.errorTileUrl;c&&d.getAttribute("src")!==c&&(d.src=c);a(b,d)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,d=this.options.maxZoom,b=this.options.zoomOffset;this.options.zoomReverse&&(a=d-a);return a+b},_getSubdomain:function(a){return this.options.subdomains[Math.abs(a.x+a.y)%this.options.subdomains.length]},_abortLoading:function(){var a,d;for(a in this._tiles)this._tiles[a].coords.z!==this._tileZoom&&
(d=this._tiles[a].el,d.onload=i,d.onerror=i,d.complete||(d.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",K(d),delete this._tiles[a]))}}),bd=Ya.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,d){this._url=a;var b=c({},this.defaultWmsParams),e;for(e in d)e in this.options||(b[e]=d[e]);d=j(this,d);e=d.detectRetina&&ta?2:1;var f=this.getTileSize();b.width=
f.x*e;b.height=f.y*e;this.wmsParams=b},onAdd:function(a){this._crs=this.options.crs||a.options.crs;this._wmsVersion=parseFloat(this.wmsParams.version);this.wmsParams[1.3<=this._wmsVersion?"crs":"srs"]=this._crs.code;Ya.prototype.onAdd.call(this,a)},getTileUrl:function(a){var d=this._tileCoordsToNwSe(a),b=this._crs,b=D(b.project(d[0]),b.project(d[1])),d=b.min,b=b.max,d=(1.3<=this._wmsVersion&&this._crs===Yc?[d.y,d.x,b.y,b.x]:[d.x,d.y,b.x,b.y]).join(","),a=AIMap.TileLayer.prototype.getTileUrl.call(this,
a);return a+n(this.wmsParams,a,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+d},setParams:function(a,d){c(this.wmsParams,a);d||this.redraw();return this}});Ya.WMS=bd;Hc.wms=function(a,d){return new bd(a,d)};var ka=aa.extend({options:{padding:0.1,tolerance:0},initialize:function(a){j(this,a);b(this);this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&H(this._container,"aimap-zoom-animated"));this.getPane().appendChild(this._container);
this._update();this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this);this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};this._zoomAnimated&&(a.zoomanim=this._onAnimZoom);return a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,d){var b=
this._map.getZoomScale(d,this._zoom),c=za(this._container),e=this._map.getSize().multiplyBy(0.5+this.options.padding),f=this._map.project(this._center,d),f=this._map.project(a,d).subtract(f),c=e.multiplyBy(-b).add(c).add(e).subtract(f);$?ya(this._container,c,b):Q(this._container,c)},_reset:function(){this._update();this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},
_update:function(){var a=this.options.padding,d=this._map.getSize(),b=this._map.containerPointToLayerPoint(d.multiplyBy(-a)).round();this._bounds=new z(b,b.add(d.multiplyBy(1+2*a)).round());this._center=this._map.getCenter();this._zoom=this._map.getZoom()}}),Zb=ka.extend({getEvents:function(){var a=ka.prototype.getEvents.call(this);a.viewprereset=this._onViewPreReset;return a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ka.prototype.onAdd.call(this);this._draw()},_initContainer:function(){var a=
this._container=document.createElement("canvas");G(a,"mousemove",k(this._onMouseMove,32,this),this);G(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this);G(a,"mouseout",this._handleMouseOut,this);this._ctx=a.getContext("2d")},_destroyContainer:function(){delete this._ctx;K(this._container);O(this._container);delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var d in this._layers)a=this._layers[d],a._update();this._redraw()}},
_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={};ka.prototype._update.call(this);var a=this._bounds,d=this._container,b=a.getSize(),c=ta?2:1;Q(d,a.min);d.width=c*b.x;d.height=c*b.y;d.style.width=b.x+"px";d.style.height=b.y+"px";ta&&this._ctx.scale(2,2);this._ctx.translate(-a.min.x,-a.min.y);this.fire("update")}},_reset:function(){ka.prototype._reset.call(this);this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a);
this._layers[b(a)]=a;a=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a);this._drawLast=a;this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var d=a._order,b=d.next,d=d.prev;b?b.prev=d:this._drawLast=d;d?d.next=b:this._drawFirst=b;delete a._order;delete this._layers[AIMap.stamp(a)];this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a);a._project();a._update();this._requestRedraw(a)},
_updateStyle:function(a){this._updateDashArray(a);this._requestRedraw(a)},_updateDashArray:function(a){if(a.options.dashArray){var d=a.options.dashArray.split(","),b=[],c;for(c=0;c<d.length;c++)b.push(Number(d[c]));a.options._dashArray=b}},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||B(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var d=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new z;this._redrawBounds.extend(a._pxBounds.min.subtract([d,
d]));this._redrawBounds.extend(a._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null;this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil());this._clear();this._draw();this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var d=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,d.x,d.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var a,d=this._redrawBounds;this._ctx.save();d&&(a=d.getSize(),
this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,a.x,a.y),this._ctx.clip());this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)a=b.layer,(!d||a._pxBounds&&a._pxBounds.intersects(d))&&a._updatePath();this._drawing=!1;this._ctx.restore()},_updatePoly:function(a,d){if(this._drawing){var b,c,e,f,j=a._parts,l=j.length,n=this._ctx;if(l){this._drawnLayers[a._aimap_id]=a;n.beginPath();for(b=0;b<l;b++){c=0;for(e=j[b].length;c<e;c++)f=j[b][c],n[c?"lineTo":"moveTo"](f.x,f.y);d&&n.closePath()}this._fillStroke(n,
a)}}},_updateCircle:function(a){if(this._drawing&&!a._empty()){var d=a._point,b=this._ctx,c=Math.max(Math.round(a._radius),1),e=(Math.max(Math.round(a._radiusY),1)||c)/c;this._drawnLayers[a._aimap_id]=a;1!==e&&(b.save(),b.scale(1,e));b.beginPath();b.arc(d.x,d.y/e,c,0,2*Math.PI,!1);1!==e&&b.restore();this._fillStroke(b,a)}},_fillStroke:function(a,d){var b=d.options;b.fill&&(a.globalAlpha=b.fillOpacity,a.fillStyle=b.fillColor||b.color,a.fill(b.fillRule||"evenodd"));b.stroke&&0!==b.weight&&(a.setLineDash&&
a.setLineDash(d.options&&d.options._dashArray||[]),a.globalAlpha=b.opacity,a.lineWidth=b.weight,a.strokeStyle=b.color,a.lineCap=b.lineCap,a.lineJoin=b.lineJoin,a.stroke())},_onClick:function(a){for(var d=this._map.mouseEventToLayerPoint(a),b,c,e=this._drawFirst;e;e=e.next)b=e.layer,b.options.interactive&&(b._containsPoint(d)&&!this._map._draggableMoved(b))&&(c=b);c&&(Jb(a),this._fireEvent([c],a))},_onMouseMove:function(a){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var d=
this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,d)}},_handleMouseOut:function(a){var d=this._hoveredLayer;d&&(M(this._container,"aimap-interactive"),this._fireEvent([d],a,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(a,d){for(var b,c,e=this._drawFirst;e;e=e.next)b=e.layer,b.options.interactive&&b._containsPoint(d)&&(c=b);c!==this._hoveredLayer&&(this._handleMouseOut(a),c&&(H(this._container,"aimap-interactive"),this._fireEvent([c],a,"mouseover"),this._hoveredLayer=
c));this._hoveredLayer&&this._fireEvent([this._hoveredLayer],a)},_fireEvent:function(a,d,b){this._map._fireDOMEvent(d,b||d.type,a)},_bringToFront:function(a){var d=a._order,b=d.next,c=d.prev;b&&((b.prev=c)?c.next=b:b&&(this._drawFirst=b),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(a))},_bringToBack:function(a){var d=a._order,b=d.next,c=d.prev;c&&((c.next=b)?b.prev=c:c&&(this._drawLast=c),d.prev=null,d.next=this._drawFirst,this._drawFirst=this._drawFirst.prev=
d,this._requestRedraw(a))}}),gb=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch(a){return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),Cd={_initContainer:function(){this._container=J("div","aimap-vml-container")},_update:function(){this._map._animatingZoom||(ka.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var d=
a._container=gb("shape");H(d,"aimap-vml-shape "+(this.options.className||""));d.coordsize="1 1";a._path=gb("path");d.appendChild(a._path);this._updateStyle(a);this._layers[b(a)]=a},_addPath:function(a){var d=a._container;this._container.appendChild(d);a.options.interactive&&a.addInteractiveTarget(d)},_removePath:function(a){var d=a._container;K(d);a.removeInteractiveTarget(d);delete this._layers[b(a)]},_updateStyle:function(a){var d=a._stroke,b=a._fill,c=a.options,e=a._container;e.stroked=!!c.stroke;
e.filled=!!c.fill;c.stroke?(d||(d=a._stroke=gb("stroke")),e.appendChild(d),d.weight=c.weight+"px",d.color=c.color,d.opacity=c.opacity,d.dashStyle=c.dashArray?fa(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):"",d.endcap=c.lineCap.replace("butt","flat"),d.joinstyle=c.lineJoin):d&&(e.removeChild(d),a._stroke=null);c.fill?(b||(b=a._fill=gb("fill")),e.appendChild(b),b.color=c.fillColor||c.color,b.opacity=c.fillOpacity):b&&(e.removeChild(b),a._fill=null)},_updateCircle:function(a){var d=
a._point.round(),b=Math.round(a._radius),c=Math.round(a._radiusY||b);this._setPath(a,a._empty()?"M0 0":"AL "+d.x+","+d.y+" "+b+","+c+" 0,23592600")},_setPath:function(a,d){a._path.v=d},_bringToFront:function(a){Ha(a._container)},_bringToBack:function(a){Ia(a._container)}},yb=vb?gb:S,La=ka.extend({getEvents:function(){var a=ka.prototype.getEvents.call(this);a.zoomstart=this._onZoomStart;return a},_initContainer:function(){this._container=yb("svg");this._container.setAttribute("pointer-events","none");
this._rootGroup=yb("g");this._container.appendChild(this._rootGroup)},_destroyContainer:function(){K(this._container);O(this._container);delete this._container;delete this._rootGroup;delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){ka.prototype._update.call(this);var a=this._bounds,d=a.getSize(),b=this._container;if(!this._svgSize||!this._svgSize.equals(d))this._svgSize=d,b.setAttribute("width",d.x),b.setAttribute("height",
d.y);Q(b,a.min);b.setAttribute("viewBox",[a.min.x,a.min.y,d.x,d.y].join(" "));this.fire("update")}},_initPath:function(a){var d=a._path=yb("path");a.options.className&&H(d,a.options.className);a.options.interactive&&H(d,"aimap-interactive");this._updateStyle(a);this._layers[b(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer();this._rootGroup.appendChild(a._path);a.addInteractiveTarget(a._path)},_removePath:function(a){K(a._path);a.removeInteractiveTarget(a._path);delete this._layers[b(a)]},
_updatePath:function(a){a._project();a._update()},_updateStyle:function(a){var d=a._path,a=a.options;d&&((a.stroke?(d.setAttribute("stroke",a.color),d.setAttribute("stroke-opacity",a.opacity),d.setAttribute("stroke-width",a.weight),d.setAttribute("stroke-linecap",a.lineCap),d.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?d.setAttribute("stroke-dasharray",a.dashArray):d.removeAttribute("stroke-dasharray"),a.dashOffset?d.setAttribute("stroke-dashoffset",a.dashOffset):d.removeAttribute("stroke-dashoffset")):
d.setAttribute("stroke","none"),a.fill)?(d.setAttribute("fill",a.fillColor||a.color),d.setAttribute("fill-opacity",a.fillOpacity),d.setAttribute("fill-rule",a.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(a,d){this._setPath(a,V(a._parts,d))},_updateCircle:function(a){var d=a._point,b=Math.max(Math.round(a._radius),1),c=Math.max(Math.round(a._radiusY),1)||b,c="a"+b+","+c+" 0 1,0 ",d=a._empty()?"M0 0":"M"+(d.x-b)+","+d.y+c+2*b+",0 "+c+2*-b+",0 ";this._setPath(a,d)},_setPath:function(a,
d){a._path.setAttribute("d",d)},_bringToFront:function(a){Ha(a._path)},_bringToBack:function(a){Ia(a._path)}});vb&&La.include(Cd);I.include({getRenderer:function(a){a=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;a||(a=this._renderer=this.options.preferCanvas&&Yb()||$b());this.hasLayer(a)||this.addLayer(a);return a},_getPaneRenderer:function(a){if("overlayPane"===a||void 0===a)return!1;var d=this._paneRenderers[a];void 0===d&&(d=La&&$b({pane:a})||
Zb&&Yb({pane:a}),this._paneRenderers[a]=d);return d}});var cd=Ja.extend({initialize:function(a,d){Ja.prototype.initialize.call(this,this._boundsToLatLngs(a),d)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){a=x(a);return[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});La.create=yb;La.pointsToPath=V;na.geometryToLayer=Vb;na.coordsToLatLng=Wb;na.coordsToLatLngs=sb;na.latLngToCoords=Xb;na.latLngsToCoords=tb;na.getFeature=
Ka;na.asFeature=ub;I.mergeOptions({boxZoom:!0});var dd=ja.extend({initialize:function(a){this._map=a;this._container=a._container;this._pane=a._panes.overlayPane;this._resetStateTimeout=0;a.on("unload",this._destroy,this)},addHooks:function(){G(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){O(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){K(this._pane);delete this._pane},_resetState:function(){this._resetStateTimeout=
0;this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||1!==a.which&&1!==a.button)return!1;this._clearDeferredResetState();this._resetState();bb();Qb();this._startPoint=this._map.mouseEventToContainerPoint(a);G(document,{contextmenu:ia,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=
!0,this._box=J("div","aimap-zoom-box",this._container),H(this._container,"aimap-crosshair"),this._map.fire("boxzoomstart"));this._point=this._map.mouseEventToContainerPoint(a);var a=new z(this._point,this._startPoint),d=a.getSize();Q(this._box,a.min);this._box.style.width=d.x+"px";this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(K(this._box),M(this._container,"aimap-crosshair"));cb();Rb();O(document,{contextmenu:ia,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},
this)},_onMouseUp:function(a){1!==a.which&&1!==a.button||(this._finish(),this._moved&&(this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(g(this._resetState,this),0),a=new u(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point)),this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})))},_onKeyDown:function(a){27===a.keyCode&&this._finish()}});I.addInitHook("addHandler","boxZoom",dd);I.mergeOptions({doubleClickZoom:!0});var ed=ja.extend({addHooks:function(){this._map.on("dblclick",
this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var d=this._map,b=d.getZoom(),c=d.options.zoomDelta,b=a.originalEvent.shiftKey?b-c:b+c;b>d.getMaxZoom()?d.getMaxZoom():"center"===d.options.doubleClickZoom?d.setZoom(b):d.setZoomAround(a.containerPoint,b)}});I.addInitHook("addHandler","doubleClickZoom",ed);I.mergeOptions({dragging:!0,inertia:!$a,inertiaDeceleration:3400,inertiaMaxSpeed:Infinity,easeLinearity:0.2,worldCopyJump:!1,
maxBoundsViscosity:0});var fd=ja.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Ca(a._mapPane,a._container);this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this);this._draggable.on("predrag",this._onPreDragLimit,this);a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}H(this._map._container,"aimap-grab aimap-touch-drag");
this._draggable.enable();this._positions=[];this._times=[]},removeHooks:function(){M(this._map._container,"aimap-grab");M(this._map._container,"aimap-touch-drag");this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;a._stop();if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=x(this._map.options.maxBounds);this._offsetLimit=D(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),
this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize()));this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart");a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var d=this._lastTime=+new Date;this._positions.push(this._lastPos=this._draggable._absPos||this._draggable._newPos);this._times.push(d);this._prunePositions(d)}this._map.fire("move",
a).fire("drag",a)},_prunePositions:function(a){for(;1<this._positions.length&&50<a-this._times[0];)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2);this._initialWorldOffset=this._map.latLngToLayerPoint([0,0]).subtract(a).x;this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,d){return a-(a-d)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var a=this._draggable._newPos.subtract(this._draggable._startPos),
d=this._offsetLimit;a.x<d.min.x&&(a.x=this._viscousLimit(a.x,d.min.x));a.y<d.min.y&&(a.y=this._viscousLimit(a.y,d.min.y));a.x>d.max.x&&(a.x=this._viscousLimit(a.x,d.max.x));a.y>d.max.y&&(a.y=this._viscousLimit(a.y,d.max.y));this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,d=Math.round(a/2),b=this._initialWorldOffset,c=this._draggable._newPos.x,e=(c-d+b)%a+d-b,a=(c+d+b)%a-d-b,b=Math.abs(e+b)<Math.abs(a+b)?e:a;this._draggable._absPos=this._draggable._newPos.clone();
this._draggable._newPos.x=b},_onDragEnd:function(a){var d=this._map,b=d.options,c=!b.inertia||2>this._times.length;d.fire("dragend",a);if(c)d.fire("moveend");else{this._prunePositions(+new Date);var a=this._lastPos.subtract(this._positions[0]),e=b.easeLinearity,c=a.multiplyBy(e/((this._lastTime-this._times[0])/1E3)),f=c.distanceTo([0,0]),a=Math.min(b.inertiaMaxSpeed,f),c=c.multiplyBy(a/f),j=a/(b.inertiaDeceleration*e),l=c.multiplyBy(-j/2).round();!l.x&&!l.y?d.fire("moveend"):(l=d._limitOffset(l,d.options.maxBounds),
B(function(){d.panBy(l,{duration:j,easeLinearity:e,noMoveStart:!0,animate:!0})}))}}});I.addInitHook("addHandler","dragging",fd);I.mergeOptions({keyboard:!0,keyboardPanDelta:80});var gd=ja.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a;this._setPanDelta(a.options.keyboardPanDelta);this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;0>=a.tabIndex&&(a.tabIndex="0");G(a,{focus:this._onFocus,
blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks();O(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this);this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,d=document.documentElement,b=a.scrollTop||d.scrollTop,a=a.scrollLeft||d.scrollLeft;this._map._container.focus();
window.scrollTo(a,b)}},_onFocus:function(){this._focused=!0;this._map.fire("focus")},_onBlur:function(){this._focused=!1;this._map.fire("blur")},_setPanDelta:function(a){var d=this._panKeys={},b=this.keyCodes,c,e;c=0;for(e=b.left.length;c<e;c++)d[b.left[c]]=[-1*a,0];c=0;for(e=b.right.length;c<e;c++)d[b.right[c]]=[a,0];c=0;for(e=b.down.length;c<e;c++)d[b.down[c]]=[0,a];c=0;for(e=b.up.length;c<e;c++)d[b.up[c]]=[0,-1*a]},_setZoomDelta:function(a){var d=this._zoomKeys={},b=this.keyCodes,c,e;c=0;for(e=
b.zoomIn.length;c<e;c++)d[b.zoomIn[c]]=a;c=0;for(e=b.zoomOut.length;c<e;c++)d[b.zoomOut[c]]=-a},_addHooks:function(){G(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){O(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!a.altKey&&!a.ctrlKey&&!a.metaKey){var d=a.keyCode,b=this._map;if(d in this._panKeys){if(b._panAnim&&b._panAnim._inProgress)return;d=this._panKeys[d];a.shiftKey&&(d=y(d).multiplyBy(3));b.panBy(d);b.options.maxBounds&&b.panInsideBounds(b.options.maxBounds)}else if(d in
this._zoomKeys)b.setZoom(b.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[d]);else if(27===d&&b._popup&&b._popup.options.closeOnEscapeKey)b.closePopup();else return;ia(a)}}});I.addInitHook("addHandler","keyboard",gd);I.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var hd=ja.extend({addHooks:function(){G(this._map._container,"mousewheel",this._onWheelScroll,this);this._delta=0},removeHooks:function(){O(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var d=
this._map.options.wheelDebounceTime;this._delta+=yc(a);this._lastMousePos=this._map.mouseEventToContainerPoint(a);this._startTime||(this._startTime=+new Date);d=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer);this._timer=setTimeout(g(this._performZoom,this),d);ia(a)},_performZoom:function(){var a=this._map,d=a.getZoom(),b=this._map.options.zoomSnap||0;a._stop();var c=4*Math.log(2/(1+Math.exp(-Math.abs(this._delta/(4*this._map.options.wheelPxPerZoomLevel)))))/Math.LN2,b=b?Math.ceil(c/
b)*b:c,b=a._limitZoom(d+(0<this._delta?b:-b))-d;this._delta=0;this._startTime=null;b&&("center"===a.options.scrollWheelZoom?a.setZoom(d+b):a.setZoomAround(this._lastMousePos,d+b))}});I.addInitHook("addHandler","scrollWheelZoom",hd);I.mergeOptions({tap:!0,tapTolerance:15});var id=ja.extend({addHooks:function(){G(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){O(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(a.touches)if(Y(a),this._fireClick=
!0,1<a.touches.length)this._fireClick=!1,clearTimeout(this._holdTimeout);else{var d=a.touches[0],a=d.target;this._startPos=this._newPos=new w(d.clientX,d.clientY);a.tagName&&"a"===a.tagName.toLowerCase()&&H(a,"aimap-active");this._holdTimeout=setTimeout(g(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",d))},this),1E3);this._simulateEvent("mousedown",d);G(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(a){clearTimeout(this._holdTimeout);
O(document,{touchmove:this._onMove,touchend:this._onUp},this);if(this._fireClick&&a&&a.changedTouches){var a=a.changedTouches[0],d=a.target;d&&(d.tagName&&"a"===d.tagName.toLowerCase())&&M(d,"aimap-active");this._simulateEvent("mouseup",a);this._isTapValid()&&this._simulateEvent("click",a)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(a){a=a.touches[0];this._newPos=new w(a.clientX,a.clientY);this._simulateEvent("mousemove",
a)},_simulateEvent:function(a,d){var b=document.createEvent("MouseEvents");b._simulated=!0;d.target._simulatedClick=!0;b.initMouseEvent(a,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);d.target.dispatchEvent(b)}});ha&&!ca&&I.addInitHook("addHandler","tap",id);I.mergeOptions({touchZoom:ha&&!$a,bounceAtZoomLimits:!0});var jd=ja.extend({addHooks:function(){H(this._map._container,"aimap-touch-zoom");G(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){M(this._map._container,
"aimap-touch-zoom");O(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var d=this._map;if(a.touches&&!(2!==a.touches.length||d._animatingZoom||this._zooming)){var b=d.mouseEventToContainerPoint(a.touches[0]),c=d.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=d.getSize()._divideBy(2);this._startLatLng=d.containerPointToLatLng(this._centerPoint);"center"!==d.options.touchZoom&&(this._pinchStartLatLng=d.containerPointToLatLng(b.add(c)._divideBy(2)));this._startDist=
b.distanceTo(c);this._startZoom=d.getZoom();this._moved=!1;this._zooming=!0;d._stop();G(document,"touchmove",this._onTouchMove,this);G(document,"touchend",this._onTouchEnd,this);Y(a)}},_onTouchMove:function(a){if(a.touches&&2===a.touches.length&&this._zooming){var d=this._map,b=d.mouseEventToContainerPoint(a.touches[0]),c=d.mouseEventToContainerPoint(a.touches[1]),e=b.distanceTo(c)/this._startDist;this._curZoom=this._zoom;this._zoom=d.getScaleZoom(e,this._startZoom);if(!d.options.bounceAtZoomLimits&&
(this._zoom<d.getMinZoom()&&1>e||this._zoom>d.getMaxZoom()&&1<e))this._zoom=d._limitZoom(this._zoom);if(Infinity==this._zoom)this._zoom=this._curZoom;else{if("center"===d.options.touchZoom){if(this._center=this._startLatLng,1===e)return}else{b=b._add(c)._divideBy(2)._subtract(this._centerPoint);if(1===e&&0===b.x&&0===b.y)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(b),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0);v(this._animRequest);d=g(d._move,
d,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=B(d,this,!0);Y(a)}}},_onTouchEnd:function(){!this._moved||!this._zooming?this._zooming=!1:(this._zooming=!1,v(this._animRequest),O(document,"touchmove",this._onTouchMove),O(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))}});I.addInitHook("addHandler",
"touchZoom",jd);I.BoxZoom=dd;I.DoubleClickZoom=ed;I.Drag=fd;I.Keyboard=gd;I.ScrollWheelZoom=hd;I.Tap=id;I.TouchZoom=jd;var Dd=window.AIMap;window.AIMap=f;Object.freeze=Jc;f.version="1.3.1+HEAD.ba6f97f";f.noConflict=function(){window.AIMap=Dd;return this};f.Control=ea;f.control=eb;f.Browser=td;f.Evented=Za;f.Mixin=wd;f.Util=nd;f.Class=C;f.Handler=ja;f.extend=c;f.bind=g;f.stamp=b;f.setOptions=j;f.DomEvent=ud;f.DomUtil=vd;f.PosAnimation=Tc;f.Draggable=Ca;f.LineUtil=xd;f.PolyUtil=yd;f.Point=w;f.point=
y;f.Bounds=z;f.bounds=D;f.Transformation=W;f.transformation=N;f.Projection=zd;f.LatLng=A;f.latLng=F;f.LatLngBounds=u;f.latLngBounds=x;f.CRS=oa;f.GeoJSON=na;f.geoJSON=Gc;f.geoJson=Gc;f.Layer=aa;f.LayerGroup=Oa;f.layerGroup=function(a,d){return new Oa(a,d)};f.FeatureGroup=Ba;f.featureGroup=function(a){return new Ba(a)};f.ImageOverlay=pc;f.imageOverlay=function(a,d,b){return new pc(a,d,b)};f.VideoOverlay=$c;f.videoOverlay=function(a,d,b){return new $c(a,d,b)};f.DivOverlay=pa;f.Popup=Qa;f.popup=function(a,
d){return new Qa(a,d)};f.Tooltip=Ra;f.tooltip=function(a,d){return new Ra(a,d)};f.Icon=Pa;f.icon=function(a){return new Pa(a)};f.DivIcon=ad;f.divIcon=function(a){return new ad(a)};f.Marker=Xa;f.marker=function(a,d){return new Xa(a,d)};f.TileLayer=Ya;f.tileLayer=Hc;f.GridLayer=qc;f.gridLayer=function(a){return new qc(a)};f.SVG=La;f.svg=$b;f.Renderer=ka;f.Canvas=Zb;f.canvas=Yb;f.Path=ua;f.CircleMarker=xb;f.circleMarker=function(a,d){return new xb(a,d)};f.Circle=nc;f.circle=function(a,d,b){return new nc(a,
d,b)};f.Polyline=ma;f.polyline=function(a,d){return new ma(a,d)};f.Polygon=Ja;f.polygon=function(a,d){return new Ja(a,d)};f.Rectangle=cd;f.rectangle=function(a,d){return new cd(a,d)};f.Map=I;f.map=function(a,d){return new I(a,d)}});!function(f){if("object"==typeof exports)module.exports=f();else if("function"==typeof define&&define.amd)define(f);else{var c;"undefined"!=typeof window?c=window:"undefined"!=typeof global?c=global:"undefined"!=typeof self&&(c=self);c.proj4=f()}}(function(){return function c(g,b,k){function e(m,l){if(!b[m]){if(!g[m]){var j="function"==typeof require&&require;if(!l&&j)return j(m,!0);if(i)return i(m,!0);throw Error("Cannot find module '"+m+"'");}j=b[m]={exports:{}};g[m][0].call(j.exports,function(b){var c=
g[m][1][b];return e(c?c:b)},j,j.exports,c,g,b,k)}return b[m].exports}for(var i="function"==typeof require&&require,m=0;m<k.length;m++)e(k[m]);return e}({1:[function(c,g){function b(c,i,m){if(!(this instanceof b))return new b(c,i,m);Array.isArray(c)?(this.x=c[0],this.y=c[1],this.z=c[2]||0):"object"==typeof c?(this.x=c.x,this.y=c.y,this.z=c.z||0):"string"==typeof c&&"undefined"==typeof i?(c=c.split(","),this.x=parseFloat(c[0],10),this.y=parseFloat(c[1],10),this.z=parseFloat(c[2],10)||0):(this.x=c,this.y=
i,this.z=m||0);console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var k=c("mgrs");b.fromMGRS=function(c){return new b(k.toPoint(c))};b.prototype.toMGRS=function(b){return k.forward([this.x,this.y],b)};g.exports=b},{mgrs:67}],2:[function(c,g){function b(c,l){if(!(this instanceof b))return new b(c);var l=l||function(b){if(b)throw b;},j=k(c);if("object"!=typeof j)return void l(c);var j=m(j),n=b.projections.get(j.projName);n?(e(this,j),e(this,n),this.init(),l(null,this)):l(c)}
var k=c("./parseCode"),e=c("./extend"),i=c("./projections"),m=c("./deriveConstants");b.projections=i;b.projections.start();g.exports=b},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(c,g){g.exports=function(b,c,e){var i,m,o,l=e.x,j=e.y,n=e.z||0;for(o=0;3>o;o++)if(!c||2!==o||void 0!==e.z)switch(0===o?(i=l,m="x"):1===o?(i=j,m="y"):(i=n,m="z"),b.axis[o]){case "e":e[m]=i;break;case "w":e[m]=-i;break;case "n":e[m]=i;break;case "s":e[m]=-i;break;case "u":void 0!==
e[m]&&(e.z=i);break;case "d":void 0!==e[m]&&(e.z=-i);break;default:return null}return e}},{}],4:[function(c,g){var b=Math.PI/2,k=c("./sign");g.exports=function(c){return Math.abs(c)<b?c:c-k(c)*Math.PI}},{"./sign":21}],5:[function(c,g){var b=2*Math.PI,k=c("./sign");g.exports=function(c){return 3.14159265359>=Math.abs(c)?c:c-k(c)*b}},{"./sign":21}],6:[function(c,g){g.exports=function(b){return 1<Math.abs(b)&&(b=1<b?1:-1),Math.asin(b)}},{}],7:[function(c,g){g.exports=function(b){return 1-0.25*b*(1+b/
16*(3+1.25*b))}},{}],8:[function(c,g){g.exports=function(b){return 0.375*b*(1+0.25*b*(1+0.46875*b))}},{}],9:[function(c,g){g.exports=function(b){return 0.05859375*b*b*(1+0.75*b)}},{}],10:[function(c,g){g.exports=function(b){return b*b*b*(35/3072)}},{}],11:[function(c,g){g.exports=function(b,c,e){c*=e;return b/Math.sqrt(1-c*c)}},{}],12:[function(c,g){g.exports=function(b,c,e,i,m){var o,l;o=b/c;for(var j=0;15>j;j++)if(l=(b-(c*o-e*Math.sin(2*o)+i*Math.sin(4*o)-m*Math.sin(6*o)))/(c-2*e*Math.cos(2*o)+
4*i*Math.cos(4*o)-6*m*Math.cos(6*o)),o+=l,1.0E-10>=Math.abs(l))return o;return NaN}},{}],13:[function(c,g){var b=Math.PI/2;g.exports=function(c,e){var i=1-(1-c*c)/(2*c)*Math.log((1-c)/(1+c));if(1.0E-6>Math.abs(Math.abs(e)-i))return 0>e?-1*b:b;for(var m,o,l,j,i=Math.asin(0.5*e),n=0;30>n;n++)if(o=Math.sin(i),l=Math.cos(i),j=c*o,m=Math.pow(1-j*j,2)/(2*l)*(e/(1-c*c)-o/(1-j*j)+0.5/c*Math.log((1-j)/(1+j))),i+=m,1.0E-10>=Math.abs(m))return i;return NaN}},{}],14:[function(c,g){g.exports=function(b,c,e,i,
m){return b*m-c*Math.sin(2*m)+e*Math.sin(4*m)-i*Math.sin(6*m)}},{}],15:[function(c,g){g.exports=function(b,c,e){b*=c;return e/Math.sqrt(1-b*b)}},{}],16:[function(c,g){var b=Math.PI/2;g.exports=function(c,e){for(var i,m,o=0.5*c,l=b-2*Math.atan(e),j=0;15>=j;j++)if(i=c*Math.sin(l),m=b-2*Math.atan(e*Math.pow((1-i)/(1+i),o))-l,l+=m,1.0E-10>=Math.abs(m))return l;return-9999}},{}],17:[function(c,g){g.exports=function(b){var c=[];c[0]=1-b*(0.25+b*(0.046875+b*(0.01953125+0.01068115234375*b)));c[1]=b*(0.75-
b*(0.046875+b*(0.01953125+0.01068115234375*b)));var e=b*b;return c[2]=e*(0.46875-b*(0.013020833333333334+0.007120768229166667*b)),e*=b,c[3]=e*(0.3645833333333333-0.005696614583333333*b),c[4]=0.3076171875*e*b,c}},{}],18:[function(c,g){var b=c("./pj_mlfn");g.exports=function(c,e,i){for(var m=1/(1-e),o=c,l=20;l;--l){var j=Math.sin(o),n=1-e*j*j;if(n=(b(o,j,Math.cos(o),i)-c)*(n*Math.sqrt(n))*m,o-=n,1.0E-10>Math.abs(n))break}return o}},{"./pj_mlfn":19}],19:[function(c,g){g.exports=function(b,c,e,i){return e*=
c,c*=c,i[0]*b-e*(i[1]+c*(i[2]+c*(i[3]+c*i[4])))}},{}],20:[function(c,g){g.exports=function(b,c){var e;return 1.0E-7<b?(e=b*c,(1-b*b)*(c/(1-e*e)-0.5/b*Math.log((1-e)/(1+e)))):2*c}},{}],21:[function(c,g){g.exports=function(b){return 0>b?-1:1}},{}],22:[function(c,g){g.exports=function(b,c){return Math.pow((1-b)/(1+b),c)}},{}],23:[function(c,g){g.exports=function(b){var c={x:b[0],y:b[1]};return 2<b.length&&(c.z=b[2]),3<b.length&&(c.m=b[3]),c}},{}],24:[function(c,g){var b=Math.PI/2;g.exports=function(c,
e,i){i*=c;return i=Math.pow((1-i)/(1+i),0.5*c),Math.tan(0.5*(b-e))/i}},{}],25:[function(c,g,b){b.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"};b.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"};b.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"};b.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"};b.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"};
b.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"};b.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"};b.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"};b.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"};b.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"};b.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",
ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"};b.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"};b.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"};b.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"};b.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"};b.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",
datumName:"Reseau National Belge 1972"}},{}],26:[function(c,g,b){b.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"};b.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"};b.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"};b.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"};b.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"};b.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"};b.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"};
b.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"};b.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"};b.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"};b.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"};b.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"};b.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"};b.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"};b.clrk80=
{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."};b.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"};b.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"};b.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"};b.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"};b.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"};b.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"};b.evrst56={a:6377301.243,rf:300.8017,
ellipseName:"Everest 1956"};b.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"};b.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"};b.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"};b.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"};b.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"};b.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"};b.hough={a:6378270,rf:297,ellipseName:"Hough"};b.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"};
b.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"};b.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"};b.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"};b.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"};b.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"};b.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"};b.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"};b.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"};b.WGS60=
{a:6378165,rf:298.3,ellipseName:"WGS 60"};b.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"};b.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};b.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};b.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(c,g,b){b.greenwich=0;b.lisbon=-9.131906111111;b.paris=2.337229166667;b.bogota=-74.080916666667;b.madrid=-3.687938888889;b.rome=12.452333333333;b.bern=7.439583333333;b.jakarta=106.807719444444;b.ferro=-17.666666666667;
b.brussels=4.367975;b.stockholm=18.058277777778;b.athens=23.7163375;b.oslo=10.722916666667},{}],28:[function(c,g,b){b.ft={to_meter:0.3048};b["us-ft"]={to_meter:1200/3937}},{}],29:[function(c,g){function b(b,c,e){var n;return Array.isArray(e)?(n=i(b,c,e),3===e.length?[n.x,n.y,n.z]:[n.x,n.y]):i(b,c,e)}function k(b){return b instanceof e?b:b.oProj?b.oProj:e(b)}var e=c("./Proj"),i=c("./transform"),m=e("WGS84");g.exports=function(c,e,j){var c=k(c),n,i=!1;return"undefined"==typeof e?(e=c,c=m,i=!0):("undefined"!=
typeof e.x||Array.isArray(e))&&(j=e,e=c,c=m,i=!0),e=k(e),j?b(c,e,j):(n={forward:function(j){return b(c,e,j)},inverse:function(j){return b(e,c,j)}},i&&(n.oProj=e),n)}},{"./Proj":2,"./transform":65}],30:[function(c,g){var b=Math.PI/2,k=function(b){return this instanceof k?(this.datum_type=4,void(b&&(b.datumCode&&"none"===b.datumCode&&(this.datum_type=5),b.datum_params&&(this.datum_params=b.datum_params.map(parseFloat),(0!==this.datum_params[0]||0!==this.datum_params[1]||0!==this.datum_params[2])&&(this.datum_type=
1),3<this.datum_params.length&&(0!==this.datum_params[3]||0!==this.datum_params[4]||0!==this.datum_params[5]||0!==this.datum_params[6])&&(this.datum_type=2,this.datum_params[3]*=4.84813681109536E-6,this.datum_params[4]*=4.84813681109536E-6,this.datum_params[5]*=4.84813681109536E-6,this.datum_params[6]=this.datum_params[6]/1E6+1)),this.datum_type=b.grids?3:this.datum_type,this.a=b.a,this.b=b.b,this.es=b.es,this.ep2=b.ep2,3===this.datum_type&&(this.grids=b.grids)))):new k(b)};k.prototype={compare_datums:function(b){return this.datum_type!==
b.datum_type?!1:this.a!==b.a||5.0E-11<Math.abs(this.es-b.es)?!1:1===this.datum_type?this.datum_params[0]===b.datum_params[0]&&this.datum_params[1]===b.datum_params[1]&&this.datum_params[2]===b.datum_params[2]:2===this.datum_type?this.datum_params[0]===b.datum_params[0]&&this.datum_params[1]===b.datum_params[1]&&this.datum_params[2]===b.datum_params[2]&&this.datum_params[3]===b.datum_params[3]&&this.datum_params[4]===b.datum_params[4]&&this.datum_params[5]===b.datum_params[5]&&this.datum_params[6]===
b.datum_params[6]:3===this.datum_type||3===b.datum_type?this.nadgrids===b.nadgrids:!0},geodetic_to_geocentric:function(c){var i,m,o,l,j,n,g,k=c.x,p=c.y,t=c.z?c.z:0;if(-b>p&&p>-1.001*b)p=-b;else if(p>b&&1.001*b>p)p=b;else if(-b>p||p>b)return null;return k>Math.PI&&(k-=2*Math.PI),j=Math.sin(p),g=Math.cos(p),n=j*j,l=this.a/Math.sqrt(1-this.es*n),i=(l+t)*g*Math.cos(k),m=(l+t)*g*Math.sin(k),o=(l*(1-this.es)+t)*j,c.x=i,c.y=m,c.z=o,0},geocentric_to_geodetic:function(b){var c,m,o,l,j,n,g,k,p,t,B,v;o=b.x;
t=b.y;var C=b.z?b.z:0;if(c=Math.sqrt(o*o+t*t),m=Math.sqrt(o*o+t*t+C*C),1.0E-12>c/this.a){if(t=0,1.0E-12>m/this.a)return}else t=Math.atan2(t,o);o=C/m;m=c/m;l=1/Math.sqrt(1-this.es*(2-this.es)*m*m);n=m*(1-this.es)*l;g=o*l;p=0;do p++,j=this.a/Math.sqrt(1-this.es*g*g),v=c*n+C*g-j*(1-this.es*g*g),j=this.es*j/(j+v),l=1/Math.sqrt(1-j*(2-j)*m*m),j=m*(1-j)*l,l*=o,k=l*n-j*g,n=j,g=l;while(1.0E-24<k*k&&30>p);return B=Math.atan(l/Math.abs(j)),b.x=t,b.y=B,b.z=v,b},geocentric_to_geodetic_noniter:function(c){var i,
m,o,l,j,n,g,k,p,t,B,v,C,E,w,y,z,D=c.x,u=c.y,x=c.z?c.z:0;if(D=parseFloat(D),u=parseFloat(u),x=parseFloat(x),z=!1,0!==D)i=Math.atan2(u,D);else if(0<u)i=b;else if(0>u)i=-b;else if(z=!0,i=0,0<x)m=b;else{if(!(0>x))return;m=-b}return j=D*D+u*u,l=Math.sqrt(j),n=1.0026*x,k=Math.sqrt(n*n+j),t=n/k,v=l/k,B=t*t*t,g=x+this.b*this.ep2*B,y=l-this.a*this.es*v*v*v,p=Math.sqrt(g*g+y*y),C=g/p,E=y/p,w=this.a/Math.sqrt(1-this.es*C*C),o=0.3826834323650898<=E?l/E-w:-0.3826834323650898>=E?l/-E-w:x/C+w*(this.es-1),!1===z&&
(m=Math.atan(C/E)),c.x=i,c.y=m,c.z=o,c},geocentric_to_wgs84:function(b){if(1===this.datum_type)b.x+=this.datum_params[0],b.y+=this.datum_params[1],b.z+=this.datum_params[2];else if(2===this.datum_type){var c=this.datum_params[3],m=this.datum_params[4],g=this.datum_params[5],l=this.datum_params[6],j=l*(g*b.x+b.y-c*b.z)+this.datum_params[1],c=l*(-m*b.x+c*b.y+b.z)+this.datum_params[2];b.x=l*(b.x-g*b.y+m*b.z)+this.datum_params[0];b.y=j;b.z=c}},geocentric_from_wgs84:function(b){if(1===this.datum_type)b.x-=
this.datum_params[0],b.y-=this.datum_params[1],b.z-=this.datum_params[2];else if(2===this.datum_type){var c=this.datum_params[3],m=this.datum_params[4],g=this.datum_params[5],l=this.datum_params[6],j=(b.x-this.datum_params[0])/l,n=(b.y-this.datum_params[1])/l,l=(b.z-this.datum_params[2])/l;b.x=j+g*n-m*l;b.y=-g*j+n+c*l;b.z=m*j-c*n+l}}};g.exports=k},{}],31:[function(c,g){g.exports=function(b,c,e){var i,m,g;if(b.compare_datums(c)||5===b.datum_type||5===c.datum_type)return e;var l=b.a,j=b.es,n=c.a,r=
c.es;i=b.datum_type;if(3===i)if(0===this.apply_gridshift(b,0,e))b.a=6378137,b.es=0.006694379990141316;else{if(!b.datum_params)return b.a=l,b.es=b.es,e;i=1;m=0;for(g=b.datum_params.length;g>m;m++)i*=b.datum_params[m];if(0===i)return b.a=l,b.es=b.es,e;i=3<b.datum_params.length?2:1}return 3===c.datum_type&&(c.a=6378137,c.es=0.006694379990141316),(b.es!==c.es||b.a!==c.a||1===i||2===i||1===c.datum_type||2===c.datum_type)&&(b.geodetic_to_geocentric(e),(1===b.datum_type||2===b.datum_type)&&b.geocentric_to_wgs84(e),
(1===c.datum_type||2===c.datum_type)&&c.geocentric_from_wgs84(e),c.geocentric_to_geodetic(e)),3===c.datum_type&&this.apply_gridshift(c,1,e),b.a=l,b.es=j,c.a=n,c.es=r,e}},{}],32:[function(c,g){function b(c){var g=this;if(2===arguments.length){var l=arguments[1];"string"==typeof l?"+"===l.charAt(0)?b[c]=e(arguments[1]):b[c]=i(arguments[1]):b[c]=l}else if(1===arguments.length){if(Array.isArray(c))return c.map(function(c){Array.isArray(c)?b.apply(g,c):b(c)});if("string"==typeof c){if(c in b)return b[c]}else"EPSG"in
c?b["EPSG:"+c.EPSG]=c:"ESRI"in c?b["ESRI:"+c.ESRI]=c:"IAU2000"in c?b["IAU2000:"+c.IAU2000]=c:console.log(c)}}var k=c("./global"),e=c("./projString"),i=c("./wkt");k(b);g.exports=b},{"./global":35,"./projString":38,"./wkt":66}],33:[function(c,g){var b=c("./constants/Datum"),k=c("./constants/Ellipsoid"),e=c("./extend"),i=c("./datum");g.exports=function(c){if(c.datumCode&&"none"!==c.datumCode){var g=b[c.datumCode];g&&(c.datum_params=g.towgs84?g.towgs84.split(","):null,c.ellps=g.ellipse,c.datumName=g.datumName?
g.datumName:c.datumCode)}c.a||e(c,k[c.ellps]?k[c.ellps]:k.WGS84);return c.rf&&!c.b&&(c.b=(1-1/c.rf)*c.a),(0===c.rf||1.0E-10>Math.abs(c.a-c.b))&&(c.sphere=!0,c.b=c.a),c.a2=c.a*c.a,c.b2=c.b*c.b,c.es=(c.a2-c.b2)/c.a2,c.e=Math.sqrt(c.es),c.R_A&&(c.a*=1-c.es*(0.16666666666666666+c.es*(0.04722222222222222+0.022156084656084655*c.es)),c.a2=c.a*c.a,c.b2=c.b*c.b,c.es=0),c.ep2=(c.a2-c.b2)/c.b2,c.k0||(c.k0=1),c.axis||(c.axis="enu"),c.datum||(c.datum=i(c)),c}},{"./constants/Datum":25,"./constants/Ellipsoid":26,
"./datum":30,"./extend":34}],34:[function(c,g){g.exports=function(b,c){var b=b||{},e,i;if(!c)return b;for(i in c)e=c[i],void 0!==e&&(b[i]=e);return b}},{}],35:[function(c,g){g.exports=function(b){b("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");b("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees");b("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");
b.WGS84=b["EPSG:4326"];b["EPSG:3785"]=b["EPSG:3857"];b.GOOGLE=b["EPSG:3857"];b["EPSG:900913"]=b["EPSG:3857"];b["EPSG:102113"]=b["EPSG:3857"]}},{}],36:[function(c,g){var b=c("./core");b.defaultDatum="WGS84";b.Proj=c("./Proj");b.WGS84=new b.Proj("WGS84");b.Point=c("./Point");b.toPoint=c("./common/toPoint");b.defs=c("./defs");b.transform=c("./transform");b.mgrs=c("mgrs");b.version=c("../package.json").version;c("./includedProjections")(b);g.exports=b},{"../package.json":68,"./Point":1,"./Proj":2,"./common/toPoint":23,
"./core":29,"./defs":32,"./includedProjections":"hTEDpn","./transform":65,mgrs:67}],37:[function(c,g){function b(b){return["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"].reduce(function(c,e){return c+1+b.indexOf(e)},0)}var k=c("./defs"),e=c("./wkt"),i=c("./projString");g.exports=function(c){return"string"==typeof c?c in k?k[c]:b(c)?e(c):"+"===c[0]?i(c):void 0:c}},{"./defs":32,"./projString":38,"./wkt":66}],38:[function(c,g){var b=c("./constants/PrimeMeridian"),k=c("./constants/units");g.exports=function(c){var i=
{},g={};c.split("+").map(function(b){return b.trim()}).filter(function(b){return b}).forEach(function(b){b=b.split("=");b.push(!0);g[b[0].toLowerCase()]=b[1]});var o,l,j={proj:"projName",datum:"datumCode",rf:function(b){i.rf=parseFloat(b)},lat_0:function(b){i.lat0=0.017453292519943295*b},lat_1:function(b){i.lat1=0.017453292519943295*b},lat_2:function(b){i.lat2=0.017453292519943295*b},lat_ts:function(b){i.lat_ts=0.017453292519943295*b},lon_0:function(b){i.long0=0.017453292519943295*b},lon_1:function(b){i.long1=
0.017453292519943295*b},lon_2:function(b){i.long2=0.017453292519943295*b},alpha:function(b){i.alpha=0.017453292519943295*parseFloat(b)},lonc:function(b){i.longc=0.017453292519943295*b},x_0:function(b){i.x0=parseFloat(b)},y_0:function(b){i.y0=parseFloat(b)},k_0:function(b){i.k0=parseFloat(b)},k:function(b){i.k0=parseFloat(b)},a:function(b){i.a=parseFloat(b)},b:function(b){i.b=parseFloat(b)},r_a:function(){i.R_A=!0},zone:function(b){i.zone=parseInt(b,10)},south:function(){i.utmSouth=!0},towgs84:function(b){i.datum_params=
b.split(",").map(function(b){return parseFloat(b)})},to_meter:function(b){i.to_meter=parseFloat(b)},units:function(b){i.units=b;k[b]&&(i.to_meter=k[b].to_meter)},from_greenwich:function(b){i.from_greenwich=0.017453292519943295*b},pm:function(c){i.from_greenwich=0.017453292519943295*(b[c]?b[c]:parseFloat(c))},nadgrids:function(b){"@null"===b?i.datumCode="none":i.nadgrids=b},axis:function(b){3===b.length&&-1!=="ewnsud".indexOf(b.substr(0,1))&&-1!=="ewnsud".indexOf(b.substr(1,1))&&-1!=="ewnsud".indexOf(b.substr(2,
1))&&(i.axis=b)}};for(o in g)c=g[o],o in j?(l=j[o],"function"==typeof l?l(c):i[l]=c):i[o]=c;return"string"==typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(c,g,b){function k(b,c){var e=m.length;return b.names?(m[e]=b,b.names.forEach(function(b){i[b.toLowerCase()]=e}),this):(console.log(c),!0)}var e=[c("./projections/merc"),c("./projections/longlat")],i={},m=[];b.add=k;b.get=function(b){if(!b)return!1;
b=b.toLowerCase();return"undefined"!=typeof i[b]&&m[i[b]]?m[i[b]]:void 0};b.start=function(){e.forEach(k)}},{"./projections/longlat":51,"./projections/merc":52}],40:[function(c,g,b){var k=c("../common/msfnz"),e=c("../common/qsfnz"),i=c("../common/adjust_lon"),m=c("../common/asinz");b.init=function(){1.0E-10>Math.abs(this.lat1+this.lat2)||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,
this.con=this.sin_po,this.ms1=k(this.e3,this.sin_po,this.cos_po),this.qs1=e(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=k(this.e3,this.sin_po,this.cos_po),this.qs2=e(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=e(this.e3,this.sin_po,this.cos_po),1.0E-10<Math.abs(this.lat1-this.lat2)?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-
this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)};b.forward=function(b){var c=b.x,j=b.y;this.sin_phi=Math.sin(j);this.cos_phi=Math.cos(j);var j=e(this.e3,this.sin_phi,this.cos_phi),j=this.a*Math.sqrt(this.c-this.ns0*j)/this.ns0,n=this.ns0*i(c-this.long0),c=j*Math.sin(n)+this.x0,j=this.rh-j*Math.cos(n)+this.y0;return b.x=c,b.y=j,b};b.inverse=function(b){var c,e,n,g,m,p;return b.x-=this.x0,b.y=this.rh-b.y+this.y0,0<=
this.ns0?(c=Math.sqrt(b.x*b.x+b.y*b.y),n=1):(c=-Math.sqrt(b.x*b.x+b.y*b.y),n=-1),g=0,0!==c&&(g=Math.atan2(n*b.x,n*b.y)),n=c*this.ns0/this.a,this.sphere?p=Math.asin((this.c-n*n)/(2*this.ns0)):(e=(this.c-n*n)/this.ns0,p=this.phi1z(this.e3,e)),m=i(g/this.ns0+this.long0),b.x=m,b.y=p,b};b.phi1z=function(b,c){var e,i,g,k,p,t=m(0.5*c);if(1.0E-10>b)return t;for(var B=b*b,v=1;25>=v;v++)if(e=Math.sin(t),i=Math.cos(t),g=b*e,k=1-g*g,p=0.5*k*k/i*(c/(1-B)-e/k+0.5/b*Math.log((1-g)/(1+g))),t+=p,1.0E-7>=Math.abs(p))return t;
return null};b.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(c,g,b){var k=c("../common/adjust_lon"),e=Math.PI/2,i=c("../common/mlfn"),m=c("../common/e0fn"),o=c("../common/e1fn"),l=c("../common/e2fn"),j=c("../common/e3fn"),n=c("../common/gN"),r=c("../common/asinz"),q=c("../common/imlfn");b.init=function(){this.sin_p12=Math.sin(this.lat0);this.cos_p12=Math.cos(this.lat0)};b.forward=function(b){var c,
g,r,q,E,w,y,z,D,u,x,A,F,W,N,S,V,R,T,qa,ba,U,wa,P=b.x,ga=b.y,Da=Math.sin(b.y),va=Math.cos(b.y),P=k(P-this.long0);return this.sphere?1.0E-10>=Math.abs(this.sin_p12-1)?(b.x=this.x0+this.a*(e-ga)*Math.sin(P),b.y=this.y0-this.a*(e-ga)*Math.cos(P),b):1.0E-10>=Math.abs(this.sin_p12+1)?(b.x=this.x0+this.a*(e+ga)*Math.sin(P),b.y=this.y0+this.a*(e+ga)*Math.cos(P),b):(R=this.sin_p12*Da+this.cos_p12*va*Math.cos(P),S=Math.acos(R),V=S/Math.sin(S),b.x=this.x0+this.a*V*va*Math.sin(P),b.y=this.y0+this.a*V*(this.cos_p12*
Da-this.sin_p12*va*Math.cos(P)),b):(c=m(this.es),g=o(this.es),r=l(this.es),q=j(this.es),1.0E-10>=Math.abs(this.sin_p12-1)?(E=this.a*i(c,g,r,q,e),w=this.a*i(c,g,r,q,ga),b.x=this.x0+(E-w)*Math.sin(P),b.y=this.y0-(E-w)*Math.cos(P),b):1.0E-10>=Math.abs(this.sin_p12+1)?(E=this.a*i(c,g,r,q,e),w=this.a*i(c,g,r,q,ga),b.x=this.x0+(E+w)*Math.sin(P),b.y=this.y0+(E+w)*Math.cos(P),b):(y=Da/va,z=n(this.a,this.e,this.sin_p12),D=n(this.a,this.e,Da),u=Math.atan((1-this.es)*y+this.es*z*this.sin_p12/(D*va)),x=Math.atan2(Math.sin(P),
this.cos_p12*Math.tan(u)-this.sin_p12*Math.cos(P)),T=0===x?Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):1.0E-10>=Math.abs(Math.abs(x)-Math.PI)?-Math.asin(this.cos_p12*Math.sin(u)-this.sin_p12*Math.cos(u)):Math.asin(Math.sin(P)*Math.cos(u)/Math.sin(x)),A=this.e*this.sin_p12/Math.sqrt(1-this.es),F=this.e*this.cos_p12*Math.cos(x)/Math.sqrt(1-this.es),W=A*F,N=F*F,qa=T*T,ba=qa*T,U=ba*T,wa=U*T,S=z*T*(1-qa*N*(1-N)/6+ba/8*W*(1-2*N)+U/120*(N*(4-7*N)-3*A*A*(1-7*N))-wa/48*W),b.x=this.x0+S*Math.sin(x),
b.y=this.y0+S*Math.cos(x),b))};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var c,g,v,C,E,w,y,z,D,u,x,A,F,W,N,S,V,R,T,qa,ba,U,wa;return this.sphere?(c=Math.sqrt(b.x*b.x+b.y*b.y),c>2*e*this.a)?void 0:(g=c/this.a,v=Math.sin(g),C=Math.cos(g),E=this.long0,1.0E-10>=Math.abs(c)?w=this.lat0:(w=r(C*this.sin_p12+b.y*v*this.cos_p12/c),y=Math.abs(this.lat0)-e,E=k(1.0E-10>=Math.abs(y)?0<=this.lat0?this.long0+Math.atan2(b.x,-b.y):this.long0-Math.atan2(-b.x,b.y):this.long0+Math.atan2(b.x*v,c*this.cos_p12*C-
b.y*this.sin_p12*v))),b.x=E,b.y=w,b):(z=m(this.es),D=o(this.es),u=l(this.es),x=j(this.es),1.0E-10>=Math.abs(this.sin_p12-1)?(A=this.a*i(z,D,u,x,e),c=Math.sqrt(b.x*b.x+b.y*b.y),F=A-c,w=q(F/this.a,z,D,u,x),E=k(this.long0+Math.atan2(b.x,-1*b.y)),b.x=E,b.y=w,b):1.0E-10>=Math.abs(this.sin_p12+1)?(A=this.a*i(z,D,u,x,e),c=Math.sqrt(b.x*b.x+b.y*b.y),F=c-A,w=q(F/this.a,z,D,u,x),E=k(this.long0+Math.atan2(b.x,b.y)),b.x=E,b.y=w,b):(c=Math.sqrt(b.x*b.x+b.y*b.y),S=Math.atan2(b.x,b.y),W=n(this.a,this.e,this.sin_p12),
V=Math.cos(S),R=this.e*this.cos_p12*V,T=-R*R/(1-this.es),qa=3*this.es*(1-T)*this.sin_p12*this.cos_p12*V/(1-this.es),ba=c/W,U=ba-T*(1+T)*Math.pow(ba,3)/6-qa*(1+3*T)*Math.pow(ba,4)/24,wa=1-T*U*U/2-ba*U*U*U/6,N=Math.asin(this.sin_p12*Math.cos(U)+this.cos_p12*Math.sin(U)*V),E=k(this.long0+Math.asin(Math.sin(S)*Math.sin(U)/Math.cos(N))),w=Math.atan((1-this.es*wa*this.sin_p12/Math.sin(N))*Math.tan(N)/(1-this.es)),b.x=E,b.y=w,b))};b.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,
"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(c,g,b){var k=c("../common/mlfn"),e=c("../common/e0fn"),i=c("../common/e1fn"),m=c("../common/e2fn"),o=c("../common/e3fn"),l=c("../common/gN"),j=c("../common/adjust_lon"),n=c("../common/adjust_lat"),r=c("../common/imlfn"),q=Math.PI/2;b.init=function(){this.sphere||(this.e0=e(this.es),this.e1=i(this.es),this.e2=m(this.es),this.e3=o(this.es),this.ml0=this.a*
k(this.e0,this.e1,this.e2,this.e3,this.lat0))};b.forward=function(b){var c,e,i=b.x,g=b.y;if(i=j(i-this.long0),this.sphere)c=this.a*Math.asin(Math.cos(g)*Math.sin(i)),e=this.a*(Math.atan2(Math.tan(g),Math.cos(i))-this.lat0);else{e=Math.sin(g);var n=Math.cos(g),m=l(this.a,this.e,e),o=Math.tan(g)*Math.tan(g);c=i*Math.cos(g);var i=c*c,r=this.es*n*n/(1-this.es),g=this.a*k(this.e0,this.e1,this.e2,this.e3,g);c=m*c*(1-i*o*(1/6-(8-o+8*r)*i/120));e=g-this.ml0+m*e/n*i*(0.5+(5-o+6*r)*i/24)}return b.x=c+this.x0,
b.y=e+this.y0,b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var c,e,i=b.x/this.a;c=b.y/this.a;if(this.sphere)e=c+this.lat0,c=Math.asin(Math.sin(e)*Math.cos(i)),e=Math.atan2(Math.tan(i),Math.cos(e));else{e=r(this.ml0/this.a+c,this.e0,this.e1,this.e2,this.e3);if(1.0E-10>=Math.abs(Math.abs(e)-q))return b.x=this.long0,b.y=q,0>c&&(b.y*=-1),b;c=l(this.a,this.e,Math.sin(e));var g=c*c*c/this.a/this.a*(1-this.es),m=Math.pow(Math.tan(e),2),i=i*this.a/c,k=i*i;c=e-c*Math.tan(e)/g*i*i*(0.5-(1+3*m)*i*i/24);
e=i*(1-k*(m/3+(1+3*m)*m*k/15))/Math.cos(e)}return b.x=j(e+this.long0),b.y=n(c),b};b.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(c,g,b){var k=c("../common/adjust_lon"),e=c("../common/qsfnz"),i=c("../common/msfnz"),m=c("../common/iqsfnz");b.init=function(){this.sphere||(this.k0=i(this.e,Math.sin(this.lat_ts),
Math.cos(this.lat_ts)))};b.forward=function(b){var c,j;j=b.y;c=k(b.x-this.long0);this.sphere?(c=this.x0+this.a*c*Math.cos(this.lat_ts),j=this.y0+this.a*Math.sin(j)/Math.cos(this.lat_ts)):(j=e(this.e,Math.sin(j)),c=this.x0+this.a*this.k0*c,j=this.y0+0.5*this.a*j/this.k0);return b.x=c,b.y=j,b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var c,e;return this.sphere?(c=k(this.long0+b.x/this.a/Math.cos(this.lat_ts)),e=Math.asin(b.y/this.a*Math.cos(this.lat_ts))):(e=m(this.e,2*b.y*this.k0/this.a),c=
k(this.long0+b.x/(this.a*this.k0))),b.x=c,b.y=e,b};b.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(c,g,b){var k=c("../common/adjust_lon"),e=c("../common/adjust_lat");b.init=function(){this.x0=this.x0||0;this.y0=this.y0||0;this.lat0=this.lat0||0;this.long0=this.long0||0;this.lat_ts=this.lat_ts||0;this.title=this.title||"Equidistant Cylindrical (Plate Carre)";this.rc=Math.cos(this.lat_ts)};b.forward=function(b){var c=b.y,g=k(b.x-
this.long0),c=e(c-this.lat0);return b.x=this.x0+this.a*g*this.rc,b.y=this.y0+this.a*c,b};b.inverse=function(b){var c=b.y;return b.x=k(this.long0+(b.x-this.x0)/(this.a*this.rc)),b.y=e(this.lat0+(c-this.y0)/this.a),b};b.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(c,g,b){var k=c("../common/e0fn"),e=c("../common/e1fn"),i=c("../common/e2fn"),m=c("../common/e3fn"),o=c("../common/msfnz"),l=c("../common/mlfn"),j=c("../common/adjust_lon"),
n=c("../common/adjust_lat"),r=c("../common/imlfn");b.init=function(){1.0E-10>Math.abs(this.lat1+this.lat2)||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=k(this.es),this.e1=e(this.es),this.e2=i(this.es),this.e3=m(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=o(this.e,this.sinphi,this.cosphi),this.ml1=l(this.e0,this.e1,this.e2,this.e3,this.lat1),1.0E-10>Math.abs(this.lat1-this.lat2)?this.ns=
this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=o(this.e,this.sinphi,this.cosphi),this.ml2=l(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=l(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))};b.forward=function(b){var c,e=b.x;c=b.y;c=this.sphere?this.a*(this.g-c):this.a*(this.g-l(this.e0,this.e1,this.e2,this.e3,c));var i=this.ns*j(e-this.long0),e=
this.x0+c*Math.sin(i);c=this.y0+this.rh-c*Math.cos(i);return b.x=e,b.y=c,b};b.inverse=function(b){b.x-=this.x0;b.y=this.rh-b.y+this.y0;var c,e,l,i;0<=this.ns?(e=Math.sqrt(b.x*b.x+b.y*b.y),c=1):(e=-Math.sqrt(b.x*b.x+b.y*b.y),c=-1);var g=0;return(0!==e&&(g=Math.atan2(c*b.x,c*b.y)),this.sphere)?(i=j(this.long0+g/this.ns),l=n(this.g-e/this.a),b.x=i,b.y=l,b):(l=r(this.g-e/this.a,this.e0,this.e1,this.e2,this.e3),i=j(this.long0+g/this.ns),b.x=i,b.y=l,b)};b.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,
"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(c,g,b){var k=Math.PI/4,e=c("../common/srat"),i=Math.PI/2;b.init=function(){var b=Math.sin(this.lat0),c=Math.cos(this.lat0),c=c*c;this.rc=Math.sqrt(1-this.es)/(1-this.es*b*b);this.C=Math.sqrt(1+this.es*c*c/(1-this.es));this.phic0=Math.asin(b/this.C);this.ratexp=0.5*this.C*this.e;this.K=Math.tan(0.5*this.phic0+k)/(Math.pow(Math.tan(0.5*
this.lat0+k),this.C)*e(this.e*b,this.ratexp))};b.forward=function(b){var c=b.x,l=b.y;return b.y=2*Math.atan(this.K*Math.pow(Math.tan(0.5*l+k),this.C)*e(this.e*Math.sin(l),this.ratexp))-i,b.x=this.C*c,b};b.inverse=function(b){for(var c=b.x/this.C,l=b.y,j=Math.pow(Math.tan(0.5*l+k)/this.K,1/this.C),g=20;0<g&&(l=2*Math.atan(j*e(this.e*Math.sin(b.y),-0.5*this.e))-i,!(1.0E-14>Math.abs(l-b.y)));--g)b.y=l;return g?(b.x=c,b.y=l,b):null};b.names=["gauss"]},{"../common/srat":22}],47:[function(c,g,b){var k=
c("../common/adjust_lon"),e=c("../common/asinz");b.init=function(){this.sin_p14=Math.sin(this.lat0);this.cos_p14=Math.cos(this.lat0);this.infinity_dist=1E3*this.a;this.rc=1};b.forward=function(b){var c,e,l,j,g,r,q,p=b.y;return l=k(b.x-this.long0),c=Math.sin(p),e=Math.cos(p),j=Math.cos(l),g=this.sin_p14*c+this.cos_p14*e*j,0<g||1.0E-10>=Math.abs(g)?(r=this.x0+1*this.a*e*Math.sin(l)/g,q=this.y0+1*this.a*(this.cos_p14*c-this.sin_p14*e*j)/g):(r=this.x0+this.infinity_dist*e*Math.sin(l),q=this.y0+this.infinity_dist*
(this.cos_p14*c-this.sin_p14*e*j)),b.x=r,b.y=q,b};b.inverse=function(b){var c,g,l,j,n,r;return b.x=(b.x-this.x0)/this.a,b.y=(b.y-this.y0)/this.a,b.x/=this.k0,b.y/=this.k0,(c=Math.sqrt(b.x*b.x+b.y*b.y))?(j=Math.atan2(c,this.rc),g=Math.sin(j),l=Math.cos(j),r=e(l*this.sin_p14+b.y*g*this.cos_p14/c),n=Math.atan2(b.x*g,c*this.cos_p14*l-b.y*this.sin_p14*g),n=k(this.long0+n)):(r=this.phic0,n=0),b.x=n,b.y=r,b};b.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],48:[function(c,g,b){var k=c("../common/adjust_lon");
b.init=function(){this.a=6377397.155;this.es=0.006674372230614;this.e=Math.sqrt(this.es);this.lat0||(this.lat0=0.863937979737193);this.long0||(this.long0=0.4334234309119251);this.k0||(this.k0=0.9999);this.s45=0.785398163397448;this.s90=2*this.s45;this.fi0=this.lat0;this.e2=this.es;this.e=Math.sqrt(this.e2);this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2));this.uq=1.04216856380474;this.u0=Math.asin(Math.sin(this.fi0)/this.alfa);this.g=Math.pow((1+this.e*Math.sin(this.fi0))/
(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2);this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g;this.k1=this.k0;this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2));this.s0=1.37008346281555;this.n=Math.sin(this.s0);this.ro0=this.k1*this.n0/Math.tan(this.s0);this.ad=this.s90-this.uq};b.forward=function(b){var c,g,o,l,j,n,r,q=b.y,p=k(b.x-this.long0);return c=Math.pow((1+this.e*Math.sin(q))/(1-this.e*Math.sin(q)),this.alfa*this.e/
2),g=2*(Math.atan(this.k*Math.pow(Math.tan(q/2+this.s45),this.alfa)/c)-this.s45),o=-p*this.alfa,l=Math.asin(Math.cos(this.ad)*Math.sin(g)+Math.sin(this.ad)*Math.cos(g)*Math.cos(o)),j=Math.asin(Math.cos(g)*Math.sin(o)/Math.cos(l)),n=this.n*j,r=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(l/2+this.s45),this.n),b.y=r*Math.cos(n)/1,b.x=r*Math.sin(n)/1,this.czech||(b.y*=-1,b.x*=-1),b};b.inverse=function(b){var c,g,k;c=b.x;b.x=b.y;b.y=c;this.czech||(b.y*=-1,b.x*=-1);c=Math.sqrt(b.x*
b.x+b.y*b.y);g=Math.atan2(b.y,b.x)/Math.sin(this.s0);k=2*(Math.atan(Math.pow(this.ro0/c,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45);c=Math.asin(Math.cos(this.ad)*Math.sin(k)-Math.sin(this.ad)*Math.cos(k)*Math.cos(g));g=Math.asin(Math.cos(k)*Math.sin(g)/Math.cos(c));b.x=this.long0-g/this.alfa;g=c;var l=k=0;do b.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(c/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(g))/(1-this.e*Math.sin(g)),this.e/2))-this.s45),1.0E-10>Math.abs(g-
b.y)&&(k=1),g=b.y,l+=1;while(0===k&&15>l);return 15<=l?null:b};b.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],49:[function(c,g,b){var k=Math.PI/2,e=Math.PI/4,i=c("../common/qsfnz"),m=c("../common/adjust_lon");b.S_POLE=1;b.N_POLE=2;b.EQUIT=3;b.OBLIQ=4;b.init=function(){var b=Math.abs(this.lat0);if(1.0E-10>Math.abs(b-k)?this.mode=0>this.lat0?this.S_POLE:this.N_POLE:1.0E-10>Math.abs(b)?this.mode=this.EQUIT:this.mode=this.OBLIQ,0<this.es)switch(this.qp=i(this.e,1),this.mmf=0.5/(1-this.es),this.apa=
this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(0.5*this.qp);this.dd=1/this.rq;this.xmf=1;this.ymf=0.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(0.5*this.qp),b=Math.sin(this.lat0),this.sinb1=i(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&
(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))};b.forward=function(b){var c,j,g,r,q,p,t,B,v;r=b.x;var C=b.y;if(r=m(r-this.long0),this.sphere)if(q=Math.sin(C),p=Math.cos(C),g=Math.cos(r),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(j=this.mode===this.EQUIT?1+p*g:1+this.sinph0*q+this.cosph0*p*g,1.0E-10>=j)return null;j=Math.sqrt(2/j);c=j*p*Math.sin(r);j*=this.mode===this.EQUIT?q:this.cosph0*q-this.sinph0*p*g}else{if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===
this.N_POLE&&(g=-g),1.0E-10>Math.abs(C+this.phi0))return null;j=e-0.5*C;j=2*(this.mode===this.S_POLE?Math.cos(j):Math.sin(j));c=j*Math.sin(r);j*=g}}else{switch(t=0,B=0,v=0,g=Math.cos(r),r=Math.sin(r),q=Math.sin(C),p=i(this.e,q),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(t=p/this.qp,B=Math.sqrt(1-t*t)),this.mode){case this.OBLIQ:v=1+this.sinb1*t+this.cosb1*B*g;break;case this.EQUIT:v=1+B*g;break;case this.N_POLE:v=k+C;p=this.qp-p;break;case this.S_POLE:v=C-k,p=this.qp+p}if(1.0E-10>Math.abs(v))return null;
switch(this.mode){case this.OBLIQ:case this.EQUIT:v=Math.sqrt(2/v);j=this.mode===this.OBLIQ?this.ymf*v*(this.cosb1*t-this.sinb1*B*g):(v=Math.sqrt(2/(1+B*g)))*t*this.ymf;c=this.xmf*v*B*r;break;case this.N_POLE:case this.S_POLE:0<=p?(c=(v=Math.sqrt(p))*r,j=g*(this.mode===this.S_POLE?v:-v)):c=j=0}}return b.x=this.a*c+this.x0,b.y=this.a*j+this.y0,b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var c,e,g,i,q;c=b.x/this.a;var p=b.y/this.a;if(this.sphere){i=q=0;if(g=Math.sqrt(c*c+p*p),e=0.5*g,1<e)return null;
switch(e=2*Math.asin(e),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(i=Math.sin(e),q=Math.cos(e)),this.mode){case this.EQUIT:e=1.0E-10>=Math.abs(g)?0:Math.asin(p*i/g);c*=i;p=q*g;break;case this.OBLIQ:e=1.0E-10>=Math.abs(g)?this.phi0:Math.asin(q*this.sinph0+p*i*this.cosph0/g);c*=i*this.cosph0;p=(q-Math.sin(e)*this.sinph0)*g;break;case this.N_POLE:p=-p;e=k-e;break;case this.S_POLE:e-=k}c=0!==p||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,p):0}else{if(e=0,this.mode===this.OBLIQ||
this.mode===this.EQUIT){if(c/=this.dd,p*=this.dd,q=Math.sqrt(c*c+p*p),1.0E-10>q)return b.x=0,b.y=this.phi0,b;i=2*Math.asin(0.5*q/this.rq);g=Math.cos(i);c*=i=Math.sin(i);this.mode===this.OBLIQ?(e=g*this.sinb1+p*i*this.cosb1/q,p=q*this.cosb1*g-p*this.sinb1*i):(e=p*i/q,p=q*g)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(p=-p),i=c*c+p*p,!i)return b.x=0,b.y=this.phi0,b;e=1-i/this.qp;this.mode===this.S_POLE&&(e=-e)}c=Math.atan2(c,p);e=this.authlat(Math.asin(e),
this.apa)}return b.x=m(this.long0+c),b.y=e,b};b.P00=0.3333333333333333;b.P01=0.17222222222222222;b.P02=0.10257936507936508;b.P10=0.06388888888888888;b.P11=0.0664021164021164;b.P20=0.016415012942191543;b.authset=function(b){var c,e=[];return e[0]=b*this.P00,c=b*b,e[0]+=c*this.P01,e[1]=c*this.P10,c*=b,e[0]+=c*this.P02,e[1]+=c*this.P11,e[2]=c*this.P20,e};b.authlat=function(b,c){var e=b+b;return b+c[0]*Math.sin(e)+c[1]*Math.sin(e+e)+c[2]*Math.sin(e+e+e)};b.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area",
"laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],50:[function(c,g,b){var k=c("../common/msfnz"),e=c("../common/tsfnz"),i=Math.PI/2,m=c("../common/sign"),o=c("../common/adjust_lon"),l=c("../common/phi2z");b.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(1.0E-10>Math.abs(this.lat1+this.lat2))){var b=this.b/this.a;this.e=Math.sqrt(1-b*b);var b=Math.sin(this.lat1),c=Math.cos(this.lat1),c=k(this.e,b,c),g=e(this.e,this.lat1,b),l=
Math.sin(this.lat2),i=Math.cos(this.lat2),i=k(this.e,l,i),l=e(this.e,this.lat2,l),m=e(this.e,this.lat0,Math.sin(this.lat0));1.0E-10<Math.abs(this.lat1-this.lat2)?this.ns=Math.log(c/i)/Math.log(g/l):this.ns=b;isNaN(this.ns)&&(this.ns=b);this.f0=c/(this.ns*Math.pow(g,this.ns));this.rh=this.a*this.f0*Math.pow(m,this.ns);this.title||(this.title="Lambert Conformal Conic")}};b.forward=function(b){var c=b.x,g=b.y;1.0E-10>=Math.abs(2*Math.abs(g)-Math.PI)&&(g=m(g)*(i-2.0E-10));var l=Math.abs(Math.abs(g)-i);
if(1.0E-10<l)g=e(this.e,g,Math.sin(g)),g=this.a*this.f0*Math.pow(g,this.ns);else{if(l=g*this.ns,0>=l)return null;g=0}c=this.ns*o(c-this.long0);return b.x=this.k0*g*Math.sin(c)+this.x0,b.y=this.k0*(this.rh-g*Math.cos(c))+this.y0,b};b.inverse=function(b){var c,e,g,k,m,B=(b.x-this.x0)/this.k0,v=this.rh-(b.y-this.y0)/this.k0;0<this.ns?(c=Math.sqrt(B*B+v*v),e=1):(c=-Math.sqrt(B*B+v*v),e=-1);var C=0;if(0!==c&&(C=Math.atan2(e*B,e*v)),0!==c||0<this.ns){if(e=1/this.ns,g=Math.pow(c/(this.a*this.f0),e),k=l(this.e,
g),-9999===k)return null}else k=-i;return m=o(C/this.ns+this.long0),b.x=m,b.y=k,b};b.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],51:[function(c,g,b){function k(b){return b}b.init=function(){};b.forward=k;b.inverse=k;b.names=["longlat","identity"]},{}],52:[function(c,g,b){var k=c("../common/msfnz"),e=Math.PI/2,i=c("../common/adjust_lon"),
m=Math.PI/4,o=c("../common/tsfnz"),l=c("../common/phi2z");b.init=function(){var b=this.b/this.a;this.es=1-b*b;"x0"in this||(this.x0=0);"y0"in this||(this.y0=0);this.e=Math.sqrt(this.es);this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=k(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)};b.forward=function(b){var c=b.x,g=b.y;if(90<57.29577951308232*g&&-90>57.29577951308232*g&&180<57.29577951308232*c&&-180>57.29577951308232*c||1.0E-10>=Math.abs(Math.abs(g)-
e))return null;if(this.sphere)c=this.x0+this.a*this.k0*i(c-this.long0),g=this.y0+this.a*this.k0*Math.log(Math.tan(m+0.5*g));else var l=Math.sin(g),g=o(this.e,g,l),c=this.x0+this.a*this.k0*i(c-this.long0),g=this.y0-this.a*this.k0*Math.log(g);return b.x=c,b.y=g,b};b.inverse=function(b){var c,g,k=b.x-this.x0,m=b.y-this.y0;if(this.sphere)g=e-2*Math.atan(Math.exp(-m/(this.a*this.k0)));else if(m=Math.exp(-m/(this.a*this.k0)),g=l(this.e,m),-9999===g)return null;return c=i(this.long0+k/(this.a*this.k0)),
b.x=c,b.y=g,b};b.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],53:[function(c,g,b){var k=c("../common/adjust_lon");b.init=function(){};b.forward=function(b){var c=b.y,g=this.x0+this.a*k(b.x-this.long0),c=this.y0+1.25*this.a*Math.log(Math.tan(Math.PI/4+c/2.5));return b.x=g,b.y=c,b};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var c=k(this.long0+
b.x/this.a),g=2.5*(Math.atan(Math.exp(0.8*b.y/this.a))-Math.PI/4);return b.x=c,b.y=g,b};b.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],54:[function(c,g,b){var k=c("../common/adjust_lon");b.init=function(){};b.forward=function(b){for(var c=b.y,g=k(b.x-this.long0),o=c,l=Math.PI*Math.sin(c),j=0;;j++){var n=-(o+Math.sin(o)-l)/(1+Math.cos(o));if(o+=n,1.0E-10>Math.abs(n))break}o/=2;1.0E-10>Math.PI/2-Math.abs(c)&&(g=0);c=0.900316316158*this.a*g*Math.cos(o)+this.x0;o=1.4142135623731*this.a*
Math.sin(o)+this.y0;return b.x=c,b.y=o,b};b.inverse=function(b){var c;b.x-=this.x0;b.y-=this.y0;c=b.y/(1.4142135623731*this.a);0.999999999999<Math.abs(c)&&(c=0.999999999999);c=Math.asin(c);var g=k(this.long0+b.x/(0.900316316158*this.a*Math.cos(c)));g<-Math.PI&&(g=-Math.PI);g>Math.PI&&(g=Math.PI);c=(2*c+Math.sin(2*c))/Math.PI;1<Math.abs(c)&&(c=1);c=Math.asin(c);return b.x=g,b.y=c,b};b.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],55:[function(c,g,b){b.iterations=1;b.init=function(){this.A=
[];this.A[1]=0.6399175073;this.A[2]=-0.1358797613;this.A[3]=0.063294409;this.A[4]=-0.02526853;this.A[5]=0.0117879;this.A[6]=-0.0055161;this.A[7]=0.0026906;this.A[8]=-0.001333;this.A[9]=6.7E-4;this.A[10]=-3.4E-4;this.B_re=[];this.B_im=[];this.B_re[1]=0.7557853228;this.B_im[1]=0;this.B_re[2]=0.249204646;this.B_im[2]=0.003371507;this.B_re[3]=-0.001541739;this.B_im[3]=0.04105856;this.B_re[4]=-0.10162907;this.B_im[4]=0.01727609;this.B_re[5]=-0.26623489;this.B_im[5]=-0.36249218;this.B_re[6]=-0.6870983;
this.B_im[6]=-1.1651967;this.C_re=[];this.C_im=[];this.C_re[1]=1.3231270439;this.C_im[1]=0;this.C_re[2]=-0.577245789;this.C_im[2]=-0.007809598;this.C_re[3]=0.508307513;this.C_im[3]=-0.112208952;this.C_re[4]=-0.15094762;this.C_im[4]=0.18200602;this.C_re[5]=1.01418179;this.C_im[5]=1.64497696;this.C_re[6]=1.9660549;this.C_im[6]=2.5127645;this.D=[];this.D[1]=1.5627014243;this.D[2]=0.5185406398;this.D[3]=-0.03333098;this.D[4]=-0.1052906;this.D[5]=-0.0368594;this.D[6]=0.007317;this.D[7]=0.0122;this.D[8]=
0.00394;this.D[9]=-0.0013};b.forward=function(b){var c,g=1.0E-5*((b.y-this.lat0)/4.84813681109536E-6),m=b.x-this.long0,o=1,l=0;for(c=1;10>=c;c++)o*=g,l+=this.A[c]*o;var j,o=l,l=1,n=j=0,r=0;for(c=1;6>=c;c++)g=l*o-j*m,j=j*o+l*m,l=g,n=n+this.B_re[c]*l-this.B_im[c]*j,r=r+this.B_im[c]*l+this.B_re[c]*j;return b.x=r*this.a+this.x0,b.y=n*this.a+this.y0,b};b.inverse=function(b){var c,g,m,o=(b.y-this.y0)/this.a,l=(b.x-this.x0)/this.a,j=1,n=m=0,r=0;for(c=1;6>=c;c++)g=j*o-m*l,m=m*o+j*l,j=g,n=n+this.C_re[c]*j-
this.C_im[c]*m,r=r+this.C_im[c]*j+this.C_re[c]*m;for(g=0;g<this.iterations;g++){var q,p,t=n;p=r;j=o;m=l;for(c=2;6>=c;c++)q=t*n-p*r,p=p*n+t*r,t=q,j+=(c-1)*(this.B_re[c]*t-this.B_im[c]*p),m+=(c-1)*(this.B_im[c]*t+this.B_re[c]*p);t=1;p=0;var B=this.B_re[1],v=this.B_im[1];for(c=2;6>=c;c++)q=t*n-p*r,p=p*n+t*r,t=q,B+=c*(this.B_re[c]*t-this.B_im[c]*p),v+=c*(this.B_im[c]*t+this.B_re[c]*p);r=B*B+v*v;n=(j*B+m*v)/r;r=(m*B-j*v)/r}o=n;l=1;n=0;for(c=1;9>=c;c++)l*=o,n+=this.D[c]*l;c=this.lat0+0.484813681109536*
n;return b.x=this.long0+r,b.y=c,b};b.names=["New_Zealand_Map_Grid","nzmg"]},{}],56:[function(c,g,b){var k=c("../common/tsfnz"),e=c("../common/adjust_lon"),i=c("../common/phi2z"),m=Math.PI/2,o=Math.PI/4;b.init=function(){this.no_off=this.no_off||!1;this.no_rot=this.no_rot||!1;isNaN(this.k0)&&(this.k0=1);var b=Math.sin(this.lat0),c=Math.cos(this.lat0),g=this.e*b;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(c,4));this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-g*g);b=k(this.e,this.lat0,b);
c=this.bl/c*Math.sqrt((1-this.es)/(1-g*g));1>c*c&&(c=1);var i;if(isNaN(this.longc)){g=k(this.e,this.lat1,Math.sin(this.lat1));i=k(this.e,this.lat2,Math.sin(this.lat2));0<=this.lat0?this.el=(c+Math.sqrt(c*c-1))*Math.pow(b,this.bl):this.el=(c-Math.sqrt(c*c-1))*Math.pow(b,this.bl);var g=Math.pow(g,this.bl),m=Math.pow(i,this.bl);i=this.el/g;b=0.5*(i-1/i);i=(this.el*this.el-m*g)/(this.el*this.el+m*g);g=(m-g)/(m+g);m=e(this.long1-this.long2);this.long0=0.5*(this.long1+this.long2)-Math.atan(i*Math.tan(0.5*
this.bl*m)/g)/this.bl;this.long0=e(this.long0);g=e(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*g)/b);this.alpha=Math.asin(c*Math.sin(this.gamma0))}else i=0<=this.lat0?c+Math.sqrt(c*c-1):c-Math.sqrt(c*c-1),this.el=i*Math.pow(b,this.bl),b=0.5*(i-1/i),this.gamma0=Math.asin(Math.sin(this.alpha)/c),this.long0=this.longc-Math.asin(b*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:0<=this.lat0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha)):this.uc=-1*this.al/
this.bl*Math.atan2(Math.sqrt(c*c-1),Math.cos(this.alpha))};b.forward=function(b){var c,g,i=b.y;c=e(b.x-this.long0);if(1.0E-10>=Math.abs(Math.abs(i)-m))c=0<i?-1:1,g=this.al/this.bl*Math.log(Math.tan(o+0.5*c*this.gamma0)),c=-1*c*m*this.al/this.bl;else{i=k(this.e,i,Math.sin(i));g=this.el/Math.pow(i,this.bl);i=0.5*(g-1/g);g=0.5*(g+1/g);var q=Math.sin(this.bl*c);g=(i*Math.sin(this.gamma0)-q*Math.cos(this.gamma0))/g;g=1.0E-10>=Math.abs(Math.abs(g)-1)?Number.POSITIVE_INFINITY:0.5*this.al*Math.log((1-g)/
(1+g))/this.bl;c=1.0E-10>=Math.abs(Math.cos(this.bl*c))?this.al*this.bl*c:this.al*Math.atan2(i*Math.cos(this.gamma0)+q*Math.sin(this.gamma0),Math.cos(this.bl*c))/this.bl}return this.no_rot?(b.x=this.x0+c,b.y=this.y0+g):(c-=this.uc,b.x=this.x0+g*Math.cos(this.alpha)+c*Math.sin(this.alpha),b.y=this.y0+c*Math.cos(this.alpha)-g*Math.sin(this.alpha)),b};b.inverse=function(b){var c,g;this.no_rot?(g=b.y-this.y0,c=b.x-this.x0):(g=(b.x-this.x0)*Math.cos(this.alpha)-(b.y-this.y0)*Math.sin(this.alpha),c=(b.y-
this.y0)*Math.cos(this.alpha)+(b.x-this.x0)*Math.sin(this.alpha),c+=this.uc);var k=Math.exp(-1*this.bl*g/this.al);g=0.5*(k-1/k);var o=0.5*(k+1/k),k=Math.sin(this.bl*c/this.al),o=(k*Math.cos(this.gamma0)+g*Math.sin(this.gamma0))/o,p=Math.pow(this.el/Math.sqrt((1+o)/(1-o)),1/this.bl);return 1.0E-10>Math.abs(o-1)?(b.x=this.long0,b.y=m):1.0E-10>Math.abs(o+1)?(b.x=this.long0,b.y=-1*m):(b.y=i(this.e,p),b.x=e(this.long0-Math.atan2(g*Math.cos(this.gamma0)-k*Math.sin(this.gamma0),Math.cos(this.bl*c/this.al))/
this.bl)),b};b.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],57:[function(c,g,b){var k=c("../common/e0fn"),e=c("../common/e1fn"),i=c("../common/e2fn"),m=c("../common/e3fn"),o=c("../common/adjust_lon"),l=c("../common/adjust_lat"),j=c("../common/mlfn"),n=c("../common/gN");b.init=function(){this.temp=this.b/this.a;this.es=
1-Math.pow(this.temp,2);this.e=Math.sqrt(this.es);this.e0=k(this.es);this.e1=e(this.es);this.e2=i(this.es);this.e3=m(this.es);this.ml0=this.a*j(this.e0,this.e1,this.e2,this.e3,this.lat0)};b.forward=function(b){var c,e,g,i=b.y,k=o(b.x-this.long0);(g=k*Math.sin(i),this.sphere)?1.0E-10>=Math.abs(i)?(c=this.a*k,e=-1*this.a*this.lat0):(c=this.a*Math.sin(g)/Math.tan(i),e=this.a*(l(i-this.lat0)+(1-Math.cos(g))/Math.tan(i))):1.0E-10>=Math.abs(i)?(c=this.a*k,e=-1*this.ml0):(e=n(this.a,this.e,Math.sin(i))/
Math.tan(i),c=e*Math.sin(g),e=this.a*j(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+e*(1-Math.cos(g)));return b.x=c+this.x0,b.y=e+this.y0,b};b.inverse=function(b){var c,e,g,l,i,k,n;if(c=b.x-this.x0,g=b.y-this.y0,this.sphere)if(1.0E-10>=Math.abs(g+this.a*this.lat0))c=o(c/this.a+this.long0),e=0;else{l=this.lat0+g/this.a;i=c*c/this.a/this.a+l*l;k=l;var m;for(g=20;g;--g)if(m=Math.tan(k),n=-1*(l*(k*m+1)-k-0.5*(k*k+i)*m)/((k-l)/m-1),k+=n,1.0E-10>=Math.abs(n)){e=k;break}c=o(this.long0+Math.asin(c*Math.tan(k)/
this.a)/Math.sin(e))}else if(1.0E-10>=Math.abs(g+this.ml0))e=0,c=o(this.long0+c/this.a);else{l=(this.ml0+g)/this.a;i=c*c/this.a/this.a+l*l;k=l;var y,z,D,u,x;for(g=20;g;--g)if(x=this.e*Math.sin(k),y=Math.sqrt(1-x*x)*Math.tan(k),z=this.a*j(this.e0,this.e1,this.e2,this.e3,k),D=this.e0-2*this.e1*Math.cos(2*k)+4*this.e2*Math.cos(4*k)-6*this.e3*Math.cos(6*k),u=z/this.a,n=(l*(y*u+1)-u-0.5*y*(u*u+i))/(this.es*Math.sin(2*k)*(u*u+i-2*l*u)/(4*y)+(l-u)*(y*D-2/Math.sin(2*k))-D),k-=n,1.0E-10>=Math.abs(n)){e=k;
break}y=Math.sqrt(1-this.es*Math.pow(Math.sin(e),2))*Math.tan(e);c=o(this.long0+Math.asin(c*y/this.a)/Math.sin(e))}return b.x=c,b.y=e,b};b.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],58:[function(c,g,b){var k=c("../common/adjust_lon"),e=c("../common/adjust_lat"),i=c("../common/pj_enfn"),m=c("../common/pj_mlfn"),o=c("../common/pj_inv_mlfn"),l=Math.PI/
2,j=c("../common/asinz");b.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=i(this.es)};b.forward=function(b){var c,e;c=b.x;e=b.y;if(c=k(c-this.long0),this.sphere){if(this.m)for(var g=this.n*Math.sin(e),j=20;j;--j){var l=(this.m*e+Math.sin(e)-g)/(this.m+Math.cos(e));if(e-=l,1.0E-10>Math.abs(l))break}else e=1!==this.n?Math.asin(this.n*Math.sin(e)):e;c=this.a*this.C_x*c*(this.m+Math.cos(e));e*=this.a*this.C_y}else g=
Math.sin(e),j=Math.cos(e),e=this.a*m(e,g,j,this.en),c=this.a*c*j/Math.sqrt(1-this.es*g*g);return b.x=c,b.y=e,b};b.inverse=function(b){var c,g,i,m;return b.x-=this.x0,i=b.x/this.a,b.y-=this.y0,c=b.y/this.a,this.sphere?(c/=this.C_y,i/=this.C_x*(this.m+Math.cos(c)),this.m?c=j((this.m*c+Math.sin(c))/this.n):1!==this.n&&(c=j(Math.sin(c)/this.n)),i=k(i+this.long0),c=e(c)):(c=o(b.y/this.a,this.es,this.en),m=Math.abs(c),l>m?(m=Math.sin(c),g=this.long0+b.x*Math.sqrt(1-this.es*m*m)/(this.a*Math.cos(c)),i=k(g)):
l>m-1.0E-10&&(i=this.long0)),b.x=i,b.y=c,b};b.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],59:[function(c,g,b){b.init=function(){var b=this.lat0;this.lambda0=this.long0;var c=Math.sin(b),g=this.a,m=1/this.rf,o=2*m-Math.pow(m,2),m=this.e=Math.sqrt(o);this.R=this.k0*g*Math.sqrt(1-o)/(1-o*Math.pow(c,2));this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(b),4));this.b0=Math.asin(c/
this.alpha);g=Math.log(Math.tan(Math.PI/4+this.b0/2));b=Math.log(Math.tan(Math.PI/4+b/2));c=Math.log((1+m*c)/(1-m*c));this.K=g-this.alpha*b+this.alpha*m/2*c};b.forward=function(b){var c=Math.log(Math.tan(Math.PI/4-b.y/2)),g=this.e/2*Math.log((1+this.e*Math.sin(b.y))/(1-this.e*Math.sin(b.y))),g=2*(Math.atan(Math.exp(-this.alpha*(c+g)+this.K))-Math.PI/4),m=this.alpha*(b.x-this.lambda0),c=Math.atan(Math.sin(m)/(Math.sin(this.b0)*Math.tan(g)+Math.cos(this.b0)*Math.cos(m))),g=Math.asin(Math.cos(this.b0)*
Math.sin(g)-Math.sin(this.b0)*Math.cos(g)*Math.cos(m));return b.y=this.R/2*Math.log((1+Math.sin(g))/(1-Math.sin(g)))+this.y0,b.x=this.R*c+this.x0,b};b.inverse=function(b){for(var c=(b.x-this.x0)/this.R,g=2*(Math.atan(Math.exp((b.y-this.y0)/this.R))-Math.PI/4),m=Math.asin(Math.cos(this.b0)*Math.sin(g)+Math.sin(this.b0)*Math.cos(g)*Math.cos(c)),c=this.lambda0+Math.atan(Math.sin(c)/(Math.cos(this.b0)*Math.cos(c)-Math.sin(this.b0)*Math.tan(g)))/this.alpha,g=0,o=m,l=-1E3,j=0;1.0E-7<Math.abs(o-l);){if(20<
++j)return;g=1/this.alpha*(Math.log(Math.tan(Math.PI/4+m/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(o))/2));l=o;o=2*Math.atan(Math.exp(g))-Math.PI/2}return b.x=c,b.y=o,b};b.names=["somerc"]},{}],60:[function(c,g,b){var k=Math.PI/2,e=c("../common/sign"),i=c("../common/msfnz"),m=c("../common/tsfnz"),o=c("../common/phi2z"),l=c("../common/adjust_lon");b.ssfn_=function(b,c,e){return c*=e,Math.tan(0.5*(k+b))*Math.pow((1-c)/(1+c),0.5*e)};b.init=function(){this.coslat0=Math.cos(this.lat0);
this.sinlat0=Math.sin(this.lat0);this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&1.0E-10>=Math.abs(this.coslat0)&&(this.k0=0.5*(1+e(this.lat0)*Math.sin(this.lat_ts))):(1.0E-10>=Math.abs(this.coslat0)&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&1.0E-10>=Math.abs(this.coslat0)&&(this.k0=0.5*this.cons*i(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/m(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),
this.ms1=i(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-k,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))};b.forward=function(b){var c,e,g,i,o,B,v=b.x,C=b.y,E=Math.sin(C),w=Math.cos(C),y=l(v-this.long0);return 1.0E-10>=Math.abs(Math.abs(v-this.long0)-Math.PI)&&1.0E-10>=Math.abs(C+this.lat0)?(b.x=NaN,b.y=NaN,b):this.sphere?(c=2*this.k0/(1+this.sinlat0*E+this.coslat0*w*Math.cos(y)),b.x=this.a*c*w*Math.sin(y)+this.x0,b.y=this.a*c*(this.coslat0*
E-this.sinlat0*w*Math.cos(y))+this.y0,b):(e=2*Math.atan(this.ssfn_(C,E,this.e))-k,i=Math.cos(e),g=Math.sin(e),1.0E-10>=Math.abs(this.coslat0)?(o=m(this.e,C*this.con,this.con*E),B=2*this.a*this.k0*o/this.cons,b.x=this.x0+B*Math.sin(v-this.long0),b.y=this.y0-this.con*B*Math.cos(v-this.long0),b):(1.0E-10>Math.abs(this.sinlat0)?(c=2*this.a*this.k0/(1+i*Math.cos(y)),b.y=c*g):(c=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*g+this.cosX0*i*Math.cos(y))),b.y=c*(this.cosX0*g-this.sinX0*i*Math.cos(y))+
this.y0),b.x=c*i*Math.sin(y)+this.x0,b))};b.inverse=function(b){b.x-=this.x0;b.y-=this.y0;var c,e,g,i=Math.sqrt(b.x*b.x+b.y*b.y);if(this.sphere)return g=2*Math.atan(i/(0.5*this.a*this.k0)),c=this.long0,e=this.lat0,1.0E-10>=i?(b.x=c,b.y=e,b):(e=Math.asin(Math.cos(g)*this.sinlat0+b.y*Math.sin(g)*this.coslat0/i),c=l(1.0E-10>Math.abs(this.coslat0)?0<this.lat0?this.long0+Math.atan2(b.x,-1*b.y):this.long0+Math.atan2(b.x,b.y):this.long0+Math.atan2(b.x*Math.sin(g),i*this.coslat0*Math.cos(g)-b.y*this.sinlat0*
Math.sin(g))),b.x=c,b.y=e,b);if(1.0E-10>=Math.abs(this.coslat0)){if(1.0E-10>=i)return e=this.lat0,c=this.long0,b.x=c,b.y=e,b;b.x*=this.con;b.y*=this.con;c=i*this.cons/(2*this.a*this.k0);e=this.con*o(this.e,c);c=this.con*l(this.con*this.long0+Math.atan2(b.x,-1*b.y))}else e=2*Math.atan(i*this.cosX0/(2*this.a*this.k0*this.ms1)),c=this.long0,1.0E-10>=i?g=this.X0:(g=Math.asin(Math.cos(e)*this.sinX0+b.y*Math.sin(e)*this.cosX0/i),c=l(this.long0+Math.atan2(b.x*Math.sin(e),i*this.cosX0*Math.cos(e)-b.y*this.sinX0*
Math.sin(e)))),e=-1*o(this.e,Math.tan(0.5*(k+g)));return b.x=c,b.y=e,b};b.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],61:[function(c,g,b){var k=c("./gauss"),e=c("../common/adjust_lon");b.init=function(){k.init.apply(this);this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))};
b.forward=function(b){var c,g,l,j;return b.x=e(b.x-this.long0),k.forward.apply(this,[b]),c=Math.sin(b.y),g=Math.cos(b.y),l=Math.cos(b.x),j=this.k0*this.R2/(1+this.sinc0*c+this.cosc0*g*l),b.x=j*g*Math.sin(b.x),b.y=j*(this.cosc0*c-this.sinc0*g*l),b.x=this.a*b.x+this.x0,b.y=this.a*b.y+this.y0,b};b.inverse=function(b){var c,g,l,j;(b.x=(b.x-this.x0)/this.a,b.y=(b.y-this.y0)/this.a,b.x/=this.k0,b.y/=this.k0,j=Math.sqrt(b.x*b.x+b.y*b.y))?(l=2*Math.atan2(j,this.R2),c=Math.sin(l),g=Math.cos(l),l=Math.asin(g*
this.sinc0+b.y*c*this.cosc0/j),c=Math.atan2(b.x*c,j*this.cosc0*g-b.y*this.sinc0*c)):(l=this.phic0,c=0);return b.x=c,b.y=l,k.inverse.apply(this,[b]),b.x=e(b.x+this.long0),b};b.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],62:[function(c,g,b){var k=c("../common/e0fn"),e=c("../common/e1fn"),i=c("../common/e2fn"),m=c("../common/e3fn"),o=c("../common/mlfn"),l=c("../common/adjust_lon"),
j=Math.PI/2,n=c("../common/sign"),r=c("../common/asinz");b.init=function(){this.e0=k(this.es);this.e1=e(this.es);this.e2=i(this.es);this.e3=m(this.es);this.ml0=this.a*o(this.e0,this.e1,this.e2,this.e3,this.lat0)};b.forward=function(b){var c,e,g;g=b.y;var j=l(b.x-this.long0);c=Math.sin(g);var i=Math.cos(g);if(this.sphere){var k=i*Math.sin(j);if(1.0E-10>Math.abs(Math.abs(k)-1))return 93;e=0.5*this.a*this.k0*Math.log((1+k)/(1-k));c=Math.acos(i*Math.cos(j)/Math.sqrt(1-k*k));0>g&&(c=-c);g=this.a*this.k0*
(c-this.lat0)}else{e=i*j;var j=Math.pow(e,2),i=this.ep2*Math.pow(i,2),k=Math.tan(g),m=Math.pow(k,2);c=1-this.es*Math.pow(c,2);c=this.a/Math.sqrt(c);g=this.a*o(this.e0,this.e1,this.e2,this.e3,g);e=this.k0*c*e*(1+j/6*(1-m+i+j/20*(5-18*m+Math.pow(m,2)+72*i-58*this.ep2)))+this.x0;g=this.k0*(g-this.ml0+c*k*j*(0.5+j/24*(5-m+9*i+4*Math.pow(i,2)+j/30*(61-58*m+Math.pow(m,2)+600*i-330*this.ep2))))+this.y0}return b.x=e,b.y=g,b};b.inverse=function(b){var c,e,g,i;if(this.sphere){e=Math.exp(b.x/(this.a*this.k0));
var k=0.5*(e-1/e);g=this.lat0+b.y/(this.a*this.k0);i=Math.cos(g);c=Math.sqrt((1-i*i)/(1+k*k));e=r(c);0>g&&(e=-e);c=0===k&&0===i?this.long0:l(Math.atan2(k,i)+this.long0)}else{var k=b.x-this.x0,m=b.y-this.y0;e=c=(this.ml0+m/this.k0)/this.a;for(i=0;g=(c+this.e1*Math.sin(2*e)-this.e2*Math.sin(4*e)+this.e3*Math.sin(6*e))/this.e0-e,e+=g,!(1.0E-10>=Math.abs(g));i++)if(6<=i)return 95;if(Math.abs(e)<j){c=Math.sin(e);g=Math.cos(e);var o=Math.tan(e);i=this.ep2*Math.pow(g,2);var m=Math.pow(i,2),y=Math.pow(o,
2),z=Math.pow(y,2);c=1-this.es*Math.pow(c,2);var D=this.a/Math.sqrt(c);c=D*(1-this.es)/c;var k=k/(D*this.k0),u=Math.pow(k,2);e-=D*o*u/c*(0.5-u/24*(5+3*y+10*i-4*m-9*this.ep2-u/30*(61+90*y+298*i+45*z-252*this.ep2-3*m)));c=l(this.long0+k*(1-u/6*(1+2*y+i-u/20*(5-2*i+28*y-3*m+8*this.ep2+24*z)))/g)}else e=j*n(m),c=this.long0}return b.x=c,b.y=e,b};b.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,
"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],63:[function(c,g,b){var k=c("./tmerc");b.dependsOn="tmerc";b.init=function(){this.zone&&(this.lat0=0,this.long0=0.017453292519943295*(6*Math.abs(this.zone)-183),this.x0=5E5,this.y0=this.utmSouth?1E7:0,this.k0=0.9996,k.init.apply(this),this.forward=k.forward,this.inverse=k.inverse)};b.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":62}],64:[function(c,g,b){var k=c("../common/adjust_lon"),e=Math.PI/2,i=c("../common/asinz");
b.init=function(){this.R=this.a};b.forward=function(b){var c,g,j=b.y;c=k(b.x-this.long0);1.0E-10>=Math.abs(j)&&(g=this.y0);var n=i(2*Math.abs(j/Math.PI));(1.0E-10>=Math.abs(c)||1.0E-10>=Math.abs(Math.abs(j)-e))&&(g=0<=j?this.y0+Math.PI*this.R*Math.tan(0.5*n):this.y0+Math.PI*this.R*-Math.tan(0.5*n));var r=0.5*Math.abs(Math.PI/c-c/Math.PI),q=r*r,p=Math.sin(n),n=Math.cos(n),n=n/(p+n-1),p=n*(2/p-1),t=p*p,B=Math.PI*this.R*(r*(n-t)+Math.sqrt(q*(n-t)*(n-t)-(t+q)*(n*n-t)))/(t+q);0>c&&(B=-B);c=this.x0+B;n=
q+n;return B=Math.PI*this.R*(p*n-r*Math.sqrt((t+q)*(q+1)-n*n))/(t+q),g=0<=j?this.y0+B:this.y0-B,b.x=c,b.y=g,b};b.inverse=function(b){var c,e,g,i,r,q,p,t,B,v,C,E,w;return b.x-=this.x0,b.y-=this.y0,C=Math.PI*this.R,g=b.x/C,i=b.y/C,r=g*g+i*i,q=-Math.abs(i)*(1+r),p=q-2*i*i+g*g,t=-2*q+1+2*i*i+r*r,w=i*i/t+(2*p*p*p/t/t/t-9*q*p/t/t)/27,B=(q-p*p/3/t)/t,v=2*Math.sqrt(-B/3),C=3*w/B/v,1<Math.abs(C)&&(C=0<=C?1:-1),E=Math.acos(C)/3,e=0<=b.y?(-v*Math.cos(E+Math.PI/3)-p/3/t)*Math.PI:-(-v*Math.cos(E+Math.PI/3)-p/
3/t)*Math.PI,c=1.0E-10>Math.abs(g)?this.long0:k(this.long0+Math.PI*(r-1+Math.sqrt(1+2*(g*g-i*i)+r*r))/2/g),b.x=c,b.y=e,b};b.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],65:[function(c,g){var b=1,k=2,e=c("./datum_transform"),i=c("./adjust_axis"),m=c("./Proj"),o=c("./common/toPoint");g.exports=function j(c,g,q){function p(c,e){return(c.datum.datum_type===b||c.datum.datum_type===k)&&"WGS84"!==e.datumCode}var t;return Array.isArray(q)&&(q=o(q)),
c.datum&&g.datum&&(p(c,g)||p(g,c))&&(t=new m("WGS84"),j(c,t,q),c=t),"enu"!==c.axis&&i(c,!1,q),"longlat"===c.projName?(q.x*=0.017453292519943295,q.y*=0.017453292519943295):(c.to_meter&&(q.x*=c.to_meter,q.y*=c.to_meter),c.inverse(q)),c.from_greenwich&&(q.x+=c.from_greenwich),q=e(c.datum,g.datum,q),g.from_greenwich&&(q.x-=g.from_greenwich),"longlat"===g.projName?(q.x*=57.29577951308232,q.y*=57.29577951308232):(g.forward(q),g.to_meter&&(q.x/=g.to_meter,q.y/=g.to_meter)),"enu"!==g.axis&&i(g,!0,q),q}},
{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],66:[function(c,g){function b(b,c,e){b[c]=e.map(function(b){var c={};return k(b,c),c}).reduce(function(b,c){return o(b,c)},{})}function k(c,e){var g;return Array.isArray(c)?(g=c.shift(),"PARAMETER"===g&&(g=c.shift()),1===c.length?Array.isArray(c[0])?(e[g]={},k(c[0],e[g])):e[g]=c[0]:c.length?"TOWGS84"===g?e[g]=c:(e[g]={},-1<["UNIT","PRIMEM","VERT_DATUM"].indexOf(g)?(e[g]={name:c[0].toLowerCase(),convert:c[1]},3===c.length&&
(e[g].auth=c[2])):"SPHEROID"===g?(e[g]={name:c[0],a:c[1],rf:c[2]},4===c.length&&(e[g].auth=c[3])):-1<"GEOGCS GEOCCS DATUM VERT_CS COMPD_CS LOCAL_CS FITTED_CS LOCAL_DATUM".split(" ").indexOf(g)?(c[0]=["name",c[0]],b(e,g,c)):c.every(function(b){return Array.isArray(b)})?b(e,g,c):k(c,e[g])):e[g]=!0,void 0):void(e[c]=!0)}function e(b){return b*m}function i(b){function c(e){var g=b.to_meter||1;return parseFloat(e,10)*g}"GEOGCS"===b.type?b.projName="longlat":"LOCAL_CS"===b.type?(b.projName="identity",b.local=
!0):"object"==typeof b.PROJECTION?b.projName=Object.keys(b.PROJECTION)[0]:b.projName=b.PROJECTION;b.UNIT&&(b.units=b.UNIT.name.toLowerCase(),"metre"===b.units&&(b.units="meter"),b.UNIT.convert&&("GEOGCS"===b.type?b.DATUM&&b.DATUM.SPHEROID&&(b.to_meter=parseFloat(b.UNIT.convert,10)*b.DATUM.SPHEROID.a):b.to_meter=parseFloat(b.UNIT.convert,10)));b.GEOGCS&&(b.GEOGCS.DATUM?b.datumCode=b.GEOGCS.DATUM.name.toLowerCase():b.datumCode=b.GEOGCS.name.toLowerCase(),"d_"===b.datumCode.slice(0,2)&&(b.datumCode=
b.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===b.datumCode||"new_zealand_1949"===b.datumCode)&&(b.datumCode="nzgd49"),"wgs_1984"===b.datumCode&&("Mercator_Auxiliary_Sphere"===b.PROJECTION&&(b.sphere=!0),b.datumCode="wgs84"),"_ferro"===b.datumCode.slice(-6)&&(b.datumCode=b.datumCode.slice(0,-6)),"_jakarta"===b.datumCode.slice(-8)&&(b.datumCode=b.datumCode.slice(0,-8)),~b.datumCode.indexOf("belge")&&(b.datumCode="rnb72"),b.GEOGCS.DATUM&&b.GEOGCS.DATUM.SPHEROID&&(b.ellps=b.GEOGCS.DATUM.SPHEROID.name.replace("_19",
"").replace(/[Cc]larke\_18/,"clrk"),"international"===b.ellps.toLowerCase().slice(0,13)&&(b.ellps="intl"),b.a=b.GEOGCS.DATUM.SPHEROID.a,b.rf=parseFloat(b.GEOGCS.DATUM.SPHEROID.rf,10)),~b.datumCode.indexOf("osgb_1936")&&(b.datumCode="osgb36"));b.b&&!isFinite(b.b)&&(b.b=b.a);[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],
["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",e],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",e],["x0","false_easting",c],["y0","false_northing",c],["long0","central_meridian",e],["lat0","latitude_of_origin",e],["lat0","standard_parallel_1",e],["lat1","standard_parallel_1",e],["lat2","standard_parallel_2",e],["alpha","azimuth",e],["srsCode","name"]].forEach(function(c){var e=
b,g=c[0],i=c[1];!(g in e)&&i in e&&(e[g]=e[i],3===c.length&&(e[g]=c[2](e[g])))});b.long0||!b.longc||"Albers_Conic_Equal_Area"!==b.projName&&"Lambert_Azimuthal_Equal_Area"!==b.projName||(b.long0=b.longc);b.lat_ts||!b.lat1||"Stereographic_South_Pole"!==b.projName&&"Polar Stereographic (variant B)"!==b.projName||(b.lat0=(0<b.lat1?90:-90)*m,b.lat_ts=b.lat1)}var m=0.017453292519943295,o=c("./extend");g.exports=function(b,c){var e=JSON.parse((","+b).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,
',"$1"]').replace(/,\["VERTCS".+/,"")),g=e.shift(),m=e.shift();e.unshift(["name",m]);e.unshift(["type",g]);e.unshift("output");g={};return k(e,g),i(g.output),o(c,g.output)}},{"./extend":34}],67:[function(c,g,b){function k(b){var c=b.northing,e=b.easting,g=b.zoneLetter,i=b.zoneNumber;if(0>i||60<i)return null;var j,l,m;l=(1-Math.sqrt(0.99330562))/(1+Math.sqrt(0.99330562));e-=5E5;"N">g&&(c-=1E7);g=6*(i-1)-180+3;i=c/0.9996/6367449.145945056;c=i+(3*l/2-27*l*l*l/32)*Math.sin(2*i)+(21*l*l/16-55*l*l*l*l/
32)*Math.sin(4*i)+151*l*l*l/96*Math.sin(6*i);j=6378137/Math.sqrt(1-0.00669438*Math.sin(c)*Math.sin(c));l=Math.tan(c)*Math.tan(c);i=0.006739496752268451*Math.cos(c)*Math.cos(c);m=6335439.32722994/Math.pow(1-0.00669438*Math.sin(c)*Math.sin(c),1.5);e/=0.9996*j;j=c-j*Math.tan(c)/m*(e*e/2-(5+3*l+10*i-4*i*i-0.06065547077041606)*e*e*e*e/24+(61+90*l+298*i+45*l*l-1.6983531815716497-3*i*i)*e*e*e*e*e*e/720);j=180*(j/Math.PI);e=(e-(1+2*l+i)*e*e*e/6+(5-2*i+28*l-3*i*i+0.05391597401814761+24*l*l)*e*e*e*e*e/120)/
Math.cos(c);e=g+180*(e/Math.PI);b.accuracy?(b=k({northing:b.northing+b.accuracy,easting:b.easting+b.accuracy,zoneLetter:b.zoneLetter,zoneNumber:b.zoneNumber}),b={top:b.lat,right:b.lon,bottom:j,left:e}):b={lat:j,lon:e};return b}function e(b){b%=o;return 0===b&&(b=o),b}function i(b){if(b&&0===b.length)throw"MGRSPoint coverting from nothing";for(var c,g=b.length,i=null,k="",o=0;!/[A-Z]/.test(c=b.charAt(o));){if(2<=o)throw"MGRSPoint bad conversion from: "+b;k+=c;o++}c=parseInt(k,10);if(0===o||o+3>g)throw"MGRSPoint bad conversion from: "+
b;k=b.charAt(o++);if("A">=k||"B"===k||"Y"===k||"Z"<=k||"I"===k||"O"===k)throw"MGRSPoint zone letter "+k+" not handled: "+b;var i=b.substring(o,o+=2),z=e(c),D;D=i.charAt(0);for(var u=l.charCodeAt(z-1),x=1E5,A=!1;u!==D.charCodeAt(0);){if(u++,u===r&&u++,u===q&&u++,u>t){if(A)throw"Bad character: "+D;u=n;A=!0}x+=1E5}D=x;i=i.charAt(1);if("V"<i)throw"MGRSPoint given invalid Northing "+i;z=j.charCodeAt(z-1);u=0;for(x=!1;z!==i.charCodeAt(0);){if(z++,z===r&&z++,z===q&&z++,z>p){if(x)throw"Bad character: "+i;
z=n;x=!0}u+=1E5}for(z=u;z<m(k);)z+=2E6;g-=o;if(0!==g%2)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+b;var F,W,N,S,V,g=g/2,u=i=0;return 0<g&&(F=1E5/Math.pow(10,g),W=b.substring(o,o+g),i=parseFloat(W)*F,N=b.substring(o+g),u=parseFloat(N)*F),S=i+D,V=u+z,{easting:S,northing:V,zoneLetter:k,zoneNumber:c,accuracy:F}}function m(b){var c;switch(b){case "C":c=11E5;break;case "D":c=2E6;
break;case "E":c=28E5;break;case "F":c=37E5;break;case "G":c=46E5;break;case "H":c=55E5;break;case "J":c=64E5;break;case "K":c=73E5;break;case "L":c=82E5;break;case "M":c=91E5;break;case "N":c=0;break;case "P":c=8E5;break;case "Q":c=17E5;break;case "R":c=26E5;break;case "S":c=35E5;break;case "T":c=44E5;break;case "U":c=53E5;break;case "V":c=62E5;break;case "W":c=7E6;break;case "X":c=79E5;break;default:c=-1}if(0<=c)return c;throw"Invalid zone letter: "+b;}var o=6,l="AJSAJS",j="AFAFAF",n=65,r=73,q=
79,p=86,t=90;b.forward=function(b,c){var c=c||5,g,i,k,m,o,D,u=b[1];g=b[0];var x=u*(Math.PI/180),A=g*(Math.PI/180);D=Math.floor((g+180)/6)+1;180===g&&(D=60);56<=u&&64>u&&3<=g&&12>g&&(D=32);72<=u&&84>u&&(0<=g&&9>g?D=31:9<=g&&21>g?D=33:21<=g&&33>g?D=35:33<=g&&42>g&&(D=37));m=(6*(D-1)-180+3)*(Math.PI/180);g=6378137/Math.sqrt(1-0.00669438*Math.sin(x)*Math.sin(x));i=Math.tan(x)*Math.tan(x);k=0.006739496752268451*Math.cos(x)*Math.cos(x);m=Math.cos(x)*(A-m);o=6378137*(0.9983242984503243*x-0.002514607064228144*
Math.sin(2*x)+2.639046602129982E-6*Math.sin(4*x)-3.4180461016968582E-9*Math.sin(6*x));A=0.9996*g*(m+(1-i+k)*m*m*m/6+(5-18*i+i*i+72*k-0.39089081163157013)*m*m*m*m*m/120)+5E5;x=0.9996*(o+g*Math.tan(x)*(m*m/2+(5-i+9*k+4*k*k)*m*m*m*m/24+(61-58*i+i*i+600*k-2.2240339282485886)*m*m*m*m*m*m/720));0>u&&(x+=1E7);i=Math.round(x);k=Math.round(A);A=D;g="Z";u=c;D="00000"+k;x="00000"+i;g=A+g;m=e(A);k=Math.floor(k/1E5);A=Math.floor(i/1E5)%20;m-=1;i=l.charCodeAt(m);m=j.charCodeAt(m);k=i+k-1;A=m+A;o=!1;k>t&&(k=k-t+
n-1,o=!0);(k===r||r>i&&k>r||(k>r||r>i)&&o)&&k++;(k===q||q>i&&k>q||(k>q||q>i)&&o)&&(k++,k===r&&k++);k>t&&(k=k-t+n-1);A>p?(A=A-p+n-1,o=!0):o=!1;(A===r||r>m&&A>r||(A>r||r>m)&&o)&&A++;(A===q||q>m&&A>q||(A>q||q>m)&&o)&&(A++,A===r&&A++);A>p&&(A=A-p+n-1);i=String.fromCharCode(k)+String.fromCharCode(A);return g+i+D.substr(D.length-5,u)+x.substr(x.length-5,u)};b.inverse=function(b){b=k(i(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]};b.toPoint=function(b){b=
k(i(b.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}},{}],68:[function(c,g){g.exports={name:"proj4",version:"2.3.14",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},
author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~12.0.1","grunt-browserify":"~4.0.1","grunt-contrib-uglify":"~0.11.1",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"~0.0.2"}}},{}],"./includedProjections":[function(c,
g){g.exports=c("hTEDpn")},{}],hTEDpn:[function(c,g){var b=[c("./lib/projections/tmerc"),c("./lib/projections/utm"),c("./lib/projections/sterea"),c("./lib/projections/stere"),c("./lib/projections/somerc"),c("./lib/projections/omerc"),c("./lib/projections/lcc"),c("./lib/projections/krovak"),c("./lib/projections/cass"),c("./lib/projections/laea"),c("./lib/projections/aea"),c("./lib/projections/gnom"),c("./lib/projections/cea"),c("./lib/projections/eqc"),c("./lib/projections/poly"),c("./lib/projections/nzmg"),
c("./lib/projections/mill"),c("./lib/projections/sinu"),c("./lib/projections/moll"),c("./lib/projections/eqdc"),c("./lib/projections/vandg"),c("./lib/projections/aeqd")];g.exports=function(c){b.forEach(function(b){c.Proj.projections.add(b)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,"./lib/projections/cass":42,"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/gnom":47,"./lib/projections/krovak":48,"./lib/projections/laea":49,"./lib/projections/lcc":50,
"./lib/projections/mill":53,"./lib/projections/moll":54,"./lib/projections/nzmg":55,"./lib/projections/omerc":56,"./lib/projections/poly":57,"./lib/projections/sinu":58,"./lib/projections/somerc":59,"./lib/projections/stere":60,"./lib/projections/sterea":61,"./lib/projections/tmerc":62,"./lib/projections/utm":63,"./lib/projections/vandg":64}]},{},[36])(36)});(function(f){var c,g;if("function"===typeof define&&define.amd)define(["AIMap","proj4"],f);else if("object"===typeof module&&"object"===typeof module.exports)c=require("AIMap"),g=require("proj4"),module.exports=f(c,g);else{if("undefined"===typeof window.AIMap||"undefined"===typeof window.proj4)throw"AIMap and proj4 must be loaded first";f(window.AIMap,window.proj4)}})(function(f,c){f.Proj={};f.Proj._isProj4Obj=function(c){return"undefined"!==typeof c.inverse&&"undefined"!==typeof c.forward};f.Proj.Projection=
f.Class.extend({initialize:function(c,b,k){var e=f.Proj._isProj4Obj(c);this._proj=e?c:this._projFromCodeDef(c,b);this.bounds=e?b:k},project:function(c){c=this._proj.forward([c.lng,c.lat]);return new f.Point(c[0],c[1])},unproject:function(c,b){var k=this._proj.inverse([c.x,c.y]);return new f.LatLng(k[1],k[0],b)},_projFromCodeDef:function(g,b){if(b)c.defs(g,b);else if(void 0===c.defs[g]){var f=g.split(":");3<f.length&&(g=f[f.length-3]+":"+f[f.length-1]);if(void 0===c.defs[g])throw"No projection definition for code "+
g;}return c(g)}});f.Proj.CRS=f.Class.extend({includes:f.CRS,options:{transformation:new f.Transformation(1,0,-1,0)},initialize:function(c,b,k){var e;f.Proj._isProj4Obj(c)?(e=c.srsCode,k=b||{},this.projection=new f.Proj.Projection(c,k.bounds)):(e=c,k=k||{},this.projection=new f.Proj.Projection(e,b,k.bounds));f.Util.setOptions(this,k);this.code=e;this.transformation=this.options.transformation;this.options.origin&&(this.transformation=new f.Transformation(1,-this.options.origin[0],-1,this.options.origin[1]));
if(this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(c=this.options.resolutions.length-1;0<=c;c--)this.options.resolutions[c]&&(this._scales[c]=1/this.options.resolutions[c])}this.infinite=!this.options.bounds},scale:function(c){var b=Math.floor(c),f;if(c===b)return this._scales[c];f=this._scales[b];return f+(this._scales[b+1]-f)*(c-b)},zoom:function(c){var b=this._closestElement(this._scales,c),f=this._scales.indexOf(b),e;if(c===b)return f;
e=this._scales[f+1];return void 0===e?Infinity:(c-b)/(e-b)+f},distance:f.CRS.Earth.distance,R:f.CRS.Earth.R,_closestElement:function(c,b){for(var f,e=c.length;e--;)if(c[e]<=b&&(void 0===f||f<c[e]))f=c[e];return f}});f.Proj.GeoJSON=f.GeoJSON.extend({initialize:function(c,b){this._callLevel=0;f.GeoJSON.prototype.initialize.call(this,c,b)},addData:function(c){var b;c&&(c.crs&&"name"===c.crs.type?b=new f.Proj.CRS(c.crs.properties.name):c.crs&&c.crs.type&&(b=new f.Proj.CRS(c.crs.type+":"+c.crs.properties.code)),
void 0!==b&&(this.options.coordsToLatLng=function(c){c=f.point(c[0],c[1]);return b.projection.unproject(c)}));this._callLevel++;try{f.GeoJSON.prototype.addData.call(this,c)}finally{this._callLevel--,0===this._callLevel&&delete this.options.coordsToLatLng}}});f.Proj.geoJson=function(c,b){return new f.Proj.GeoJSON(c,b)};f.Proj.ImageOverlay=f.ImageOverlay.extend({initialize:function(c,b,k){f.ImageOverlay.prototype.initialize.call(this,c,null,k);this._projectedBounds=b},_animateZoom:function(c){var b=
this._map.getZoomScale(c.zoom),c=this._projectedToNewLayerPoint(f.point(this._projectedBounds.min.x,this._projectedBounds.max.y),c.zoom,c.center);f.DomUtil.setTransform(this._image,c,b)},_reset:function(){var c=this._map.getZoom(),b=this._map.getPixelOrigin(),c=f.bounds(this._transform(this._projectedBounds.min,c)._subtract(b),this._transform(this._projectedBounds.max,c)._subtract(b)),b=c.getSize();f.DomUtil.setPosition(this._image,c.min);this._image.style.width=b.x+"px";this._image.style.height=
b.y+"px"},_projectedToNewLayerPoint:function(c,b,f){var e=this._map.getSize()._divideBy(2),f=this._map.project(f,b)._subtract(e)._round().add(this._map._getMapPanePos());return this._transform(c,b)._subtract(f)},_transform:function(c,b){var f=this._map.options.crs,e=f.transformation,f=f.scale(b);return e.transform(c,f)}});f.Proj.imageOverlay=function(c,b,k){return new f.Proj.ImageOverlay(c,b,k)};return f.Proj});AIMap.TileLayer.ArcGIS=AIMap.TileLayer.extend({options:{continuousWorld:!0,tileSize:256,tileOrigin:null,resolutions:[],maxExtent:null},_adjustTilePoint:function(){},_tileShouldBeLoaded:function(f){return f.x+":"+f.y in this._tiles?!1:this._IsInMapExtent(this.getTileBound(f))},_IsInMapExtent:function(f){var c=this.options.maxExtent;return null==c||c.contains(f)||c.intersects(f)?!0:!1},getTileBound:function(f){var c=this._map,g=this._level.zoom,b=this.options.tileSize,k=c.options.crs,f=f.multiplyBy(b),
b=f.add(new AIMap.Point(b,b)),f=k.project(c.unproject(f,g)),c=k.project(c.unproject(b,g));return new AIMap.Bounds(f,c)},getTileUrl:function(f,c){var c=this._level.zoom,g=this.getTileBound(f).getCenter(!1),b=Math.floor((g.x-this.options.tileOrigin.x)/(this.options.tileSize*this.options.resolutions[c]));return this._url+(10>c?"L0"+c+"/":"L"+c+"/")+"R"+this.zeroPad(Math.floor((this.options.tileOrigin.y-g.y)/(this.options.tileSize*this.options.resolutions[c])),8,16)+"/C"+this.zeroPad(b,8,16)+"."+this.options.format},
zeroPad:function(f,c,g){for(f=f.toString(g||10);f.length<c;)f="0"+f;return f}});AIMap.tileLayer.arcgis=function(f,c){return new AIMap.TileLayer.ArcGIS(f,c)};(function(){AIMap.PolylineDraw=AIMap.Polyline.extend({});AIMap.PolygonDraw=AIMap.Polygon.extend({});AIMap.HandlerDraw=AIMap.Handler.extend({});AIMap.ControlDraw=AIMap.Control.extend({});AIMap.Util.extend(AIMap.LineUtil,{segmentsIntersect:function(f,c,g,b){return this._checkCounterclockwise(f,g,b)!==this._checkCounterclockwise(c,g,b)&&PolylineDraw},_checkCounterclockwise:function(f,c,g){return(g.y-f.y)*(c.x-f.x)>(c.y-f.y)*(g.x-f.x)}});AIMap.PolylineDraw.include({intersects:function(){var f=this._originalPoints,
c=f?f.length:0,g,b;if(this._tooFewPointsForIntersection())return!1;for(c-=1;3<=c;c--)if(g=f[c-1],b=f[c],this._lineSegmentsIntersectsRange(g,b,c-2))return!0;return!1},newLatLngIntersects:function(f){return!this._map?!1:this.newPointIntersects(this._map.latLngToLayerPoint(f))},newPointIntersects:function(f){var c=this._originalPoints,g=c?c.length:0,c=c?c[g-1]:null,g=g-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(c,f,g)},_tooFewPointsForIntersection:function(f){var c=
this._originalPoints,c=c?c.length:0;return!this._originalPoints||3>=c+(f||0)},_lineSegmentsIntersectsRange:function(f,c,g,b){for(var k=this._originalPoints,e,b=b||0,i=g;i>b;i--)if(g=k[i-1],e=k[i],AIMap.LineUtil.segmentsIntersect(f,c,g,e))return!0;return!1}});AIMap.PolygonDraw.include({intersects:function(){var f=this._originalPoints,c;if(this._tooFewPointsForIntersection())return!1;if(AIMap.PolylineDraw.prototype.intersects.call(this))return!0;c=f.length;return this._lineSegmentsIntersectsRange(f[c-
1],f[0],c-2,1)}});AIMap.HandlerDraw.Draw=AIMap.Handler.extend({includes:AIMap.Mixin.Events,initialize:function(f,c){this._map=f;this._container=f._container;this._pane=f._panes.overlayPane;c&&c.shapeOptions&&(c.shapeOptions=AIMap.Util.extend({},this.options.shapeOptions,c.shapeOptions));AIMap.Util.extend(this.options,c)},enable:function(){this.fire("activated");AIMap.Handler.prototype.enable.call(this)},addHooks:function(){this._map&&(AIMap.DomUtil.disableTextSelection(),this._label=AIMap.DomUtil.create("div",
"aimap-draw-label",this._pane),this._singleLineLabel=!1,AIMap.DomEvent.addListener(window,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(AIMap.DomUtil.enableTextSelection(),this._pane.removeChild(this._label),delete this._label,AIMap.DomEvent.removeListener(window,"keyup",this._cancelDrawing))},_updateLabelText:function(f){f.subtext=f.subtext||"";0===f.subtext.length&&!this._singleLineLabel?(AIMap.DomUtil.addClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=
!0):0<f.subtext.length&&this._singleLineLabel&&(AIMap.DomUtil.removeClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=!1);this._label.innerHTML=(0<f.subtext.length?'<span class="aimap-draw-label-subtext">'+f.subtext+"</span><br />":"")+"<span>"+f.text+"</span>"},_updateLabelPosition:function(f){AIMap.DomUtil.setPosition(this._label,f)},_cancelDrawing:function(f){27===f.keyCode&&this.disable()}});AIMap.PolylineDraw.Draw=AIMap.HandlerDraw.Draw.extend({Poly:AIMap.PolylineDraw,options:{allowIntersection:!0,
drawError:{color:"#b00b00",message:"<strong>\u9519\u8bef:</strong> \u56fe\u5f62\u8fb9\u7f18\u4e0d\u80fd\u76f8\u4ea4!",timeout:2500},icon:new AIMap.DivIcon({iconSize:new AIMap.Point(8,8),className:"aimap-div-icon aimap-editing-icon"}),guidelineDistance:20,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!1,clickable:!0}},initialize:function(f,c){c&&c.drawError&&(c.drawError=AIMap.Util.extend({},this.options.drawError,c.drawError));AIMap.HandlerDraw.Draw.prototype.initialize.call(this,
f,c)},addHooks:function(){AIMap.HandlerDraw.Draw.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new AIMap.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new AIMap.PolylineDraw([],this.options.shapeOptions),this._container.style.cursor="crosshair",this._updateLabelText(this._getLabelText()),this._map.on("mousemove",this._onMouseMove,this).on("click",this._onClick,this))},removeHooks:function(){AIMap.HandlerDraw.Draw.prototype.removeHooks.call(this);this._clearHideErrorTimeout();
this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._clearGuides();this._container.style.cursor="";this._map.off("mousemove",this._onMouseMove).off("click",this._onClick)},_finishShape:function(){this._map.fire("mydraw_huizhi:poly-created",{poly:new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions),dataLabel:this._getLabelText().subtext});this.disable()},_onMouseMove:function(f){var c=
f.layerPoint,g=this._markers.length;this._currentLatLng=f.latlng;this._updateLabelPosition(c);0<g&&(this._updateLabelText(this._getLabelText()),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[g-1].getLatLng()),c));AIMap.DomEvent.preventDefault(f)},_onClick:function(f){f=f.latlng;0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(f)?this._showErrorLabel():(this._errorShown&&this._hideErrorLabel(),this._markers.push(this._createMarker(f)),
this._poly.addLatLng(f),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._updateMarkerHandler(),this._vertexAdded(f))},_updateMarkerHandler:function(){if(1<this._markers.length)this._markers[this._markers.length-1].on("click",this._finishShape,this);2<this._markers.length&&this._markers[this._markers.length-2].off("click",this._finishShape)},_createMarker:function(f){f=new AIMap.Marker(f,{icon:this.options.icon});this._markerGroup.addLayer(f);return f},_drawGuide:function(f,
c){var g=Math.floor(Math.sqrt(Math.pow(c.x-f.x,2)+Math.pow(c.y-f.y,2))),b,k,e;this._guidesContainer||(this._guidesContainer=AIMap.DomUtil.create("div","aimap-draw-guides",this._pane));for(b=this.options.guidelineDistance;b<g;b+=this.options.guidelineDistance)k=b/g,k={x:Math.floor(f.x*(1-k)+k*c.x),y:Math.floor(f.y*(1-k)+k*c.y)},e=AIMap.DomUtil.create("div","aimap-draw-guide-dash",this._guidesContainer),e.style.backgroundColor=!this._errorShown?this.options.shapeOptions.color:this.options.drawError.color,
AIMap.DomUtil.setPosition(e,k)},_updateGuideColor:function(f){if(this._guidesContainer)for(var c=0,g=this._guidesContainer.childNodes.length;c<g;c++)this._guidesContainer.childNodes[c].style.backgroundColor=f},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_updateLabelText:function(f){this._errorShown||AIMap.HandlerDraw.Draw.prototype._updateLabelText.call(this,f)},_getLabelText:function(){return 0===
this._markers.length?{text:"\u5355\u51fb\u5f00\u753b\u7ebf."}:1===this._markers.length?{text:"\u5355\u51fb\u7ee7\u7eed.",subtext:""}:{text:"\u5355\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u7ed3\u675f.",subtext:""}},_showErrorLabel:function(){this._errorShown=!0;AIMap.DomUtil.addClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.addClass(this._label,"aimap-flash-anim");AIMap.HandlerDraw.Draw.prototype._updateLabelText.call(this,{text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);
this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(AIMap.Util.bind(this._hideErrorLabel,this),this.options.drawError.timeout)},_hideErrorLabel:function(){this._errorShown=!1;this._clearHideErrorTimeout();AIMap.DomUtil.removeClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.removeClass(this._label,"aimap-flash-anim");this._updateLabelText(this._getLabelText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},
_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_vertexAdded:function(){this._measurementRunningTotal=0},_cleanUpShape:function(){0<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape)}});AIMap.PolygonDraw.Draw=AIMap.PolylineDraw.Draw.extend({Poly:AIMap.PolygonDraw,options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0}},
_updateMarkerHandler:function(){if(1===this._markers.length)this._markers[0].on("click",this._finishShape,this)},_getLabelText:function(){return 0===this._markers.length?{text:"\u70b9\u51fb\u5730\u56fe\u5f00\u59cb\u6807\u7ed8"}:3>this._markers.length?{text:"\u70b9\u51fb\u5730\u56fe\u7ee7\u7eed\u6807\u7ed8",subtext:""}:{text:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u9876\u70b9\u7ed3\u675f\u6807\u7ed8",subtext:""}},_vertexAdded:function(){this._measurementAreaTotal=this._measurementRunningTotal=0},_cleanUpShape:function(){0<
this._markers.length&&this._markers[0].off("click",this._finishShape)}});AIMap.Map.mergeOptions({drawControl:!1});AIMap.ControlDraw.Draw=AIMap.Control.extend({options:{position:"topleft",polyline:{},polygon:{}},handlers:{},onAdd:function(f){var c=AIMap.DomUtil.create("div","aimap-controlm-draw");this.options.polyline&&(this.handlers.polyline=new AIMap.PolylineDraw.Draw(f,this.options.polyline),this._createButton("\u753b\u7ebf","aimap-controlm-draw-polyline",c,this.handlers.polyline.enable,this.handlers.polyline),
this.handlers.polyline.on("activated",this._disableInactiveModes,this));this.options.polygon&&(this.handlers.polygon=new AIMap.PolygonDraw.Draw(f,this.options.polygon),this._createButton("\u591a\u8fb9\u5f62","aimap-controlm-draw-polygon",c,this.handlers.polygon.enable,this.handlers.polygon),this.handlers.polygon.on("activated",this._disableInactiveModes,this));return c},_createButton:function(f,c,g,b,k){c=AIMap.DomUtil.create("a",c,g);c.href="#";c.title=f;AIMap.DomEvent.addListener(c,"click",AIMap.DomEvent.stopPropagation).addListener(c,
"click",AIMap.DomEvent.preventDefault).addListener(c,"click",b,k);return c},_disableInactiveModes:function(){for(var f in this.handlers)this.handlers.hasOwnProperty(f)&&this.handlers[f].enabled&&this.handlers[f].disable()}});AIMap.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new AIMap.ControlDraw.Draw,this.addControl(this.drawControl))})})();(function(){AIMap.Polylinep=AIMap.Polyline.extend({});AIMap.Polygonp=AIMap.Polygon.extend({});AIMap.Handlerp=AIMap.Handler.extend({});AIMap.Controlp=AIMap.Control.extend({});AIMap.Util.extend(AIMap.LineUtil,{segmentsIntersect:function(f,c,g,b){return this._checkCounterclockwise(f,g,b)!==this._checkCounterclockwise(c,g,b)&&Polylinep},_checkCounterclockwise:function(f,c,g){return(g.y-f.y)*(c.x-f.x)>(c.y-f.y)*(g.x-f.x)}});AIMap.Polylinep.include({intersects:function(){var f=this._originalPoints,c=f?
f.length:0,g,b;if(this._tooFewPointsForIntersection())return!1;for(c-=1;3<=c;c--)if(g=f[c-1],b=f[c],this._lineSegmentsIntersectsRange(g,b,c-2))return!0;return!1},newLatLngIntersects:function(f){return!this._map?!1:this.newPointIntersects(this._map.latLngToLayerPoint(f))},newPointIntersects:function(f){var c=this._originalPoints,g=c?c.length:0,c=c?c[g-1]:null,g=g-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(c,f,g)},_tooFewPointsForIntersection:function(f){var c=
this._originalPoints,c=c?c.length:0;return!this._originalPoints||3>=c+(f||0)},_lineSegmentsIntersectsRange:function(f,c,g,b){for(var k=this._originalPoints,e,b=b||0,i=g;i>b;i--)if(g=k[i-1],e=k[i],AIMap.LineUtil.segmentsIntersect(f,c,g,e))return!0;return!1}});AIMap.Polygonp.include({intersects:function(){var f=this._originalPoints,c;if(this._tooFewPointsForIntersection())return!1;if(AIMap.Polylinep.prototype.intersects.call(this))return!0;c=f.length;return this._lineSegmentsIntersectsRange(f[c-1],
f[0],c-2,1)}});AIMap.Handlerp.Draw=AIMap.Handler.extend({includes:AIMap.Mixin.Events,initialize:function(f,c){this._map=f;this._container=f._container;this._pane=f._panes.overlayPane;c&&c.shapeOptions&&(c.shapeOptions=AIMap.Util.extend({},this.options.shapeOptions,c.shapeOptions));AIMap.Util.extend(this.options,c)},enable:function(){this.fire("activated");AIMap.Handler.prototype.enable.call(this)},addHooks:function(){this._map&&(AIMap.DomUtil.disableTextSelection(),this._label=AIMap.DomUtil.create("div",
"aimap-draw-label",this._pane),this._singleLineLabel=!1,AIMap.DomEvent.addListener(window,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(AIMap.DomUtil.enableTextSelection(),this._pane.removeChild(this._label),delete this._label,AIMap.DomEvent.removeListener(window,"keyup",this._cancelDrawing))},_updateLabelText:function(f){f.subtext=f.subtext||"";0===f.subtext.length&&!this._singleLineLabel?(AIMap.DomUtil.addClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=
!0):0<f.subtext.length&&this._singleLineLabel&&(AIMap.DomUtil.removeClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=!1);this._label.innerHTML=(0<f.subtext.length?'<span class="aimap-draw-label-subtext">'+f.subtext+"</span><br />":"")+"<span>"+f.text+"</span>"},_updateLabelPosition:function(f){AIMap.DomUtil.setPosition(this._label,f)},_cancelDrawing:function(f){27===f.keyCode&&this.disable()}});AIMap.Polylinep.Draw=AIMap.Handlerp.Draw.extend({Poly:AIMap.Polylinep,options:{allowIntersection:!0,
drawError:{color:"#b00b00",message:"<strong>\u9519\u8bef:</strong> \u56fe\u5f62\u8fb9\u7f18\u4e0d\u80fd\u76f8\u4ea4!",timeout:2500},icon:new AIMap.DivIcon({iconSize:new AIMap.Point(8,8),className:"aimap-div-icon aimap-editing-icon"}),guidelineDistance:20,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!1,clickable:!0}},initialize:function(f,c){c&&c.drawError&&(c.drawError=AIMap.Util.extend({},this.options.drawError,c.drawError));AIMap.Handlerp.Draw.prototype.initialize.call(this,
f,c)},addHooks:function(){AIMap.Handlerp.Draw.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new AIMap.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new AIMap.Polylinep([],this.options.shapeOptions),this._container.style.cursor="crosshair",this._updateLabelText(this._getLabelText()),this._map.on("mousemove",this._onMouseMove,this).on("click",this._onClick,this))},removeHooks:function(){AIMap.Handlerp.Draw.prototype.removeHooks.call(this);this._clearHideErrorTimeout();
this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._clearGuides();this._container.style.cursor="";this._map.off("mousemove").off("click")},_finishShape:function(){this._poly&&(this._map.fire("mydraw:poly-created",{poly:new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions),dataLabel:this._getLabelText().subtext}),this.disable())},_onMouseMove:function(f){var c=f.layerPoint,g=
this._markers.length;this._currentLatLng=f.latlng;this._updateLabelPosition(c);0<g&&(this._updateLabelText(this._getLabelText()),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[g-1].getLatLng()),c));AIMap.DomEvent.preventDefault(f)},_onClick:function(f){f=f.latlng;0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(f)?this._showErrorLabel():(this._errorShown&&this._hideErrorLabel(),this._markers.push(this._createMarker(f)),this._poly.addLatLng(f),
2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._updateMarkerHandler(),this._vertexAdded(f))},_updateMarkerHandler:function(){if(1<this._markers.length)this._markers[this._markers.length-1].on("click",this._finishShape,this);2<this._markers.length&&this._markers[this._markers.length-2].off("click",this._finishShape)},_createMarker:function(f){f=new AIMap.Marker(f,{icon:this.options.icon});this._markerGroup.addLayer(f);return f},_drawGuide:function(f,c){var g=Math.floor(Math.sqrt(Math.pow(c.x-
f.x,2)+Math.pow(c.y-f.y,2))),b,k,e;this._guidesContainer||(this._guidesContainer=AIMap.DomUtil.create("div","aimap-draw-guides",this._pane));for(b=this.options.guidelineDistance;b<g;b+=this.options.guidelineDistance)k=b/g,k={x:Math.floor(f.x*(1-k)+k*c.x),y:Math.floor(f.y*(1-k)+k*c.y)},e=AIMap.DomUtil.create("div","aimap-draw-guide-dash",this._guidesContainer),e.style.backgroundColor=!this._errorShown?this.options.shapeOptions.color:this.options.drawError.color,AIMap.DomUtil.setPosition(e,k)},_updateGuideColor:function(f){if(this._guidesContainer)for(var c=
0,g=this._guidesContainer.childNodes.length;c<g;c++)this._guidesContainer.childNodes[c].style.backgroundColor=f},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_updateLabelText:function(f){this._errorShown||AIMap.Handlerp.Draw.prototype._updateLabelText.call(this,f)},_getLabelText:function(){return 0===this._markers.length?{text:"\u5355\u51fb\u5f00\u753b\u7ebf."}:1===this._markers.length?
{text:"\u5355\u51fb\u7ee7\u7eed.",subtext:""}:{text:"\u5355\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u7ed3\u675f.",subtext:""}},_showErrorLabel:function(){this._errorShown=!0;AIMap.DomUtil.addClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.addClass(this._label,"aimap-flash-anim");AIMap.Handlerp.Draw.prototype._updateLabelText.call(this,{text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();
this._hideErrorTimeout=setTimeout(AIMap.Util.bind(this._hideErrorLabel,this),this.options.drawError.timeout)},_hideErrorLabel:function(){this._errorShown=!1;this._clearHideErrorTimeout();AIMap.DomUtil.removeClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.removeClass(this._label,"aimap-flash-anim");this._updateLabelText(this._getLabelText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&
(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_vertexAdded:function(){this._measurementRunningTotal=0},_cleanUpShape:function(){0<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape)}});AIMap.Polygonp.Draw=AIMap.Polylinep.Draw.extend({Poly:AIMap.Polygonp,options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0}},_updateMarkerHandler:function(){if(1===this._markers.length)this._markers[0].on("click",
this._finishShape,this)},_getLabelText:function(){return 0===this._markers.length?{text:"\u70b9\u51fb\u5730\u56fe\u5f00\u59cb\u753b\u9762"}:3>this._markers.length?{text:"\u70b9\u51fb\u5730\u56fe\u753b\u9762",subtext:""}:{text:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u9876\u70b9\u7ed3\u753b\u9762",subtext:""}},_vertexAdded:function(){this._measurementAreaTotal=this._measurementRunningTotal=0},_cleanUpShape:function(){0<this._markers.length&&this._markers[0].off("click",this._finishShape)}});AIMap.Map.mergeOptions({drawControl:!1});
AIMap.Controlp.Draw=AIMap.Control.extend({options:{position:"topleft",polyline:{},polygon:{}},handlers:{},onAdd:function(f){var c=AIMap.DomUtil.create("div","aimap-controlm-draw");this.options.polyline&&(this.handlers.polyline=new AIMap.Polylinep.Draw(f,this.options.polyline),this._createButton("\u753b\u7ebf","aimap-controlm-draw-polyline",c,this.handlers.polyline.enable,this.handlers.polyline),this.handlers.polyline.on("activated",this._disableInactiveModes,this));this.options.polygon&&(this.handlers.polygon=
new AIMap.Polygonp.Draw(f,this.options.polygon),this._createButton("\u591a\u8fb9\u5f62","aimap-controlm-draw-polygon",c,this.handlers.polygon.enable,this.handlers.polygon),this.handlers.polygon.on("activated",this._disableInactiveModes,this));return c},_createButton:function(f,c,g,b,k){c=AIMap.DomUtil.create("a",c,g);c.href="#";c.title=f;AIMap.DomEvent.addListener(c,"click",AIMap.DomEvent.stopPropagation).addListener(c,"click",AIMap.DomEvent.preventDefault).addListener(c,"click",b,k);return c},_disableInactiveModes:function(){for(var f in this.handlers)this.handlers.hasOwnProperty(f)&&
this.handlers[f].enabled&&this.handlers[f].disable()}});AIMap.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new AIMap.Controlp.Draw,this.addControl(this.drawControl))})})();(function(){AIMap.Util.extend(AIMap.LineUtil,{segmentsIntersect:function(f,c,g,b){return this._checkCounterclockwise(f,g,b)!==this._checkCounterclockwise(c,g,b)&&this._checkCounterclockwise(f,c,g)!==this._checkCounterclockwise(f,c,b)},_checkCounterclockwise:function(f,c,g){return(g.y-f.y)*(c.x-f.x)>(c.y-f.y)*(g.x-f.x)}});AIMap.Polyline.include({intersects:function(){var f=this._originalPoints,c=f?f.length:0,g,b;if(this._tooFewPointsForIntersection())return!1;for(c-=1;3<=c;c--)if(g=f[c-1],b=f[c],this._lineSegmentsIntersectsRange(g,
b,c-2))return!0;return!1},newLatLngIntersects:function(f){return!this._map?!1:this.newPointIntersects(this._map.latLngToLayerPoint(f))},newPointIntersects:function(f){var c=this._originalPoints,g=c?c.length:0,c=c?c[g-1]:null,g=g-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(c,f,g)},_tooFewPointsForIntersection:function(f){var c=this._originalPoints,c=c?c.length:0;return!this._originalPoints||3>=c+(f||0)},_lineSegmentsIntersectsRange:function(f,c,g,b){for(var k=
this._originalPoints,e,b=b||0,i=g;i>b;i--)if(g=k[i-1],e=k[i],AIMap.LineUtil.segmentsIntersect(f,c,g,e))return!0;return!1}});AIMap.Polygon.include({intersects:function(){var f=this._originalPoints,c;if(this._tooFewPointsForIntersection())return!1;if(AIMap.Polyline.prototype.intersects.call(this))return!0;c=f.length;return this._lineSegmentsIntersectsRange(f[c-1],f[0],c-2,1)}});AIMap.Handler.Draw=AIMap.Handler.extend({includes:AIMap.Mixin.Events,initialize:function(f,c){this._map=f;this._container=
f._container;this._pane=f._panes.overlayPane;c&&c.shapeOptions&&(c.shapeOptions=AIMap.Util.extend({},this.options.shapeOptions,c.shapeOptions));AIMap.Util.extend(this.options,c)},enable:function(){this.fire("activated");AIMap.Handler.prototype.enable.call(this)},addHooks:function(){this._map&&(AIMap.DomUtil.disableTextSelection(),this._label=AIMap.DomUtil.create("div","aimap-draw-label",this._pane),this._singleLineLabel=!1,AIMap.DomEvent.addListener(window,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&
(AIMap.DomUtil.enableTextSelection(),this._pane.removeChild(this._label),delete this._label,AIMap.DomEvent.removeListener(window,"keyup",this._cancelDrawing))},_updateLabelText:function(f){f.subtext=f.subtext||"";0===f.subtext.length&&!this._singleLineLabel?(AIMap.DomUtil.addClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=!0):0<f.subtext.length&&this._singleLineLabel&&(AIMap.DomUtil.removeClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=!1);this._label.innerHTML=
(0<f.subtext.length?'<span class="aimap-draw-label-subtext">'+f.subtext+"</span><br />":"")+"<span>"+f.text+"</span>"},_updateLabelPosition:function(f){AIMap.DomUtil.setPosition(this._label,f)},_cancelDrawing:function(f){27===f.keyCode&&this.disable()}});AIMap.Polyline.Draw=AIMap.Handler.Draw.extend({Poly:AIMap.Polyline,options:{allowIntersection:!0,drawError:{color:"#b00b00",message:"<strong>\u9519\u8bef:</strong> \u56fe\u5f62\u8fb9\u7f18\u4e0d\u80fd\u76f8\u4ea4!",timeout:2500},icon:new AIMap.DivIcon({iconSize:new AIMap.Point(8,
8),className:"aimap-div-icon aimap-editing-icon"}),guidelineDistance:20,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!1,clickable:!0}},initialize:function(f,c){c&&c.drawError&&(c.drawError=AIMap.Util.extend({},this.options.drawError,c.drawError));AIMap.Handler.Draw.prototype.initialize.call(this,f,c)},addHooks:function(){AIMap.Handler.Draw.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new AIMap.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=
new AIMap.Polyline([],this.options.shapeOptions),this._container.style.cursor="crosshair",this._updateLabelText(this._getLabelText()),this._map.on("mousemove",this._onMouseMove,this).on("click",this._onClick,this))},removeHooks:function(){AIMap.Handler.Draw.prototype.removeHooks.call(this);this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;delete this._markers;this._map.removeLayer(this._poly);delete this._poly;this._clearGuides();
this._container.style.cursor="";this._map.off("mousemove",this._onMouseMove).off("click",this._onClick)},_finishShape:function(){this._map.fire("draw:poly-created",{poly:new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions),dataLabel:this._getLabelText().subtext});this.disable()},_onMouseMove:function(f){var c=f.layerPoint,g=this._markers.length;this._currentLatLng=f.latlng;this._updateLabelPosition(c);0<g&&(this._updateLabelText(this._getLabelText()),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[g-
1].getLatLng()),c));AIMap.DomEvent.preventDefault(f)},_onClick:function(f){f=f.latlng;0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(f)?this._showErrorLabel():(this._errorShown&&this._hideErrorLabel(),this._markers.push(this._createMarker(f)),this._poly.addLatLng(f),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._updateMarkerHandler(),this._vertexAdded(f))},_updateMarkerHandler:function(){if(1<this._markers.length)this._markers[this._markers.length-
1].on("click",this._finishShape,this);2<this._markers.length&&this._markers[this._markers.length-2].off("click",this._finishShape)},_createMarker:function(f){f=new AIMap.Marker(f,{icon:this.options.icon});this._markerGroup.addLayer(f);return f},_drawGuide:function(f,c){var g=Math.floor(Math.sqrt(Math.pow(c.x-f.x,2)+Math.pow(c.y-f.y,2))),b,k,e;this._guidesContainer||(this._guidesContainer=AIMap.DomUtil.create("div","aimap-draw-guides",this._pane));for(b=this.options.guidelineDistance;b<g;b+=this.options.guidelineDistance)k=
b/g,k={x:Math.floor(f.x*(1-k)+k*c.x),y:Math.floor(f.y*(1-k)+k*c.y)},e=AIMap.DomUtil.create("div","aimap-draw-guide-dash",this._guidesContainer),e.style.backgroundColor=!this._errorShown?this.options.shapeOptions.color:this.options.drawError.color,AIMap.DomUtil.setPosition(e,k)},_updateGuideColor:function(f){if(this._guidesContainer)for(var c=0,g=this._guidesContainer.childNodes.length;c<g;c++)this._guidesContainer.childNodes[c].style.backgroundColor=f},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},
_updateLabelText:function(f){this._errorShown||AIMap.Handler.Draw.prototype._updateLabelText.call(this,f)},_getLabelText:function(){var f;0===this._markers.length?f={text:"\u5355\u51fb\u5f00\u6d4b\u8ddd."}:(f=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?this._measurementRunningTotal+this._currentLatLng.distance80To(this._markers[this._markers.length-1].getLatLng()):this._measurementRunningTotal+this._currentLatLng.distanceTo(this._markers[this._markers.length-1].getLatLng()),f=1E3<f?
(f/1E3).toFixed(2)+" km":Math.ceil(f)+" m",f="\u8ddd\u79bb\uff1a"+f,f=1===this._markers.length?{text:"\u5355\u51fb\u7ee7\u7eed\u6d4b\u8ddd.",subtext:f}:{text:"\u5355\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u7ed3\u675f\u6d4b\u8ddd.",subtext:f});return f},_showErrorLabel:function(){this._errorShown=!0;AIMap.DomUtil.addClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.addClass(this._label,"aimap-flash-anim");AIMap.Handler.Draw.prototype._updateLabelText.call(this,{text:this.options.drawError.message});
this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();this._hideErrorTimeout=setTimeout(AIMap.Util.bind(this._hideErrorLabel,this),this.options.drawError.timeout)},_hideErrorLabel:function(){this._errorShown=!1;this._clearHideErrorTimeout();AIMap.DomUtil.removeClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.removeClass(this._label,"aimap-flash-anim");this._updateLabelText(this._getLabelText());this._updateGuideColor(this.options.shapeOptions.color);
this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_vertexAdded:function(f){this._measurementRunningTotal=1===this._markers.length?0:180<this._currentLatLng.lat||-180>this._currentLatLng.lat?this._measurementRunningTotal+f.distance80To(this._markers[this._markers.length-2].getLatLng()):this._measurementRunningTotal+f.distanceTo(this._markers[this._markers.length-
2].getLatLng())},_cleanUpShape:function(){0<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape)}});AIMap.Polygon.Draw=AIMap.Polyline.Draw.extend({Poly:AIMap.Polygon,options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0}},_updateMarkerHandler:function(){if(1===this._markers.length)this._markers[0].on("click",this._finishShape,this)},_getLabelText:function(){var f,c;0===this._markers.length?f=
{text:"\u70b9\u51fb\u5730\u56fe\u5f00\u59cb\u6d4b\u9762"}:(f=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?this._measurementRunningTotal+this._currentLatLng.distanceTo(this._markers[this._markers.length-1].getLatLng()):this._measurementRunningTotal+this._currentLatLng.distance80To(this._markers[this._markers.length-1].getLatLng()),f=1E3<f?(f/1E3).toFixed(2)+" \u5343\u7c73":Math.ceil(f)+" \u7c73",3>this._markers.length?f={text:"\u70b9\u51fb\u5730\u56fe\u9762\u79ef\u91cf\u7b97",subtext:"\u5468\u957f\uff1a"+
f}:(c=this._measurementAreaTotal,c=1E6<c?(c/1E6).toFixed(2)+" \u5e73\u65b9\u5343\u7c73":Math.ceil(c)+" \u5e73\u65b9\u7c73",f={text:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u9876\u70b9\u7ed3\u675f\u9762\u79ef\u91cf\u7b97",subtext:"\u5468\u957f\uff1a"+f+"      \u9762\u79ef\uff1a"+c}));return f},_vertexAdded:function(f){if(1===this._markers.length)this._measurementAreaTotal=this._measurementRunningTotal=0;else{if(3>this._markers.length)this._measurementAreaTotal=0;else{var c=0,g=this._markers.length;if(3>g)return c;
for(var c=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?c+this._markers[0].getLatLng().lat*(this._markers[g-1].getLatLng().lng-this._markers[1].getLatLng().lng):c+1.2364299608417315E10*this._markers[0].getLatLng().lat*(this._markers[g-1].getLatLng().lng-this._markers[1].getLatLng().lng),b=1;b<g;b++)c=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?c+this._markers[b].getLatLng().lat*(this._markers[b-1].getLatLng().lng-this._markers[(b+1)%g].getLatLng().lng):c+1.2364299608417315E10*
this._markers[b].getLatLng().lat*(this._markers[b-1].getLatLng().lng-this._markers[(b+1)%g].getLatLng().lng);area=-c/2;this._measurementAreaTotal=Math.abs(area)}this._measurementRunningTotal=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?this._measurementRunningTotal+f.distance80To(this._markers[this._markers.length-2].getLatLng()):this._measurementRunningTotal+f.distanceTo(this._markers[this._markers.length-2].getLatLng())}},_cleanUpShape:function(){0<this._markers.length&&this._markers[0].off("click",
this._finishShape)}});AIMap.SimpleShape={};AIMap.SimpleShape.Draw=AIMap.Handler.Draw.extend({addHooks:function(){AIMap.Handler.Draw.prototype.addHooks.call(this);this._map&&(this._map.dragging.disable(),this._container.style.cursor="crosshair",this._updateLabelText({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this))},removeHooks:function(){AIMap.Handler.Draw.prototype.removeHooks.call(this);this._map&&(this._map.dragging.enable(),
this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this),AIMap.DomEvent.off(document,"mouseup",this._onMouseUp),this._shape&&(this._map.removeLayer(this._shape),delete this._shape));this._isDrawing=!1},_onMouseDown:function(f){this._isDrawing=!0;this._startLatLng=f.latlng;this._updateLabelText({text:"\u91ca\u653e\u9f20\u6807\u7ed3\u675f\u7ed8\u56fe."});AIMap.DomEvent.on(document,"mouseup",this._onMouseUp,this).preventDefault(f)},_onMouseMove:function(f){var c=
f.layerPoint,f=f.latlng;this._updateLabelPosition(c);this._isDrawing&&(this._updateLabelPosition(c),this._drawShape(f))},_onMouseUp:function(){this._fireCreatedEvent();this.disable()}});AIMap.Circle.Draw=AIMap.SimpleShape.Draw.extend({options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0}},_initialLabelText:"\u70b9\u51fb\u6216\u62d6\u62fd\u753b\u5706.",_drawShape:function(f){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(f)):
(this._shape=new AIMap.Circle(this._startLatLng,this._startLatLng.distanceTo(f),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){this._shape&&this._map.fire("draw:circle-created",{circ:new AIMap.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions)})}});AIMap.Rectangle.Draw=AIMap.SimpleShape.Draw.extend({options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0}},_initialLabelText:"\u70b9\u51fb\u6216\u62d6\u62fd\u753b\u77e9\u5f62.",
_drawShape:function(f){this._shape?this._shape.setBounds(new AIMap.LatLngBounds(this._startLatLng,f)):(this._shape=new AIMap.Rectangle(new AIMap.LatLngBounds(this._startLatLng,f),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){this._shape&&this._map.fire("draw:rectangle-created",{rect:new AIMap.Rectangle(this._shape.getBounds(),this.options.shapeOptions)})}});AIMap.Marker.Draw=AIMap.Handler.Draw.extend({options:{icon:new AIMap.Icon.Default},addHooks:function(){AIMap.Handler.Draw.prototype.addHooks.call(this);
this._map&&(this._updateLabelText({text:"\u70b9\u51fb\u6807\u6ce8."}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){AIMap.Handler.Draw.prototype.removeHooks.call(this);this._map&&(this._marker&&(this._marker.off("click",this._onClick),this._map.off("click",this._onClick).removeLayer(this._marker),delete this._marker),this._map.off("mousemove",this._onMouseMove))},_onMouseMove:function(f){var c=f.latlng;this._updateLabelPosition(f.layerPoint);this._marker?this._marker.setLatLng(c):
(this._marker=new AIMap.Marker(c,{icon:this.options.icon}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._map.fire("draw:marker-created",{marker:new AIMap.Marker(this._marker.getLatLng(),{icon:this.options.icon})});this.disable()}});AIMap.Map.mergeOptions({drawControl:!1});AIMap.Control.Draw=AIMap.Control.extend({options:{position:"topleft",polyline:{},polygon:{}},handlers:{},onAdd:function(f){var c=AIMap.DomUtil.create("div",
"aimap-control-draw");this.options.polyline&&(this.handlers.polyline=new AIMap.Polyline.Draw(f,this.options.polyline),this._createButton("\u91cf\u8ddd","aimap-control-draw-polyline",c,this.handlers.polyline.enable,this.handlers.polyline),this.handlers.polyline.on("activated",this._disableInactiveModes,this));this.options.polygon&&(this.handlers.polygon=new AIMap.Polygon.Draw(f,this.options.polygon),this._createButton("\u591a\u8fb9\u5f62\u9762\u79ef","aimap-control-draw-polygon",c,this.handlers.polygon.enable,
this.handlers.polygon),this.handlers.polygon.on("activated",this._disableInactiveModes,this));this.options.rectangle&&(this.handlers.rectangle=new AIMap.Rectangle.Draw(f,this.options.rectangle),this._createButton("\u77e9\u5f62\u9762\u79ef","aimap-control-draw-rectangle",c,this.handlers.rectangle.enable,this.handlers.rectangle),this.handlers.rectangle.on("activated",this._disableInactiveModes,this));this.options.circle&&(this.handlers.circle=new AIMap.Circle.Draw(f,this.options.circle),this._createButton("\u5706\u5f62\u9762\u79ef",
"aimap-control-draw-circle",c,this.handlers.circle.enable,this.handlers.circle),this.handlers.circle.on("activated",this._disableInactiveModes,this));this.options.marker&&(this.handlers.marker=new AIMap.Marker.Draw(f,this.options.marker),this._createButton("\u6807\u6ce8","aimap-control-draw-marker",c,this.handlers.marker.enable,this.handlers.marker),this.handlers.marker.on("activated",this._disableInactiveModes,this));return c},_createButton:function(f,c,g,b,k){c=AIMap.DomUtil.create("a",c,g);c.href=
"#";c.title=f;AIMap.DomEvent.addListener(c,"click",AIMap.DomEvent.stopPropagation).addListener(c,"click",AIMap.DomEvent.preventDefault).addListener(c,"click",b,k);return c},_disableInactiveModes:function(){for(var f in this.handlers)this.handlers.hasOwnProperty(f)&&this.handlers[f].enabled&&this.handlers[f].disable()}});AIMap.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new AIMap.Control.Draw,this.addControl(this.drawControl))})})();(function(){AIMap.PolylineMeasure=AIMap.Polyline.extend({});AIMap.PolygonMeasure=AIMap.Polygon.extend({});AIMap.HandlerMeasure=AIMap.Handler.extend({});AIMap.ControlMeasure=AIMap.Control.extend({});AIMap.Util.extend(AIMap.LineUtil,{segmentsIntersect:function(f,c,g,b){return this._checkCounterclockwise(f,g,b)!==this._checkCounterclockwise(c,g,b)&&PolylineMeasure},_checkCounterclockwise:function(f,c,g){return(g.y-f.y)*(c.x-f.x)>(c.y-f.y)*(g.x-f.x)}});AIMap.PolylineMeasure.include({intersects:function(){var f=
this._originalPoints,c=f?f.length:0,g,b;if(this._tooFewPointsForIntersection())return!1;for(c-=1;3<=c;c--)if(g=f[c-1],b=f[c],this._lineSegmentsIntersectsRange(g,b,c-2))return!0;return!1},newLatLngIntersects:function(f){return!this._map?!1:this.newPointIntersects(this._map.latLngToLayerPoint(f))},newPointIntersects:function(f){var c=this._originalPoints,g=c?c.length:0,c=c?c[g-1]:null,g=g-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(c,f,g)},_tooFewPointsForIntersection:function(f){var c=
this._originalPoints,c=c?c.length:0;return!this._originalPoints||3>=c+(f||0)},_lineSegmentsIntersectsRange:function(f,c,g,b){for(var k=this._originalPoints,e,b=b||0,i=g;i>b;i--)if(g=k[i-1],e=k[i],AIMap.LineUtil.segmentsIntersect(f,c,g,e))return!0;return!1}});AIMap.PolygonMeasure.include({intersects:function(){var f=this._originalPoints,c;if(this._tooFewPointsForIntersection())return!1;if(AIMap.PolylineMeasure.prototype.intersects.call(this))return!0;c=f.length;return this._lineSegmentsIntersectsRange(f[c-
1],f[0],c-2,1)}});AIMap.HandlerMeasure.Draw=AIMap.Handler.extend({includes:AIMap.Mixin.Events,initialize:function(f,c){this._map=f;this._container=f._container;this._pane=f._panes.overlayPane;c&&c.shapeOptions&&(c.shapeOptions=AIMap.Util.extend({},this.options.shapeOptions,c.shapeOptions));AIMap.Util.extend(this.options,c)},enable:function(){this.fire("activated");AIMap.Handler.prototype.enable.call(this)},addHooks:function(){this._map&&(AIMap.DomUtil.disableTextSelection(),this._label=AIMap.DomUtil.create("div",
"aimap-draw-label",this._pane),this._singleLineLabel=!1,AIMap.DomEvent.addListener(window,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(AIMap.DomUtil.enableTextSelection(),this._pane.removeChild(this._label),delete this._label,AIMap.DomEvent.removeListener(window,"keyup",this._cancelDrawing))},_updateLabelText:function(f){f.subtext=f.subtext||"";0===f.subtext.length&&!this._singleLineLabel?(AIMap.DomUtil.addClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=
!0):0<f.subtext.length&&this._singleLineLabel&&(AIMap.DomUtil.removeClass(this._label,"aimap-draw-label-single"),this._singleLineLabel=!1);this._label.innerHTML=(0<f.subtext.length?'<span class="aimap-draw-label-subtext">'+f.subtext+"</span><br />":"")+"<span>"+f.text+"</span>"},_updateLabelPosition:function(f){AIMap.DomUtil.setPosition(this._label,f)},_cancelDrawing:function(f){27===f.keyCode&&this.disable()}});AIMap.PolylineMeasure.Draw=AIMap.HandlerMeasure.Draw.extend({Poly:AIMap.PolylineMeasure,
options:{allowIntersection:!0,drawError:{color:"#b00b00",message:"<strong>\u9519\u8bef:</strong> \u56fe\u5f62\u8fb9\u7f18\u4e0d\u80fd\u76f8\u4ea4!",timeout:2500},icon:new AIMap.DivIcon({iconSize:new AIMap.Point(8,8),className:"aimap-div-icon aimap-editing-icon"}),guidelineDistance:20,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!1,clickable:!0}},initialize:function(f,c){c&&c.drawError&&(c.drawError=AIMap.Util.extend({},this.options.drawError,c.drawError));AIMap.HandlerMeasure.Draw.prototype.initialize.call(this,
f,c)},addHooks:function(){AIMap.HandlerMeasure.Draw.prototype.addHooks.call(this);this._map&&(this._markers=[],this._markerGroup=new AIMap.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new AIMap.PolylineMeasure([],this.options.shapeOptions),this._container.style.cursor="crosshair",this._updateLabelText(this._getLabelText()),this._map.on("mousemove",this._onMouseMove,this).on("click",this._onClick,this))},removeHooks:function(){AIMap.HandlerMeasure.Draw.prototype.removeHooks.call(this);
this._clearHideErrorTimeout();this._cleanUpShape();this._map.removeLayer(this._markerGroup);delete this._markerGroup;this._map.removeLayer(this._poly);delete this._poly;this._clearGuides();this._container.style.cursor="";this._map.off("mousemove").off("click")},_finishShape:function(){this._map.fire("measure:poly-created",{poly:new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions),dataLabel:this._getLabelText().subtext});this._map.off("mousemove").off("click");this.disable()},_onMouseMove:function(f){var c=
f.layerPoint,g=this._markers.length;this._currentLatLng=f.latlng;this._updateLabelPosition(c);0<g&&(this._updateLabelText(this._getLabelText()),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[g-1].getLatLng()),c));AIMap.DomEvent.preventDefault(f)},_onClick:function(f){f=f.latlng;0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(f)?this._showErrorLabel():(this._errorShown&&this._hideErrorLabel(),this._markers.push(this._createMarker(f)),
this._poly.addLatLng(f),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._updateMarkerHandler(),this._vertexAdded(f))},_updateMarkerHandler:function(){if(1<this._markers.length)this._markers[this._markers.length-1].on("click",this._finishShape,this);2<this._markers.length&&this._markers[this._markers.length-2].off("click",this._finishShape)},_createMarker:function(f){f=new AIMap.Marker(f,{icon:this.options.icon});this._markerGroup.addLayer(f);return f},_drawGuide:function(f,
c){var g=Math.floor(Math.sqrt(Math.pow(c.x-f.x,2)+Math.pow(c.y-f.y,2))),b,k,e;this._guidesContainer||(this._guidesContainer=AIMap.DomUtil.create("div","aimap-draw-guides",this._pane));for(b=this.options.guidelineDistance;b<g;b+=this.options.guidelineDistance)k=b/g,k={x:Math.floor(f.x*(1-k)+k*c.x),y:Math.floor(f.y*(1-k)+k*c.y)},e=AIMap.DomUtil.create("div","aimap-draw-guide-dash",this._guidesContainer),e.style.backgroundColor=!this._errorShown?this.options.shapeOptions.color:this.options.drawError.color,
AIMap.DomUtil.setPosition(e,k)},_updateGuideColor:function(f){if(this._guidesContainer)for(var c=0,g=this._guidesContainer.childNodes.length;c<g;c++)this._guidesContainer.childNodes[c].style.backgroundColor=f},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_updateLabelText:function(f){this._errorShown||AIMap.HandlerMeasure.Draw.prototype._updateLabelText.call(this,f)},_getLabelText:function(){var f;
0===this._markers.length?f={text:"\u5355\u51fb\u5f00\u6d4b\u8ddd."}:(f=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?this._measurementRunningTotal+this._currentLatLng.distance80To(this._markers[this._markers.length-1].getLatLng()):this._measurementRunningTotal+this._currentLatLng.distanceTo(this._markers[this._markers.length-1].getLatLng()),f=1E3<f?(f/1E3).toFixed(2)+" km":Math.ceil(f)+" m",f="\u8ddd\u79bb\uff1a"+f,f=1===this._markers.length?{text:"\u5355\u51fb\u7ee7\u7eed\u6d4b\u8ddd.",
subtext:f}:{text:"\u5355\u51fb\u6700\u540e\u4e00\u4e2a\u70b9\u7ed3\u675f\u6d4b\u8ddd.",subtext:f});return f},_showErrorLabel:function(){this._errorShown=!0;AIMap.DomUtil.addClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.addClass(this._label,"aimap-flash-anim");AIMap.HandlerMeasure.Draw.prototype._updateLabelText.call(this,{text:this.options.drawError.message});this._updateGuideColor(this.options.drawError.color);this._poly.setStyle({color:this.options.drawError.color});this._clearHideErrorTimeout();
this._hideErrorTimeout=setTimeout(AIMap.Util.bind(this._hideErrorLabel,this),this.options.drawError.timeout)},_hideErrorLabel:function(){this._errorShown=!1;this._clearHideErrorTimeout();AIMap.DomUtil.removeClass(this._label,"aimap-error-draw-label");AIMap.DomUtil.removeClass(this._label,"aimap-flash-anim");this._updateLabelText(this._getLabelText());this._updateGuideColor(this.options.shapeOptions.color);this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&
(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_vertexAdded:function(f){this._measurementRunningTotal=1===this._markers.length?0:180<this._currentLatLng.lat||-180>this._currentLatLng.lat?this._measurementRunningTotal+f.distance80To(this._markers[this._markers.length-2].getLatLng()):this._measurementRunningTotal+f.distanceTo(this._markers[this._markers.length-2].getLatLng())},_cleanUpShape:function(){0<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape)}});
AIMap.PolygonMeasure.Draw=AIMap.PolylineMeasure.Draw.extend({Poly:AIMap.PolygonMeasure,options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:0.5,fill:!0,fillColor:null,fillOpacity:0.2,clickable:!0}},_updateMarkerHandler:function(){if(1===this._markers.length)this._markers[0].on("click",this._finishShape,this)},_getLabelText:function(){var f,c,g;0===this._markers.length?f={text:"\u70b9\u51fb\u5730\u56fe\u5f00\u59cb\u6d4b\u9762"}:(f=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?
this._measurementRunningTotal+this._currentLatLng.distance80To(this._markers[this._markers.length-1].getLatLng()):this._measurementRunningTotal+this._currentLatLng.distanceTo(this._markers[this._markers.length-1].getLatLng()),f=1E3<f?(f/1E3).toFixed(2)+" \u5343\u7c73":Math.ceil(f)+" \u7c73",3>this._markers.length?f={text:"\u70b9\u51fb\u5730\u56fe\u9762\u79ef\u91cf\u7b97",subtext:"\u5468\u957f\uff1a"+f}:(c=this._measurementAreaTotal,g=1E6<c?(c/1E6).toFixed(2)+" \u5e73\u65b9\u5343\u7c73":Math.ceil(c)+
" \u5e73\u65b9\u7c73",f={text:"\u70b9\u51fb\u7b2c\u4e00\u4e2a\u9876\u70b9\u7ed3\u675f\u9762\u79ef\u91cf\u7b97",subtext:"\u5468\u957f\uff1a"+f+"      \u9762\u79ef\uff1a"+g+"</br>"+(0.0015*Number(c)).toFixed(2)+"\u4ea9,"+(1.0E-4*Number(c)).toFixed(2)+"\u516c\u9877"}));return f},_vertexAdded:function(f){if(1===this._markers.length)this._measurementAreaTotal=this._measurementRunningTotal=0;else{if(3>this._markers.length)this._measurementAreaTotal=0;else{var c=0,g=this._markers.length;if(3>g)return c;
for(var c=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?c+this._markers[0].getLatLng().lat*(this._markers[g-1].getLatLng().lng-this._markers[1].getLatLng().lng):c+1.2364299608417315E10*this._markers[0].getLatLng().lat*(this._markers[g-1].getLatLng().lng-this._markers[1].getLatLng().lng),b=1;b<g;b++)c=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?c+this._markers[b].getLatLng().lat*(this._markers[b-1].getLatLng().lng-this._markers[(b+1)%g].getLatLng().lng):c+1.2364299608417315E10*
this._markers[b].getLatLng().lat*(this._markers[b-1].getLatLng().lng-this._markers[(b+1)%g].getLatLng().lng);area=-c/2;this._measurementAreaTotal=Math.abs(area)}this._measurementRunningTotal=180<this._currentLatLng.lat||-180>this._currentLatLng.lat?this._measurementRunningTotal+f.distance80To(this._markers[this._markers.length-2].getLatLng()):this._measurementRunningTotal+f.distanceTo(this._markers[this._markers.length-2].getLatLng())}},_cleanUpShape:function(){0<this._markers.length&&this._markers[0].off("click",
this._finishShape)}});AIMap.Map.mergeOptions({drawControl:!1});AIMap.ControlMeasure.Draw=AIMap.Control.extend({options:{position:"topleft",polyline:{},polygon:{}},handlers:{},onAdd:function(f){var c=AIMap.DomUtil.create("div","aimap-ControlMeasure-draw");this.options.polyline&&(this.handlers.polyline=new AIMap.PolylineMeasure.Draw(f,this.options.polyline),this._createButton("\u91cf\u8ddd","aimap-ControlMeasure-draw-polyline",c,this.handlers.polyline.enable,this.handlers.polyline),this.handlers.polyline.on("activated",
this._disableInactiveModes,this));this.options.polygon&&(this.handlers.polygon=new AIMap.PolygonMeasure.Draw(f,this.options.polygon),this._createButton("\u591a\u8fb9\u5f62\u9762\u79ef","aimap-ControlMeasure-draw-polygon",c,this.handlers.polygon.enable,this.handlers.polygon),this.handlers.polygon.on("activated",this._disableInactiveModes,this));return c},_createButton:function(f,c,g,b,k){c=AIMap.DomUtil.create("a",c,g);c.href="#";c.title=f;AIMap.DomEvent.addListener(c,"click",AIMap.DomEvent.stopPropagation).addListener(c,
"click",AIMap.DomEvent.preventDefault).addListener(c,"click",b,k);return c},_disableInactiveModes:function(){for(var f in this.handlers)this.handlers.hasOwnProperty(f)&&this.handlers[f].enabled&&this.handlers[f].disable()}});AIMap.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new AIMap.ControlMeasure.Draw,this.addControl(this.drawControl))})})();var AIMapPip=null;
(function e$$0(c,g,b){function k(i,o){if(!g[i]){if(!c[i]){var l="function"==typeof require&&require;if(!o&&l)return l(i,!0);if(e)return e(i,!0);l=Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l;}l=g[i]={exports:{}};c[i][0].call(l.exports,function(b){var e=c[i][1][b];return k(e?e:b)},l,l.exports,e$$0,c,g,b)}return g[i].exports}for(var e="function"==typeof require&&require,i=0;i<b.length;i++)k(b[i]);return k})({1:[function(f,c){var g=f("geojson-utils"),b={bassackwards:!1,pointInLayer:function(c,
e,f){c instanceof AIMap.LatLng?c=[c.lng,c.lat]:b.bassackwards&&(c=c.concat().reverse());var m=[];e.eachLayer(function(b){if(!f||!m.length){var e;e=AIMap.MultiPolygon?b instanceof AIMap.MultiPolygon||b instanceof AIMap.Polygon:b.feature&&b.feature.geometry&&b.feature.geometry.type&&-1!==["Polygon","MultiPolygon"].indexOf(b.feature.geometry.type);e&&g.pointInPolygon({type:"Point",coordinates:c},b.toGeoJSON().geometry)&&m.push(b)}});return m}};c.exports=b},{"geojson-utils":2}],2:[function(f,c){(function(){function f(b){for(var c=
[],g=[],k=0;k<b[0].length;k++)c.push(b[0][k][1]),g.push(b[0][k][0]);c=c.sort(function(b,c){return b-c});g=g.sort(function(b,c){return b-c});return[[c[0],g[0]],[c[c.length-1],g[g.length-1]]]}function b(b,c,f){for(var g=[[0,0]],l=0;l<f.length;l++){for(var j=0;j<f[l].length;j++)g.push(f[l][j]);g.push(f[l][0]);g.push([0,0])}f=!1;l=0;for(j=g.length-1;l<g.length;j=l++)g[l][0]>c!=g[j][0]>c&&b<(g[j][1]-g[l][1])*(c-g[l][0])/(g[j][0]-g[l][0])+g[l][1]&&(f=!f);return f}var k=this.gju={};"undefined"!==typeof c&&
c.exports&&(c.exports=k);k.lineStringsIntersect=function(b,c){for(var f=[],g=0;g<=b.coordinates.length-2;++g)for(var l=0;l<=c.coordinates.length-2;++l){var j=b.coordinates[g][1],k=b.coordinates[g][0],r=b.coordinates[g+1][1],q=b.coordinates[g+1][0],p=c.coordinates[l][1],t=c.coordinates[l][0],B=c.coordinates[l+1][1],v=c.coordinates[l+1][0],C=(B-p)*(k-t)-(v-t)*(j-p),E=(r-j)*(k-t)-(q-k)*(j-p),p=(v-t)*(r-j)-(B-p)*(q-k);if(p!=0){C=C/p;E=E/p;0<=C&&(C<=1&&0<=E&&E<=1)&&f.push({type:"Point",coordinates:[j+
C*(r-j),k+C*(q-k)]})}}f.length==0&&(f=false);return f};k.pointInBoundingBox=function(b,c){return!(b.coordinates[1]<c[0][0]||b.coordinates[1]>c[1][0]||b.coordinates[0]<c[0][1]||b.coordinates[0]>c[1][1])};k.pointInPolygon=function(c,i){for(var m=i.type=="Polygon"?[i.coordinates]:i.coordinates,o=false,l=0;l<m.length;l++)k.pointInBoundingBox(c,f(m[l]))&&(o=true);if(!o)return false;o=false;for(l=0;l<m.length;l++)b(c.coordinates[1],c.coordinates[0],m[l])&&(o=true);return o};k.pointInMultiPolygon=function(c,
i){for(var m=i.type=="MultiPolygon"?[i.coordinates]:i.coordinates,o=false,l=false,j=0;j<m.length;j++){for(var n=m[j],r=0;r<n.length;r++)o||k.pointInBoundingBox(c,f(n[r]))&&(o=true);if(!o)return false;for(r=0;r<n.length;r++)l||b(c.coordinates[1],c.coordinates[0],n[r])&&(l=true)}return l};k.numberToRadius=function(b){return b*Math.PI/180};k.numberToDegree=function(b){return b*180/Math.PI};k.drawCircle=function(b,c,f){for(var g=[c.coordinates[1],c.coordinates[0]],b=b/1E3/6371,c=[k.numberToRadius(g[0]),
k.numberToRadius(g[1])],f=f||15,g=[[g[0],g[1]]],l=0;l<f;l++){var j=2*Math.PI*l/f,n=Math.asin(Math.sin(c[0])*Math.cos(b)+Math.cos(c[0])*Math.sin(b)*Math.cos(j)),j=c[1]+Math.atan2(Math.sin(j)*Math.sin(b)*Math.cos(c[0]),Math.cos(b)-Math.sin(c[0])*Math.sin(n));g[l]=[];g[l][1]=k.numberToDegree(n);g[l][0]=k.numberToDegree(j)}return{type:"Polygon",coordinates:[g]}};k.rectangleCentroid=function(b){var b=b.coordinates[0],c=b[0][0],f=b[0][1];return{type:"Point",coordinates:[c+(b[2][0]-c)/2,f+(b[2][1]-f)/2]}};
k.pointDistance=function(b,c){var f=b.coordinates[0],g=b.coordinates[1],l=c.coordinates[0],j=c.coordinates[1],n=k.numberToRadius(j-g),f=k.numberToRadius(l-f),g=Math.pow(Math.sin(n/2),2)+Math.cos(k.numberToRadius(g))*Math.cos(k.numberToRadius(j))*Math.pow(Math.sin(f/2),2);return Math.atan2(Math.sqrt(g),Math.sqrt(1-g))*12742E3};k.geometryWithinRadius=function(b,c,f){if(b.type=="Point")return k.pointDistance(b,c)<=f;if(b.type=="LineString"||b.type=="Polygon"){var g={},b=b.type=="Polygon"?b.coordinates[0]:
b.coordinates,l;for(l in b){g.coordinates=b[l];if(k.pointDistance(g,c)>f)return false}}return true};k.area=function(b){var c,f,g,k=0,j=b.coordinates[0];c=j.length-1;for(var n=0;n<j.length;c=n++){f=j[n][1];g=j[n][0];b=j[c][1];c=j[c][0];k=k+f*c;k=k-g*b}return k/2};k.centroid=function(b){var c,f,g,l,j,n=0,r=0,q=b.coordinates[0];f=q.length-1;for(var p=0;p<q.length;f=p++){g=q[p][1];l=q[p][0];c=q[f][1];f=q[f][0];j=g*f-c*l;n=n+(g+c)*j;r=r+(l+f)*j}j=k.area(b)*6;return{type:"Point",coordinates:[r/j,n/j]}};
k.simplify=function(b,c){var c=c||20,b=b.map(function(b){return{lng:b.coordinates[0],lat:b.coordinates[1]}}),f,g,k,j,n,r,q,p,t,B,v,C,E,w,y,z,D,u=Math.PI/180*0.5,x=[],A=[],F=[];if(b.length<3)return b;f=b.length;B=c*360/(Math.PI*12756274);B=B*B;k=0;A[0]=0;F[0]=f-1;for(g=1;g>0;){j=A[g-1];n=F[g-1];g--;if(n-j>1){v=b[n].lng()-b[j].lng();C=b[n].lat()-b[j].lat();Math.abs(v)>180&&(v=360-Math.abs(v));v=v*Math.cos(u*(b[n].lat()+b[j].lat()));E=v*v+C*C;r=j+1;q=j;for(t=-1;r<n;r++){p=b[r].lng()-b[j].lng();w=b[r].lat()-
b[j].lat();Math.abs(p)>180&&(p=360-Math.abs(p));p=p*Math.cos(u*(b[r].lat()+b[j].lat()));y=p*p+w*w;z=b[r].lng()-b[n].lng();D=b[r].lat()-b[n].lat();Math.abs(z)>180&&(z=360-Math.abs(z));z=z*Math.cos(u*(b[r].lat()+b[n].lat()));z=z*z+D*D;p=y>=E+z?z:z>=E+y?y:(p*C-w*v)*(p*C-w*v)/E;if(p>t){q=r;t=p}}if(t<B){x[k]=j;k++}else{g++;A[g-1]=q;F[g-1]=n;g++;A[g-1]=j;F[g-1]=q}}else{x[k]=j;k++}}x[k]=f-1;k++;f=[];for(r=0;r<k;r++)f.push(b[x[r]]);return f.map(function(b){return{type:"Point",coordinates:[b.lng,b.lat]}})};
k.destinationPoint=function(b,c,f){var f=f/6371,c=k.numberToRadius(c),g=k.numberToRadius(b.coordinates[0]),l=k.numberToRadius(b.coordinates[1]),b=Math.asin(Math.sin(l)*Math.cos(f)+Math.cos(l)*Math.sin(f)*Math.cos(c)),c=g+Math.atan2(Math.sin(c)*Math.sin(f)*Math.cos(l),Math.cos(f)-Math.sin(l)*Math.sin(b)),c=(c+3*Math.PI)%(2*Math.PI)-Math.PI;return{type:"Point",coordinates:[k.numberToDegree(c),k.numberToDegree(b)]}}})()},{}],3:[function(f){AIMapPip=f("../")},{"../":1}]},{},[3]);
